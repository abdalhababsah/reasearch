const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/app-XseEcuwc.js","assets/app-B_WW15wt.css"])))=>i.map(i=>d[i]);
import{g as Zr,r as M,U as P,_ as fi,j as B,c as Ro,a as Lo,H as ko}from"./app-XseEcuwc.js";import{c as Qr,a as Bi,u as Io}from"./index-CR-rnG23.js";import{B as pi}from"./badge-BtTJmYx1.js";import{B as ce}from"./button-DI4PaxQ7.js";import{A as Mo}from"./app-layout-CZoO53OF.js";import{A as Oo}from"./arrow-left-CY72dKNG.js";import{D as Do}from"./download-CEZ7BJdo.js";import{E as Fo}from"./external-link-O69yMtgn.js";import{E as No}from"./eye-It2y3WZw.js";import{F as Bo}from"./file-DQ3ZriMY.js";/* empty css            */import"./x-DgzPl7e4.js";import"./input-MwdOiVtB.js";import"./index-BHKBQx4H.js";import"./index-C3Hm02L2.js";import"./index-DRE42a0L.js";import"./index-BDsVhmEQ.js";import"./index-DPjtb1Rz.js";import"./select-Bhj_cBoa.js";import"./index-BitGjllA.js";import"./app-logo-icon-3mANveO6.js";import"./index-BZB35nAZ.js";import"./index-CMWG4mbA.js";import"./app-logo-BdIHiqic.js";import"./chevron-right-BMEIDfYh.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jo=[["path",{d:"M3 19V5",key:"rwsyhb"}],["path",{d:"m13 6-6 6 6 6",key:"1yhaz7"}],["path",{d:"M7 12h14",key:"uoisry"}]],Ho=Qr("ArrowLeftToLine",jo);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uo=[["path",{d:"M17 12H3",key:"8awo09"}],["path",{d:"m11 18 6-6-6-6",key:"8c2y43"}],["path",{d:"M21 5v14",key:"nzette"}]],$o=Qr("ArrowRightToLine",Uo);var hn={exports:{}},ft={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bs;function zo(){if(bs)return ft;bs=1;var r=typeof Symbol=="function"&&Symbol.for,t=r?Symbol.for("react.element"):60103,e=r?Symbol.for("react.portal"):60106,i=r?Symbol.for("react.fragment"):60107,n=r?Symbol.for("react.strict_mode"):60108,s=r?Symbol.for("react.profiler"):60114,a=r?Symbol.for("react.provider"):60109,o=r?Symbol.for("react.context"):60110,l=r?Symbol.for("react.async_mode"):60111,c=r?Symbol.for("react.concurrent_mode"):60111,h=r?Symbol.for("react.forward_ref"):60112,d=r?Symbol.for("react.suspense"):60113,u=r?Symbol.for("react.suspense_list"):60120,p=r?Symbol.for("react.memo"):60115,f=r?Symbol.for("react.lazy"):60116,m=r?Symbol.for("react.block"):60121,b=r?Symbol.for("react.fundamental"):60117,g=r?Symbol.for("react.responder"):60118,y=r?Symbol.for("react.scope"):60119;function x(v){if(typeof v=="object"&&v!==null){var R=v.$$typeof;switch(R){case t:switch(v=v.type,v){case l:case c:case i:case s:case n:case d:return v;default:switch(v=v&&v.$$typeof,v){case o:case h:case f:case p:case a:return v;default:return R}}case e:return R}}}function w(v){return x(v)===c}return ft.AsyncMode=l,ft.ConcurrentMode=c,ft.ContextConsumer=o,ft.ContextProvider=a,ft.Element=t,ft.ForwardRef=h,ft.Fragment=i,ft.Lazy=f,ft.Memo=p,ft.Portal=e,ft.Profiler=s,ft.StrictMode=n,ft.Suspense=d,ft.isAsyncMode=function(v){return w(v)||x(v)===l},ft.isConcurrentMode=w,ft.isContextConsumer=function(v){return x(v)===o},ft.isContextProvider=function(v){return x(v)===a},ft.isElement=function(v){return typeof v=="object"&&v!==null&&v.$$typeof===t},ft.isForwardRef=function(v){return x(v)===h},ft.isFragment=function(v){return x(v)===i},ft.isLazy=function(v){return x(v)===f},ft.isMemo=function(v){return x(v)===p},ft.isPortal=function(v){return x(v)===e},ft.isProfiler=function(v){return x(v)===s},ft.isStrictMode=function(v){return x(v)===n},ft.isSuspense=function(v){return x(v)===d},ft.isValidElementType=function(v){return typeof v=="string"||typeof v=="function"||v===i||v===c||v===s||v===n||v===d||v===u||typeof v=="object"&&v!==null&&(v.$$typeof===f||v.$$typeof===p||v.$$typeof===a||v.$$typeof===o||v.$$typeof===h||v.$$typeof===b||v.$$typeof===g||v.$$typeof===y||v.$$typeof===m)},ft.typeOf=x,ft}var vs;function Jr(){return vs||(vs=1,hn.exports=zo()),hn.exports}var ta=Jr();function Go(r){function t(S,T,L,U,E){for(var N=0,k=0,rt=0,V=0,at,X,Q=0,ot=0,et,K=et=at=0,tt=0,ht=0,Et=0,bt=0,$t=L.length,te=$t-1,Ct,Z="",pt="",le="",me="",qt;tt<$t;){if(X=L.charCodeAt(tt),tt===te&&k+V+rt+N!==0&&(k!==0&&(X=k===47?10:47),V=rt=N=0,$t++,te++),k+V+rt+N===0){if(tt===te&&(0<ht&&(Z=Z.replace(u,"")),0<Z.trim().length)){switch(X){case 32:case 9:case 59:case 13:case 10:break;default:Z+=L.charAt(tt)}X=59}switch(X){case 123:for(Z=Z.trim(),at=Z.charCodeAt(0),et=1,bt=++tt;tt<$t;){switch(X=L.charCodeAt(tt)){case 123:et++;break;case 125:et--;break;case 47:switch(X=L.charCodeAt(tt+1)){case 42:case 47:t:{for(K=tt+1;K<te;++K)switch(L.charCodeAt(K)){case 47:if(X===42&&L.charCodeAt(K-1)===42&&tt+2!==K){tt=K+1;break t}break;case 10:if(X===47){tt=K+1;break t}}tt=K}}break;case 91:X++;case 40:X++;case 34:case 39:for(;tt++<te&&L.charCodeAt(tt)!==X;);}if(et===0)break;tt++}switch(et=L.substring(bt,tt),at===0&&(at=(Z=Z.replace(d,"").trim()).charCodeAt(0)),at){case 64:switch(0<ht&&(Z=Z.replace(u,"")),X=Z.charCodeAt(1),X){case 100:case 109:case 115:case 45:ht=T;break;default:ht=J}if(et=t(T,ht,et,X,E+1),bt=et.length,0<_&&(ht=e(J,Z,Et),qt=o(3,et,ht,T,W,$,bt,X,E,U),Z=ht.join(""),qt!==void 0&&(bt=(et=qt.trim()).length)===0&&(X=0,et="")),0<bt)switch(X){case 115:Z=Z.replace(R,a);case 100:case 109:case 45:et=Z+"{"+et+"}";break;case 107:Z=Z.replace(y,"$1 $2"),et=Z+"{"+et+"}",et=G===1||G===2&&s("@"+et,3)?"@-webkit-"+et+"@"+et:"@"+et;break;default:et=Z+et,U===112&&(et=(pt+=et,""))}else et="";break;default:et=t(T,e(T,Z,Et),et,U,E+1)}le+=et,et=Et=ht=K=at=0,Z="",X=L.charCodeAt(++tt);break;case 125:case 59:if(Z=(0<ht?Z.replace(u,""):Z).trim(),1<(bt=Z.length))switch(K===0&&(at=Z.charCodeAt(0),at===45||96<at&&123>at)&&(bt=(Z=Z.replace(" ",":")).length),0<_&&(qt=o(1,Z,T,S,W,$,pt.length,U,E,U))!==void 0&&(bt=(Z=qt.trim()).length)===0&&(Z="\0\0"),at=Z.charCodeAt(0),X=Z.charCodeAt(1),at){case 0:break;case 64:if(X===105||X===99){me+=Z+L.charAt(tt);break}default:Z.charCodeAt(bt-1)!==58&&(pt+=n(Z,at,X,Z.charCodeAt(2)))}Et=ht=K=at=0,Z="",X=L.charCodeAt(++tt)}}switch(X){case 13:case 10:k===47?k=0:1+at===0&&U!==107&&0<Z.length&&(ht=1,Z+="\0"),0<_*C&&o(0,Z,T,S,W,$,pt.length,U,E,U),$=1,W++;break;case 59:case 125:if(k+V+rt+N===0){$++;break}default:switch($++,Ct=L.charAt(tt),X){case 9:case 32:if(V+N+k===0)switch(Q){case 44:case 58:case 9:case 32:Ct="";break;default:X!==32&&(Ct=" ")}break;case 0:Ct="\\0";break;case 12:Ct="\\f";break;case 11:Ct="\\v";break;case 38:V+k+N===0&&(ht=Et=1,Ct="\f"+Ct);break;case 108:if(V+k+N+Y===0&&0<K)switch(tt-K){case 2:Q===112&&L.charCodeAt(tt-3)===58&&(Y=Q);case 8:ot===111&&(Y=ot)}break;case 58:V+k+N===0&&(K=tt);break;case 44:k+rt+V+N===0&&(ht=1,Ct+="\r");break;case 34:case 39:k===0&&(V=V===X?0:V===0?X:V);break;case 91:V+k+rt===0&&N++;break;case 93:V+k+rt===0&&N--;break;case 41:V+k+N===0&&rt--;break;case 40:if(V+k+N===0){if(at===0)switch(2*Q+3*ot){case 533:break;default:at=1}rt++}break;case 64:k+rt+V+N+K+et===0&&(et=1);break;case 42:case 47:if(!(0<V+N+rt))switch(k){case 0:switch(2*X+3*L.charCodeAt(tt+1)){case 235:k=47;break;case 220:bt=tt,k=42}break;case 42:X===47&&Q===42&&bt+2!==tt&&(L.charCodeAt(bt+2)===33&&(pt+=L.substring(bt,tt+1)),Ct="",k=0)}}k===0&&(Z+=Ct)}ot=Q,Q=X,tt++}if(bt=pt.length,0<bt){if(ht=T,0<_&&(qt=o(2,pt,ht,S,W,$,bt,U,E,U),qt!==void 0&&(pt=qt).length===0))return me+pt+le;if(pt=ht.join(",")+"{"+pt+"}",G*Y!==0){switch(G!==2||s(pt,2)||(Y=0),Y){case 111:pt=pt.replace(w,":-moz-$1")+pt;break;case 112:pt=pt.replace(x,"::-webkit-input-$1")+pt.replace(x,"::-moz-$1")+pt.replace(x,":-ms-input-$1")+pt}Y=0}}return me+pt+le}function e(S,T,L){var U=T.trim().split(b);T=U;var E=U.length,N=S.length;switch(N){case 0:case 1:var k=0;for(S=N===0?"":S[0]+" ";k<E;++k)T[k]=i(S,T[k],L).trim();break;default:var rt=k=0;for(T=[];k<E;++k)for(var V=0;V<N;++V)T[rt++]=i(S[V]+" ",U[k],L).trim()}return T}function i(S,T,L){var U=T.charCodeAt(0);switch(33>U&&(U=(T=T.trim()).charCodeAt(0)),U){case 38:return T.replace(g,"$1"+S.trim());case 58:return S.trim()+T.replace(g,"$1"+S.trim());default:if(0<1*L&&0<T.indexOf("\f"))return T.replace(g,(S.charCodeAt(0)===58?"":"$1")+S.trim())}return S+T}function n(S,T,L,U){var E=S+";",N=2*T+3*L+4*U;if(N===944){S=E.indexOf(":",9)+1;var k=E.substring(S,E.length-1).trim();return k=E.substring(0,S).trim()+k+";",G===1||G===2&&s(k,1)?"-webkit-"+k+k:k}if(G===0||G===2&&!s(E,1))return E;switch(N){case 1015:return E.charCodeAt(10)===97?"-webkit-"+E+E:E;case 951:return E.charCodeAt(3)===116?"-webkit-"+E+E:E;case 963:return E.charCodeAt(5)===110?"-webkit-"+E+E:E;case 1009:if(E.charCodeAt(4)!==100)break;case 969:case 942:return"-webkit-"+E+E;case 978:return"-webkit-"+E+"-moz-"+E+E;case 1019:case 983:return"-webkit-"+E+"-moz-"+E+"-ms-"+E+E;case 883:if(E.charCodeAt(8)===45)return"-webkit-"+E+E;if(0<E.indexOf("image-set(",11))return E.replace(D,"$1-webkit-$2")+E;break;case 932:if(E.charCodeAt(4)===45)switch(E.charCodeAt(5)){case 103:return"-webkit-box-"+E.replace("-grow","")+"-webkit-"+E+"-ms-"+E.replace("grow","positive")+E;case 115:return"-webkit-"+E+"-ms-"+E.replace("shrink","negative")+E;case 98:return"-webkit-"+E+"-ms-"+E.replace("basis","preferred-size")+E}return"-webkit-"+E+"-ms-"+E+E;case 964:return"-webkit-"+E+"-ms-flex-"+E+E;case 1023:if(E.charCodeAt(8)!==99)break;return k=E.substring(E.indexOf(":",15)).replace("flex-","").replace("space-between","justify"),"-webkit-box-pack"+k+"-webkit-"+E+"-ms-flex-pack"+k+E;case 1005:return f.test(E)?E.replace(p,":-webkit-")+E.replace(p,":-moz-")+E:E;case 1e3:switch(k=E.substring(13).trim(),T=k.indexOf("-")+1,k.charCodeAt(0)+k.charCodeAt(T)){case 226:k=E.replace(v,"tb");break;case 232:k=E.replace(v,"tb-rl");break;case 220:k=E.replace(v,"lr");break;default:return E}return"-webkit-"+E+"-ms-"+k+E;case 1017:if(E.indexOf("sticky",9)===-1)break;case 975:switch(T=(E=S).length-10,k=(E.charCodeAt(T)===33?E.substring(0,T):E).substring(S.indexOf(":",7)+1).trim(),N=k.charCodeAt(0)+(k.charCodeAt(7)|0)){case 203:if(111>k.charCodeAt(8))break;case 115:E=E.replace(k,"-webkit-"+k)+";"+E;break;case 207:case 102:E=E.replace(k,"-webkit-"+(102<N?"inline-":"")+"box")+";"+E.replace(k,"-webkit-"+k)+";"+E.replace(k,"-ms-"+k+"box")+";"+E}return E+";";case 938:if(E.charCodeAt(5)===45)switch(E.charCodeAt(6)){case 105:return k=E.replace("-items",""),"-webkit-"+E+"-webkit-box-"+k+"-ms-flex-"+k+E;case 115:return"-webkit-"+E+"-ms-flex-item-"+E.replace(j,"")+E;default:return"-webkit-"+E+"-ms-flex-line-pack"+E.replace("align-content","").replace(j,"")+E}break;case 973:case 989:if(E.charCodeAt(3)!==45||E.charCodeAt(4)===122)break;case 931:case 953:if(z.test(S)===!0)return(k=S.substring(S.indexOf(":")+1)).charCodeAt(0)===115?n(S.replace("stretch","fill-available"),T,L,U).replace(":fill-available",":stretch"):E.replace(k,"-webkit-"+k)+E.replace(k,"-moz-"+k.replace("fill-",""))+E;break;case 962:if(E="-webkit-"+E+(E.charCodeAt(5)===102?"-ms-"+E:"")+E,L+U===211&&E.charCodeAt(13)===105&&0<E.indexOf("transform",10))return E.substring(0,E.indexOf(";",27)+1).replace(m,"$1-webkit-$2")+E}return E}function s(S,T){var L=S.indexOf(T===1?":":"{"),U=S.substring(0,T!==3?L:10);return L=S.substring(L+1,S.length-1),A(T!==2?U:U.replace(H,"$1"),L,T)}function a(S,T){var L=n(T,T.charCodeAt(0),T.charCodeAt(1),T.charCodeAt(2));return L!==T+";"?L.replace(I," or ($1)").substring(4):"("+T+")"}function o(S,T,L,U,E,N,k,rt,V,at){for(var X=0,Q=T,ot;X<_;++X)switch(ot=F[X].call(h,S,Q,L,U,E,N,k,rt,V,at)){case void 0:case!1:case!0:case null:break;default:Q=ot}if(Q!==T)return Q}function l(S){switch(S){case void 0:case null:_=F.length=0;break;default:if(typeof S=="function")F[_++]=S;else if(typeof S=="object")for(var T=0,L=S.length;T<L;++T)l(S[T]);else C=!!S|0}return l}function c(S){return S=S.prefix,S!==void 0&&(A=null,S?typeof S!="function"?G=1:(G=2,A=S):G=0),c}function h(S,T){var L=S;if(33>L.charCodeAt(0)&&(L=L.trim()),O=L,L=[O],0<_){var U=o(-1,T,L,L,W,$,0,0,0,0);U!==void 0&&typeof U=="string"&&(T=U)}var E=t(J,L,T,0,0);return 0<_&&(U=o(-2,E,L,L,W,$,E.length,0,0,0),U!==void 0&&(E=U)),O="",Y=0,$=W=1,E}var d=/^\0+/g,u=/[\0\r\f]/g,p=/: */g,f=/zoo|gra/,m=/([,: ])(transform)/g,b=/,\r+?/g,g=/([\t\r\n ])*\f?&/g,y=/@(k\w+)\s*(\S*)\s*/,x=/::(place)/g,w=/:(read-only)/g,v=/[svh]\w+-[tblr]{2}/,R=/\(\s*(.*)\s*\)/g,I=/([\s\S]*?);/g,j=/-self|flex-/g,H=/[^]*?(:[rp][el]a[\w-]+)[^]*/,z=/stretch|:\s*\w+\-(?:conte|avail)/,D=/([^-])(image-set\()/,$=1,W=1,Y=0,G=1,J=[],F=[],_=0,A=null,C=0,O="";return h.use=l,h.set=c,r!==void 0&&c(r),h}var Vo={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};function Wo(r){var t=Object.create(null);return function(e){return t[e]===void 0&&(t[e]=r(e)),t[e]}}var Yo=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|popover|popoverTarget|popoverTargetAction|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,ys=Wo(function(r){return Yo.test(r)||r.charCodeAt(0)===111&&r.charCodeAt(1)===110&&r.charCodeAt(2)<91}),dn,_s;function qo(){if(_s)return dn;_s=1;var r=Jr(),t={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},e={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},i={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},n={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};s[r.ForwardRef]=i,s[r.Memo]=n;function a(f){return r.isMemo(f)?n:s[f.$$typeof]||t}var o=Object.defineProperty,l=Object.getOwnPropertyNames,c=Object.getOwnPropertySymbols,h=Object.getOwnPropertyDescriptor,d=Object.getPrototypeOf,u=Object.prototype;function p(f,m,b){if(typeof m!="string"){if(u){var g=d(m);g&&g!==u&&p(f,g,b)}var y=l(m);c&&(y=y.concat(c(m)));for(var x=a(f),w=a(m),v=0;v<y.length;++v){var R=y[v];if(!e[R]&&!(b&&b[R])&&!(w&&w[R])&&!(x&&x[R])){var I=h(m,R);try{o(f,R,I)}catch{}}}}return f}return dn=p,dn}var Xo=qo();const Ko=Zr(Xo);var Gt={};function Qt(){return(Qt=Object.assign||function(r){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r}).apply(this,arguments)}var As=function(r,t){for(var e=[r[0]],i=0,n=t.length;i<n;i+=1)e.push(t[i],r[i+1]);return e},wn=function(r){return r!==null&&typeof r=="object"&&(r.toString?r.toString():Object.prototype.toString.call(r))==="[object Object]"&&!ta.typeOf(r)},Ci=Object.freeze([]),ue=Object.freeze({});function He(r){return typeof r=="function"}function Es(r){return r.displayName||r.name||"Component"}function Gn(r){return r&&typeof r.styledComponentId=="string"}var Ue=typeof process<"u"&&Gt!==void 0&&(Gt.REACT_APP_SC_ATTR||Gt.SC_ATTR)||"data-styled",Vn=typeof window<"u"&&"HTMLElement"in window,Zo=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&Gt!==void 0&&(Gt.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&Gt.REACT_APP_SC_DISABLE_SPEEDY!==""?Gt.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&Gt.REACT_APP_SC_DISABLE_SPEEDY:Gt.SC_DISABLE_SPEEDY!==void 0&&Gt.SC_DISABLE_SPEEDY!==""&&Gt.SC_DISABLE_SPEEDY!=="false"&&Gt.SC_DISABLE_SPEEDY));function Ae(r){for(var t=arguments.length,e=new Array(t>1?t-1:0),i=1;i<t;i++)e[i-1]=arguments[i];throw new Error("An error occurred. See https://git.io/JUIaE#"+r+" for more information."+(e.length>0?" Args: "+e.join(", "):""))}var Qo=(function(){function r(e){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=e}var t=r.prototype;return t.indexOfGroup=function(e){for(var i=0,n=0;n<e;n++)i+=this.groupSizes[n];return i},t.insertRules=function(e,i){if(e>=this.groupSizes.length){for(var n=this.groupSizes,s=n.length,a=s;e>=a;)(a<<=1)<0&&Ae(16,""+e);this.groupSizes=new Uint32Array(a),this.groupSizes.set(n),this.length=a;for(var o=s;o<a;o++)this.groupSizes[o]=0}for(var l=this.indexOfGroup(e+1),c=0,h=i.length;c<h;c++)this.tag.insertRule(l,i[c])&&(this.groupSizes[e]++,l++)},t.clearGroup=function(e){if(e<this.length){var i=this.groupSizes[e],n=this.indexOfGroup(e),s=n+i;this.groupSizes[e]=0;for(var a=n;a<s;a++)this.tag.deleteRule(n)}},t.getGroup=function(e){var i="";if(e>=this.length||this.groupSizes[e]===0)return i;for(var n=this.groupSizes[e],s=this.indexOfGroup(e),a=s+n,o=s;o<a;o++)i+=this.tag.getRule(o)+`/*!sc*/
`;return i},r})(),wi=new Map,Pi=new Map,ii=1,gi=function(r){if(wi.has(r))return wi.get(r);for(;Pi.has(ii);)ii++;var t=ii++;return wi.set(r,t),Pi.set(t,r),t},Jo=function(r){return Pi.get(r)},tl=function(r,t){t>=ii&&(ii=t+1),wi.set(r,t),Pi.set(t,r)},el="style["+Ue+'][data-styled-version="5.3.11"]',il=new RegExp("^"+Ue+'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)'),nl=function(r,t,e){for(var i,n=e.split(","),s=0,a=n.length;s<a;s++)(i=n[s])&&r.registerName(t,i)},sl=function(r,t){for(var e=(t.textContent||"").split(`/*!sc*/
`),i=[],n=0,s=e.length;n<s;n++){var a=e[n].trim();if(a){var o=a.match(il);if(o){var l=0|parseInt(o[1],10),c=o[2];l!==0&&(tl(c,l),nl(r,c,o[3]),r.getTag().insertRules(l,i)),i.length=0}else i.push(a)}}},rl=function(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null},ea=function(r){var t=document.head,e=r||t,i=document.createElement("style"),n=(function(o){for(var l=o.childNodes,c=l.length;c>=0;c--){var h=l[c];if(h&&h.nodeType===1&&h.hasAttribute(Ue))return h}})(e),s=n!==void 0?n.nextSibling:null;i.setAttribute(Ue,"active"),i.setAttribute("data-styled-version","5.3.11");var a=rl();return a&&i.setAttribute("nonce",a),e.insertBefore(i,s),i},al=(function(){function r(e){var i=this.element=ea(e);i.appendChild(document.createTextNode("")),this.sheet=(function(n){if(n.sheet)return n.sheet;for(var s=document.styleSheets,a=0,o=s.length;a<o;a++){var l=s[a];if(l.ownerNode===n)return l}Ae(17)})(i),this.length=0}var t=r.prototype;return t.insertRule=function(e,i){try{return this.sheet.insertRule(i,e),this.length++,!0}catch{return!1}},t.deleteRule=function(e){this.sheet.deleteRule(e),this.length--},t.getRule=function(e){var i=this.sheet.cssRules[e];return i!==void 0&&typeof i.cssText=="string"?i.cssText:""},r})(),ol=(function(){function r(e){var i=this.element=ea(e);this.nodes=i.childNodes,this.length=0}var t=r.prototype;return t.insertRule=function(e,i){if(e<=this.length&&e>=0){var n=document.createTextNode(i),s=this.nodes[e];return this.element.insertBefore(n,s||null),this.length++,!0}return!1},t.deleteRule=function(e){this.element.removeChild(this.nodes[e]),this.length--},t.getRule=function(e){return e<this.length?this.nodes[e].textContent:""},r})(),ll=(function(){function r(e){this.rules=[],this.length=0}var t=r.prototype;return t.insertRule=function(e,i){return e<=this.length&&(this.rules.splice(e,0,i),this.length++,!0)},t.deleteRule=function(e){this.rules.splice(e,1),this.length--},t.getRule=function(e){return e<this.length?this.rules[e]:""},r})(),ws=Vn,cl={isServer:!Vn,useCSSOMInjection:!Zo},ia=(function(){function r(e,i,n){e===void 0&&(e=ue),i===void 0&&(i={}),this.options=Qt({},cl,{},e),this.gs=i,this.names=new Map(n),this.server=!!e.isServer,!this.server&&Vn&&ws&&(ws=!1,(function(s){for(var a=document.querySelectorAll(el),o=0,l=a.length;o<l;o++){var c=a[o];c&&c.getAttribute(Ue)!=="active"&&(sl(s,c),c.parentNode&&c.parentNode.removeChild(c))}})(this))}r.registerId=function(e){return gi(e)};var t=r.prototype;return t.reconstructWithOptions=function(e,i){return i===void 0&&(i=!0),new r(Qt({},this.options,{},e),this.gs,i&&this.names||void 0)},t.allocateGSInstance=function(e){return this.gs[e]=(this.gs[e]||0)+1},t.getTag=function(){return this.tag||(this.tag=(n=(i=this.options).isServer,s=i.useCSSOMInjection,a=i.target,e=n?new ll(a):s?new al(a):new ol(a),new Qo(e)));var e,i,n,s,a},t.hasNameForId=function(e,i){return this.names.has(e)&&this.names.get(e).has(i)},t.registerName=function(e,i){if(gi(e),this.names.has(e))this.names.get(e).add(i);else{var n=new Set;n.add(i),this.names.set(e,n)}},t.insertRules=function(e,i,n){this.registerName(e,i),this.getTag().insertRules(gi(e),n)},t.clearNames=function(e){this.names.has(e)&&this.names.get(e).clear()},t.clearRules=function(e){this.getTag().clearGroup(gi(e)),this.clearNames(e)},t.clearTag=function(){this.tag=void 0},t.toString=function(){return(function(e){for(var i=e.getTag(),n=i.length,s="",a=0;a<n;a++){var o=Jo(a);if(o!==void 0){var l=e.names.get(o),c=i.getGroup(a);if(l&&c&&l.size){var h=Ue+".g"+a+'[id="'+o+'"]',d="";l!==void 0&&l.forEach((function(u){u.length>0&&(d+=u+",")})),s+=""+c+h+'{content:"'+d+`"}/*!sc*/
`}}}return s})(this)},r})(),hl=/(a)(d)/gi,xs=function(r){return String.fromCharCode(r+(r>25?39:97))};function xn(r){var t,e="";for(t=Math.abs(r);t>52;t=t/52|0)e=xs(t%52)+e;return(xs(t%52)+e).replace(hl,"$1-$2")}var Oe=function(r,t){for(var e=t.length;e;)r=33*r^t.charCodeAt(--e);return r},na=function(r){return Oe(5381,r)};function dl(r){for(var t=0;t<r.length;t+=1){var e=r[t];if(He(e)&&!Gn(e))return!1}return!0}var ul=na("5.3.11"),fl=(function(){function r(t,e,i){this.rules=t,this.staticRulesId="",this.isStatic=(i===void 0||i.isStatic)&&dl(t),this.componentId=e,this.baseHash=Oe(ul,e),this.baseStyle=i,ia.registerId(e)}return r.prototype.generateAndInjectStyles=function(t,e,i){var n=this.componentId,s=[];if(this.baseStyle&&s.push(this.baseStyle.generateAndInjectStyles(t,e,i)),this.isStatic&&!i.hash)if(this.staticRulesId&&e.hasNameForId(n,this.staticRulesId))s.push(this.staticRulesId);else{var a=$e(this.rules,t,e,i).join(""),o=xn(Oe(this.baseHash,a)>>>0);if(!e.hasNameForId(n,o)){var l=i(a,"."+o,void 0,n);e.insertRules(n,o,l)}s.push(o),this.staticRulesId=o}else{for(var c=this.rules.length,h=Oe(this.baseHash,i.hash),d="",u=0;u<c;u++){var p=this.rules[u];if(typeof p=="string")d+=p;else if(p){var f=$e(p,t,e,i),m=Array.isArray(f)?f.join(""):f;h=Oe(h,m+u),d+=m}}if(d){var b=xn(h>>>0);if(!e.hasNameForId(n,b)){var g=i(d,"."+b,void 0,n);e.insertRules(n,b,g)}s.push(b)}}return s.join(" ")},r})(),pl=/^\s*\/\/.*$/gm,gl=[":","[",".","#"];function ml(r){var t,e,i,n,s=ue,a=s.options,o=a===void 0?ue:a,l=s.plugins,c=l===void 0?Ci:l,h=new Go(o),d=[],u=(function(m){function b(g){if(g)try{m(g+"}")}catch{}}return function(g,y,x,w,v,R,I,j,H,z){switch(g){case 1:if(H===0&&y.charCodeAt(0)===64)return m(y+";"),"";break;case 2:if(j===0)return y+"/*|*/";break;case 3:switch(j){case 102:case 112:return m(x[0]+y),"";default:return y+(z===0?"/*|*/":"")}case-2:y.split("/*|*/}").forEach(b)}}})((function(m){d.push(m)})),p=function(m,b,g){return b===0&&gl.indexOf(g[e.length])!==-1||g.match(n)?m:"."+t};function f(m,b,g,y){y===void 0&&(y="&");var x=m.replace(pl,""),w=b&&g?g+" "+b+" { "+x+" }":x;return t=y,e=b,i=new RegExp("\\"+e+"\\b","g"),n=new RegExp("(\\"+e+"\\b){2,}"),h(g||!b?"":b,w)}return h.use([].concat(c,[function(m,b,g){m===2&&g.length&&g[0].lastIndexOf(e)>0&&(g[0]=g[0].replace(i,p))},u,function(m){if(m===-2){var b=d;return d=[],b}}])),f.hash=c.length?c.reduce((function(m,b){return b.name||Ae(15),Oe(m,b.name)}),5381).toString():"",f}var sa=P.createContext();sa.Consumer;var ra=P.createContext(),bl=(ra.Consumer,new ia),Sn=ml();function vl(){return M.useContext(sa)||bl}function yl(){return M.useContext(ra)||Sn}var aa=(function(){function r(t,e){var i=this;this.inject=function(n,s){s===void 0&&(s=Sn);var a=i.name+s.hash;n.hasNameForId(i.id,a)||n.insertRules(i.id,a,s(i.rules,a,"@keyframes"))},this.toString=function(){return Ae(12,String(i.name))},this.name=t,this.id="sc-keyframes-"+t,this.rules=e}return r.prototype.getName=function(t){return t===void 0&&(t=Sn),this.name+t.hash},r})(),_l=/([A-Z])/,Al=/([A-Z])/g,El=/^ms-/,wl=function(r){return"-"+r.toLowerCase()};function Ss(r){return _l.test(r)?r.replace(Al,wl).replace(El,"-ms-"):r}var Ts=function(r){return r==null||r===!1||r===""};function $e(r,t,e,i){if(Array.isArray(r)){for(var n,s=[],a=0,o=r.length;a<o;a+=1)(n=$e(r[a],t,e,i))!==""&&(Array.isArray(n)?s.push.apply(s,n):s.push(n));return s}if(Ts(r))return"";if(Gn(r))return"."+r.styledComponentId;if(He(r)){if(typeof(c=r)!="function"||c.prototype&&c.prototype.isReactComponent||!t)return r;var l=r(t);return $e(l,t,e,i)}var c;return r instanceof aa?e?(r.inject(e,i),r.getName(i)):r:wn(r)?(function h(d,u){var p,f,m=[];for(var b in d)d.hasOwnProperty(b)&&!Ts(d[b])&&(Array.isArray(d[b])&&d[b].isCss||He(d[b])?m.push(Ss(b)+":",d[b],";"):wn(d[b])?m.push.apply(m,h(d[b],b)):m.push(Ss(b)+": "+(p=b,(f=d[b])==null||typeof f=="boolean"||f===""?"":typeof f!="number"||f===0||p in Vo||p.startsWith("--")?String(f).trim():f+"px")+";"));return u?[u+" {"].concat(m,["}"]):m})(r):r.toString()}var Cs=function(r){return Array.isArray(r)&&(r.isCss=!0),r};function ji(r){for(var t=arguments.length,e=new Array(t>1?t-1:0),i=1;i<t;i++)e[i-1]=arguments[i];return He(r)||wn(r)?Cs($e(As(Ci,[r].concat(e)))):e.length===0&&r.length===1&&typeof r[0]=="string"?r:Cs($e(As(r,e)))}var xl=function(r,t,e){return e===void 0&&(e=ue),r.theme!==e.theme&&r.theme||t||e.theme},Sl=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,Tl=/(^-|-$)/g;function un(r){return r.replace(Sl,"-").replace(Tl,"")}var oa=function(r){return xn(na(r)>>>0)};function mi(r){return typeof r=="string"&&!0}var Tn=function(r){return typeof r=="function"||typeof r=="object"&&r!==null&&!Array.isArray(r)},Cl=function(r){return r!=="__proto__"&&r!=="constructor"&&r!=="prototype"};function Pl(r,t,e){var i=r[e];Tn(t)&&Tn(i)?la(i,t):r[e]=t}function la(r){for(var t=arguments.length,e=new Array(t>1?t-1:0),i=1;i<t;i++)e[i-1]=arguments[i];for(var n=0,s=e;n<s.length;n++){var a=s[n];if(Tn(a))for(var o in a)Cl(o)&&Pl(r,a[o],o)}return r}var Ri=P.createContext();Ri.Consumer;function Rl(r){var t=M.useContext(Ri),e=M.useMemo((function(){return(function(i,n){if(!i)return Ae(14);if(He(i)){var s=i(n);return s}return Array.isArray(i)||typeof i!="object"?Ae(8):n?Qt({},n,{},i):i})(r.theme,t)}),[r.theme,t]);return r.children?P.createElement(Ri.Provider,{value:e},r.children):null}var fn={};function ca(r,t,e){var i=Gn(r),n=!mi(r),s=t.attrs,a=s===void 0?Ci:s,o=t.componentId,l=o===void 0?(function(y,x){var w=typeof y!="string"?"sc":un(y);fn[w]=(fn[w]||0)+1;var v=w+"-"+oa("5.3.11"+w+fn[w]);return x?x+"-"+v:v})(t.displayName,t.parentComponentId):o,c=t.displayName,h=c===void 0?(function(y){return mi(y)?"styled."+y:"Styled("+Es(y)+")"})(r):c,d=t.displayName&&t.componentId?un(t.displayName)+"-"+t.componentId:t.componentId||l,u=i&&r.attrs?Array.prototype.concat(r.attrs,a).filter(Boolean):a,p=t.shouldForwardProp;i&&r.shouldForwardProp&&(p=t.shouldForwardProp?function(y,x,w){return r.shouldForwardProp(y,x,w)&&t.shouldForwardProp(y,x,w)}:r.shouldForwardProp);var f,m=new fl(e,d,i?r.componentStyle:void 0),b=m.isStatic&&a.length===0,g=function(y,x){return(function(w,v,R,I){var j=w.attrs,H=w.componentStyle,z=w.defaultProps,D=w.foldedComponentIds,$=w.shouldForwardProp,W=w.styledComponentId,Y=w.target,G=(function(U,E,N){U===void 0&&(U=ue);var k=Qt({},E,{theme:U}),rt={};return N.forEach((function(V){var at,X,Q,ot=V;for(at in He(ot)&&(ot=ot(k)),ot)k[at]=rt[at]=at==="className"?(X=rt[at],Q=ot[at],X&&Q?X+" "+Q:X||Q):ot[at]})),[k,rt]})(xl(v,M.useContext(Ri),z)||ue,v,j),J=G[0],F=G[1],_=(function(U,E,N,k){var rt=vl(),V=yl(),at=E?U.generateAndInjectStyles(ue,rt,V):U.generateAndInjectStyles(N,rt,V);return at})(H,I,J),A=R,C=F.$as||v.$as||F.as||v.as||Y,O=mi(C),S=F!==v?Qt({},v,{},F):v,T={};for(var L in S)L[0]!=="$"&&L!=="as"&&(L==="forwardedAs"?T.as=S[L]:($?$(L,ys,C):!O||ys(L))&&(T[L]=S[L]));return v.style&&F.style!==v.style&&(T.style=Qt({},v.style,{},F.style)),T.className=Array.prototype.concat(D,W,_!==W?_:null,v.className,F.className).filter(Boolean).join(" "),T.ref=A,M.createElement(C,T)})(f,y,x,b)};return g.displayName=h,(f=P.forwardRef(g)).attrs=u,f.componentStyle=m,f.displayName=h,f.shouldForwardProp=p,f.foldedComponentIds=i?Array.prototype.concat(r.foldedComponentIds,r.styledComponentId):Ci,f.styledComponentId=d,f.target=i?r.target:r,f.withComponent=function(y){var x=t.componentId,w=(function(R,I){if(R==null)return{};var j,H,z={},D=Object.keys(R);for(H=0;H<D.length;H++)j=D[H],I.indexOf(j)>=0||(z[j]=R[j]);return z})(t,["componentId"]),v=x&&x+"-"+(mi(y)?y:un(Es(y)));return ca(y,Qt({},w,{attrs:u,componentId:v}),e)},Object.defineProperty(f,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(y){this._foldedDefaultProps=i?la({},r.defaultProps,y):y}}),Object.defineProperty(f,"toString",{value:function(){return"."+f.styledComponentId}}),n&&Ko(f,r,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0,withComponent:!0}),f}var lt=function(r){return(function t(e,i,n){if(n===void 0&&(n=ue),!ta.isValidElementType(i))return Ae(1,String(i));var s=function(){return e(i,n,ji.apply(void 0,arguments))};return s.withConfig=function(a){return t(e,i,Qt({},n,{},a))},s.attrs=function(a){return t(e,i,Qt({},n,{attrs:Array.prototype.concat(n.attrs,a).filter(Boolean)}))},s})(ca,r)};["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","textPath","tspan"].forEach((function(r){lt[r]=lt(r)}));function Ll(r){for(var t=arguments.length,e=new Array(t>1?t-1:0),i=1;i<t;i++)e[i-1]=arguments[i];var n=ji.apply(void 0,[r].concat(e)).join(""),s=oa(n);return new aa(s,n)}var ha="SET_ALL_DOCUMENTS",kl=function(r){return{type:ha,documents:r}},da="SET_DOCUMENT_LOADING",pn=function(r){return{type:da,value:r}},ua="NEXT_DOCUMENT",fa=function(){return{type:ua}},pa="PREVIOUS_DOCUMENT",ga=function(){return{type:pa}},ma="UPDATE_CURRENT_DOCUMENT",Ps=function(r){return{type:ma,document:r}},ba="SET_RENDERER_RECT",Il=function(r){return{type:ba,rect:r}},va="SET_MAIN_CONFIG",Ml=function(r){return{type:va,config:r}},Lt=function(){return Lt=Object.assign||function(r){for(var t,e=1,i=arguments.length;e<i;e++){t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Lt.apply(this,arguments)},Wn={currentFileNo:0,documents:[],documentLoading:!0,currentDocument:void 0,rendererRect:void 0,config:{},pluginRenderers:[]},Ol=function(r,t){switch(r===void 0&&(r=Wn),t.type){case ha:{var e=t.documents;return Lt(Lt({},r),{documents:e,currentDocument:e[0]||null})}case da:{var i=t.value;return Lt(Lt({},r),{documentLoading:i})}case ua:{if(r.currentFileNo>=r.documents.length-1)return r;var n=r.currentFileNo+1;return Lt(Lt({},r),{currentFileNo:n,currentDocument:r.documents[n],documentLoading:!0})}case pa:{if(r.currentFileNo<=0)return r;var s=r.currentFileNo-1;return Lt(Lt({},r),{currentFileNo:r.currentFileNo-1,currentDocument:r.documents[s],documentLoading:!0})}case ma:{var a=t.document;return Lt(Lt({},r),{currentDocument:a})}case ba:{var o=t.rect;return Lt(Lt({},r),{rendererRect:o})}case va:{var l=t.config;return Lt(Lt({},r),{config:l})}default:return r}},Li=function(){return Li=Object.assign||function(r){for(var t,e=1,i=arguments.length;e<i;e++){t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Li.apply(this,arguments)},Ye=M.createContext({state:Wn,dispatch:function(){return null}}),Dl=function(r){var t=r.children,e=r.documents,i=r.config,n=r.pluginRenderers,s=M.useReducer(Ol,Li(Li({},Wn),{documents:e||[],currentDocument:e&&e.length?e[0]:void 0,config:i,pluginRenderers:n})),a=s[0],o=s[1];return M.useEffect(function(){o(kl(e)),i&&o(Ml(i))},[e]),P.createElement(Ye.Provider,{value:{state:a,dispatch:o}},t)},qe=function(r,t){return Object.defineProperty?Object.defineProperty(r,"raw",{value:t}):r.raw=t,r},Fl=ji(Rs||(Rs=qe([`
  background-color: `,`;
  color: `,`;
`],[`
  background-color: `,`;
  color: `,`;
`])),function(r){return r.theme.primary},function(r){return r.theme.text_primary}),Nl=ji(Ls||(Ls=qe([`
  background-color: `,`;
  color: `,`;
`],[`
  background-color: `,`;
  color: `,`;
`])),function(r){return r.theme.secondary},function(r){return r.theme.text_secondary}),Hi=lt.button(ks||(ks=qe([`
  `,`
  display: flex;
  justify-content: center;
  align-items: center;
  width: 35px;
  height: 35px;
  padding: 0;
  margin: 0 0 0 5px;
  text-align: center;
  font-size: 18px;
  border: 0;
  outline: none;
  cursor: pointer;
  text-decoration: none;
  border-radius: 35px;
  opacity: `,`;
  pointer-events: `,`;
  box-shadow: 2px 2px 3px #00000033;

  @media (max-width: 768px) {
    width: 30px;
    height: 30px;
    font-size: 15px;
  }
`],[`
  `,`
  display: flex;
  justify-content: center;
  align-items: center;
  width: 35px;
  height: 35px;
  padding: 0;
  margin: 0 0 0 5px;
  text-align: center;
  font-size: 18px;
  border: 0;
  outline: none;
  cursor: pointer;
  text-decoration: none;
  border-radius: 35px;
  opacity: `,`;
  pointer-events: `,`;
  box-shadow: 2px 2px 3px #00000033;

  @media (max-width: 768px) {
    width: 30px;
    height: 30px;
    font-size: 15px;
  }
`])),Fl,function(r){return r.disabled?.4:1},function(r){return r.disabled?"none":"all"}),ya=lt.a(Is||(Is=qe([`
  display: flex;
  justify-content: center;
  align-items: center;
  border: 0;
  outline: none;
  cursor: pointer;
  text-decoration: none;
  border-radius: 35px;
  background-color: `,`;
  color: `,`;
  box-shadow: 2px 2px 3px #00000033;

  width: 35px;
  height: 35px;
  font-size: 18px;
  @media (max-width: 768px) {
    width: 30px;
    height: 30px;
    font-size: 15px;
  }
`],[`
  display: flex;
  justify-content: center;
  align-items: center;
  border: 0;
  outline: none;
  cursor: pointer;
  text-decoration: none;
  border-radius: 35px;
  background-color: `,`;
  color: `,`;
  box-shadow: 2px 2px 3px #00000033;

  width: 35px;
  height: 35px;
  font-size: 18px;
  @media (max-width: 768px) {
    width: 30px;
    height: 30px;
    font-size: 15px;
  }
`])),function(r){return r.theme.primary},function(r){return r.theme.text_primary});lt(Hi)(Ms||(Ms=qe([""],[""])));var Bl=lt(Hi)(Os||(Os=qe([`
  `,`
`],[`
  `,`
`])),Nl),Rs,Ls,ks,Is,Ms,Os,ki=function(){return ki=Object.assign||function(r){for(var t,e=1,i=arguments.length;e<i;e++){t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},ki.apply(this,arguments)},jl=function(r){return P.createElement(_a,ki({},r))},Hl=function(r){return P.createElement(_a,ki({},r,{reverse:!0}))},_a=function(r){var t=r.color,e=r.size,i=r.reverse;return P.createElement("svg",{width:e||"100%",height:e||"100%",style:{transform:"".concat(i?"rotate(180deg)":"")},id:"arrow_left",version:"1.1",viewBox:"0 0 32 32",xmlSpace:"preserve"},P.createElement("path",{clipRule:"evenodd",d:"M31.106,15H3.278l8.325-8.293  c0.391-0.391,0.391-1.024,0-1.414c-0.391-0.391-1.024-0.391-1.414,0l-9.9,9.899c-0.385,0.385-0.385,1.029,0,1.414l9.9,9.9  c0.391,0.391,1.024,0.391,1.414,0c0.391-0.391,0.391-1.024,0-1.414L3.278,17h27.828c0.552,0,1-0.448,1-1  C32.106,15.448,31.658,15,31.106,15z",fill:t||"#aaa",fillRule:"evenodd",id:"Arrow_Back"}))},Ul=function(r){var t=r.color,e=r.size;return P.createElement("svg",{width:e||"100%",height:e||"100%",version:"1.1",id:"Icons",viewBox:"0 0 32 32",xmlSpace:"preserve",style:{alignSelf:"center",justifySelf:"center"}},P.createElement("g",null,P.createElement("path",{fill:t||"#aaa",d:"M16,2c-0.6,0-1,0.4-1,1v5c0,0.6,0.4,1,1,1s1-0.4,1-1V3C17,2.4,16.6,2,16,2z"}),P.createElement("path",{fill:t||"#aaa",d:`M7.5,6.1c-0.4-0.4-1-0.4-1.4,0s-0.4,1,0,1.4l3.5,3.5c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3c0.4-0.4,0.4-1,0-1.4L7.5,6.1
		z`}),P.createElement("path",{fill:t||"#aaa",d:"M9,16c0-0.6-0.4-1-1-1H3c-0.6,0-1,0.4-1,1s0.4,1,1,1h5C8.6,17,9,16.6,9,16z"}),P.createElement("path",{fill:t||"#aaa",d:`M9.6,20.9l-3.5,3.5c-0.4,0.4-0.4,1,0,1.4c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3l3.5-3.5c0.4-0.4,0.4-1,0-1.4
		S10,20.6,9.6,20.9z`}),P.createElement("path",{fill:t||"#aaa",d:"M16,23c-0.6,0-1,0.4-1,1v5c0,0.6,0.4,1,1,1s1-0.4,1-1v-5C17,23.4,16.6,23,16,23z"}),P.createElement("path",{fill:t||"#aaa",d:`M22.4,20.9c-0.4-0.4-1-0.4-1.4,0s-0.4,1,0,1.4l3.5,3.5c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3c0.4-0.4,0.4-1,0-1.4
		L22.4,20.9z`}),P.createElement("path",{fill:t||"#aaa",d:"M29,15h-5c-0.6,0-1,0.4-1,1s0.4,1,1,1h5c0.6,0,1-0.4,1-1S29.6,15,29,15z"}),P.createElement("path",{fill:t||"#aaa",d:`M21.7,11.3c0.3,0,0.5-0.1,0.7-0.3l3.5-3.5c0.4-0.4,0.4-1,0-1.4s-1-0.4-1.4,0l-3.5,3.5c-0.4,0.4-0.4,1,0,1.4
		C21.1,11.2,21.4,11.3,21.7,11.3z`})))},Yn=function(r,t){return Object.defineProperty?Object.defineProperty(r,"raw",{value:t}):r.raw=t,r},$l=function(){var r=M.useContext(Ye),t=r.state,e=t.currentDocument,i=t.currentFileNo,n=t.documents,s=r.dispatch;if(n.length<=1||!e)return null;var a=e.uri,o=a.split("/");return o.length&&(a=o[o.length-1]),P.createElement(zl,{id:"doc-nav"},P.createElement("p",{id:"doc-nav-info"},"Doc ",i+1," of ",n.length),P.createElement(Aa,{id:"doc-nav-prev",onClick:function(){return s(ga())},disabled:i===0},P.createElement(jl,{color:"#fff",size:"60%"})),P.createElement(Gl,{id:"doc-nav-next",onClick:function(){return s(fa())},disabled:i>=n.length-1},P.createElement(Hl,{color:"#fff",size:"60%"})))},zl=lt.div(Ds||(Ds=Yn([`
  min-width: 150px;
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: flex-end;
  margin: 0 10px;
  color: `,`;
`],[`
  min-width: 150px;
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: flex-end;
  margin: 0 10px;
  color: `,`;
`])),function(r){return r.theme.text_primary}),Aa=lt(Bl)(Fs||(Fs=Yn([`
  width: 30px;
  height: 30px;
  margin: 0 5px 0 10px;

  @media (max-width: 768px) {
    width: 25px;
    height: 25px;
  }
`],[`
  width: 30px;
  height: 30px;
  margin: 0 5px 0 10px;

  @media (max-width: 768px) {
    width: 25px;
    height: 25px;
  }
`]))),Gl=lt(Aa)(Ns||(Ns=Yn([`
  margin: 0 5px;
`],[`
  margin: 0 5px;
`]))),Ds,Fs,Ns,Vl=function(r,t){return Object.defineProperty?Object.defineProperty(r,"raw",{value:t}):r.raw=t,r},Wl=function(){var r,t,e=M.useContext(Ye).state,i=e.config,n=e.currentDocument;if(!n||!((r=i?.header)===null||r===void 0)&&r.disableFileName)return null;var s=n.uri||"";s=decodeURI(s),!((t=i?.header)===null||t===void 0)&&t.retainURLParams||(s=s.split("?")[0]);var a=s.split("/");return a.length&&(s=a[a.length-1]),P.createElement(Yl,{id:"file-name","data-testid":"file-name"},s)},Yl=lt.div(Bs||(Bs=Vl([`
  flex: 1;
  text-align: left;
  color: `,`;
  font-weight: bold;
  margin: 0 10px;
  overflow: hidden;
`],[`
  flex: 1;
  text-align: left;
  color: `,`;
  font-weight: bold;
  margin: 0 10px;
  overflow: hidden;
`])),function(r){return r.theme.text_primary}),Bs,ql=function(r,t){return Object.defineProperty?Object.defineProperty(r,"raw",{value:t}):r.raw=t,r},Xl=function(){var r,t,e,i=M.useContext(Ye),n=i.state,s=i.dispatch,a=n.config;if(!((r=a?.header)===null||r===void 0)&&r.disableHeader)return null;var o=(e=(t=a?.header)===null||t===void 0?void 0:t.overrideComponent)===null||e===void 0?void 0:e.call(t,n,function(){return s(ga())},function(){return s(fa())});return o||P.createElement(Kl,{id:"header-bar","data-testid":"header-bar"},P.createElement(Wl,null),P.createElement($l,null))},Kl=lt.div(js||(js=ql([`
  display: flex;
  justify-content: flex-end;
  align-items: center;
  z-index: 1;
  padding: 0 10px;
  background-color: `,`;
  font-size: 16px;
  min-height: 50px;

  @media (max-width: 768px) {
    min-height: 30px;
    padding: 5px;
    font-size: 10px;
  }
`],[`
  display: flex;
  justify-content: flex-end;
  align-items: center;
  z-index: 1;
  padding: 0 10px;
  background-color: `,`;
  font-size: 16px;
  min-height: 50px;

  @media (max-width: 768px) {
    min-height: 30px;
    padding: 5px;
    font-size: 10px;
  }
`])),function(r){return r.theme.primary}),js,fe=function(){return fe=Object.assign||function(r){for(var t,e=1,i=arguments.length;e<i;e++){t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},fe.apply(this,arguments)},Zl=function(r,t,e,i){function n(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function o(h){try{c(i.next(h))}catch(d){a(d)}}function l(h){try{c(i.throw(h))}catch(d){a(d)}}function c(h){h.done?s(h.value):n(h.value).then(o,l)}c((i=i.apply(r,t||[])).next())})},Ql=function(r,t){var e={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,a;return a={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(c){return function(h){return l([c,h])}}function l(c){if(i)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(e=0)),e;)try{if(i=1,n&&(s=c[0]&2?n.return:c[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,c[1])).done)return s;switch(n=0,s&&(c=[c[0]&2,s.value]),c[0]){case 0:case 1:s=c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++,n=c[1],c=[0];continue;case 7:c=e.ops.pop(),e.trys.pop();continue;default:if(s=e.trys,!(s=s.length>0&&s[s.length-1])&&(c[0]===6||c[0]===2)){e=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){e.label=c[1];break}if(c[0]===6&&e.label<s[1]){e.label=s[1],s=c;break}if(s&&e.label<s[2]){e.label=s[2],e.ops.push(c);break}s[2]&&e.ops.pop(),e.trys.pop();continue}c=t.call(r,e)}catch(h){c=[6,h],n=0}finally{i=s=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},qn=function(r){var t=r.documentURI,e=r.signal,i=r.fileLoaderComplete,n=r.readerTypeFunction;return fetch(t,{signal:e}).then(function(s){return Zl(void 0,void 0,void 0,function(){var a,o;return Ql(this,function(l){switch(l.label){case 0:return[4,s.blob()];case 1:switch(a=l.sent(),o=new FileReader,o.addEventListener("loadend",function(){return i(o)}),n){case"arrayBuffer":o.readAsArrayBuffer(a);break;case"binaryString":o.readAsBinaryString(a);break;case"dataURL":o.readAsDataURL(a);break;case"text":o.readAsText(a);break}return[2]}})})}).catch(function(s){return s})},Ea=function(r){return qn(fe(fe({},r),{readerTypeFunction:"arrayBuffer"}))},wa=function(r){return qn(fe(fe({},r),{readerTypeFunction:"dataURL"}))},Jl=function(r){return qn(fe(fe({},r),{readerTypeFunction:"text"}))},tc=wa,ec=function(){var r=M.useContext(Ye).state,t=r.currentDocument,e=r.pluginRenderers,i=M.useState(),n=i[0],s=i[1];return M.useEffect(function(){if(t){if(!t.fileType){s(void 0);return}var a=[];e?.map(function(l){t.fileType!==void 0&&l.fileTypes.indexOf(t.fileType)>=0&&a.push(l)});var o=a.sort(function(l,c){return c.weight-l.weight})[0];s(o&&o!==void 0?function(){return o}:null)}},[t]),{CurrentRenderer:n}},ni=function(){return ni=Object.assign||function(r){for(var t,e=1,i=arguments.length;e<i;e++){t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},ni.apply(this,arguments)},ic=function(){var r=M.useContext(Ye),t=r.state,e=r.dispatch,i=t.currentFileNo,n=t.currentDocument,s=ec().CurrentRenderer,a=n?.uri||"";return M.useEffect(function(){if(n&&n.fileType===void 0){var o=new AbortController,l=o.signal;return fetch(a,{method:"HEAD",signal:l}).then(function(c){var h=c.headers.get("content-type"),d=h?.split(";")||[],u=d.length?d[0]:void 0;e(Ps(ni(ni({},n),{fileType:u||void 0})))}),function(){o.abort()}}},[i,a]),M.useEffect(function(){var o;if(!(!n||s===void 0)){var l=new AbortController,c=l.signal,h=function(d){if(!n||!d){e(pn(!1));return}var u=ni({},n);d.result!==null&&(u.fileData=d.result),e(Ps(u)),e(pn(!1))};return s===null?e(pn(!1)):s.fileLoader!==void 0?(o=s.fileLoader)===null||o===void 0||o.call(s,{documentURI:a,signal:c,fileLoaderComplete:h}):tc({documentURI:a,signal:c,fileLoaderComplete:h}),function(){l.abort()}}},[s]),{state:t,dispatch:e,CurrentRenderer:s}},nc=function(){var r=M.useState({width:void 0,height:void 0}),t=r[0],e=r[1];return M.useEffect(function(){function i(){e({width:window.innerWidth,height:window.innerHeight})}return window.addEventListener("resize",i),i(),function(){return window.removeEventListener("resize",i)}},[]),t},oi=function(r,t){return Object.defineProperty?Object.defineProperty(r,"raw",{value:t}):r.raw=t,r},sc=function(){var r=ic(),t=r.state,e=r.dispatch,i=r.CurrentRenderer,n=t.documents,s=t.documentLoading,a=t.currentDocument,o=nc(),l=M.useCallback(function(h){h&&e(Il(h?.getBoundingClientRect()))},[o]),c=function(){return n.length?s?P.createElement(ac,{id:"loading-renderer","data-testid":"loading-renderer"},P.createElement(lc,null,P.createElement(Ul,{color:"#444",size:40}))):i?P.createElement(i,{mainState:t}):i===void 0?null:P.createElement("div",{id:"no-renderer","data-testid":"no-renderer"},"No Renderer for file type ",a?.fileType,P.createElement(cc,{id:"no-renderer-download",href:a?.uri,download:a?.uri},"Download File")):P.createElement("div",{id:"no-documents"})};return P.createElement(rc,{id:"proxy-renderer",ref:l},P.createElement(c,null))},rc=lt.div(Hs||(Hs=oi([`
  display: flex;
  flex: 1;
  overflow-y: auto;
`],[`
  display: flex;
  flex: 1;
  overflow-y: auto;
`]))),ac=lt.div(Us||(Us=oi([`
  display: flex;
  flex: 1;
  height: 75px;
  align-items: center;
  justify-content: center;
`],[`
  display: flex;
  flex: 1;
  height: 75px;
  align-items: center;
  justify-content: center;
`]))),oc=Ll($s||($s=oi([`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`],[`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`]))),lc=lt.div(zs||(zs=oi([`
  animation-name: `,`;
  animation-duration: 4s;
  animation-timing-function: linear;
  animation-iteration-count: infinite;
`],[`
  animation-name: `,`;
  animation-duration: 4s;
  animation-timing-function: linear;
  animation-iteration-count: infinite;
`])),oc),cc=lt(ya)(Gs||(Gs=oi([`
  width: 130px;
  height: 30px;
  background-color: `,`;
  @media (max-width: 768px) {
    width: 125px;
    height: 25px;
  }
`],[`
  width: 130px;
  height: 30px;
  background-color: `,`;
  @media (max-width: 768px) {
    width: 125px;
    height: 25px;
  }
`])),function(r){return r.theme.primary}),Hs,Us,$s,zs,Gs,xa=function(r,t){return Object.defineProperty?Object.defineProperty(r,"raw",{value:t}):r.raw=t,r},Cn=function(){return Cn=Object.assign||function(r){for(var t,e=1,i=arguments.length;e<i;e++){t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Cn.apply(this,arguments)},Ee=function(r){var t=r.mainState.currentDocument,e=r.children;return t?P.createElement(hc,Cn({id:"image-renderer"},r),e||P.createElement(dc,{id:"image-img",src:t.fileData})):null};Ee.fileTypes=[];Ee.weight=0;var hc=lt.div(Vs||(Vs=xa([`
  display: flex;
  flex: 1;
  align-items: center;
  justify-content: center;
  width: 100%;
  height: 100%;
  background-color: #fff;
`],[`
  display: flex;
  flex: 1;
  align-items: center;
  justify-content: center;
  width: 100%;
  height: 100%;
  background-color: #fff;
`]))),dc=lt.img(Ws||(Ws=xa([`
  max-width: 95%;
  max-height: 95%;
`],[`
  max-width: 95%;
  max-height: 95%;
`]))),Vs,Ws,Pn=function(){return Pn=Object.assign||function(r){for(var t,e=1,i=arguments.length;e<i;e++){t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Pn.apply(this,arguments)},Xn=function(r){return P.createElement(Ee,Pn({},r))};Xn.fileTypes=["bmp","image/bmp"];Xn.weight=0;var Sa=function(r,t){return Object.defineProperty?Object.defineProperty(r,"raw",{value:t}):r.raw=t,r},Ui=function(r){var t=r.mainState.currentDocument;return M.useEffect(function(){var e=t?.fileData,i=e?.replace("data:text/html;base64,","")||"",n=window.atob(i),s=document.getElementById("html-body"),a=s?.contentWindow&&s.contentWindow;if(a){var o=a.document;o.open(),o.write("".concat(n)),o.close()}},[]),P.createElement(uc,{id:"html-renderer"},P.createElement(fc,{id:"html-body",sandbox:"allow-same-origin"}))};Ui.fileTypes=["htm","html","text/htm","text/html"];Ui.weight=0;Ui.fileLoader=wa;var uc=lt.div(Ys||(Ys=Sa([`
  display: flex;
  flex-direction: column;
  width: 100%;
  padding: 0 30px;
`],[`
  display: flex;
  flex-direction: column;
  width: 100%;
  padding: 0 30px;
`]))),fc=lt.iframe(qs||(qs=Sa([`
  height: 100%;
  padding: 15px;
  margin: 20px 0 20px 0;
  border: 1px solid `,`;
`],[`
  height: 100%;
  padding: 15px;
  margin: 20px 0 20px 0;
  border: 1px solid `,`;
`])),function(r){return r.theme.secondary}),Ys,qs,Rn=function(){return Rn=Object.assign||function(r){for(var t,e=1,i=arguments.length;e<i;e++){t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Rn.apply(this,arguments)},Kn=function(r){return P.createElement(Ee,Rn({},r))};Kn.fileTypes=["jpg","jpeg","image/jpg","image/jpeg"];Kn.weight=0;var Ta=function(r,t){return Object.defineProperty?Object.defineProperty(r,"raw",{value:t}):r.raw=t,r},ke=function(r,t,e){if(e||arguments.length===2)for(var i=0,n=t.length,s;i<n;i++)(s||!(i in t))&&(s||(s=Array.prototype.slice.call(t,0,i)),s[i]=t[i]);return r.concat(s||Array.prototype.slice.call(t))},$i=function(r){var t=r.mainState.currentDocument;return t?P.createElement(pc,{id:"msdoc-renderer"},P.createElement(gc,{id:"msdoc-iframe",title:"msdoc-iframe",src:"https://view.officeapps.live.com/op/embed.aspx?src=".concat(encodeURIComponent(t.uri)),frameBorder:"0"})):null},Ie={doc:["doc","application/msword"],docx:["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],xls:["xls","application/vnd.ms-excel"],xlsx:["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],ppt:["ppt","application/vnd.ms-powerpoint"],pptx:["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"]};$i.fileTypes=ke(ke(ke(ke(ke(ke([],Ie.doc,!0),Ie.docx,!0),Ie.xls,!0),Ie.xlsx,!0),Ie.ppt,!0),Ie.pptx,!0);$i.weight=0;$i.fileLoader=function(r){var t=r.fileLoaderComplete;return t()};var pc=lt.div(Xs||(Xs=Ta([`
  width: 100%;
`],[`
  width: 100%;
`]))),gc=lt.iframe(Ks||(Ks=Ta([`
  width: 100%;
  height: 100%;
  border: 0;
`],[`
  width: 100%;
  height: 100%;
  border: 0;
`]))),Xs,Ks,Ke={},xi={exports:{}},mc=xi.exports,Zs;function Ca(){return Zs||(Zs=1,(function(r,t){(function(e,i){r.exports=i()})(mc,function(){var e=function(i,n,s){this._byteOffset=n||0,i instanceof ArrayBuffer?this.buffer=i:typeof i=="object"?(this.dataView=i,n&&(this._byteOffset+=n)):this.buffer=new ArrayBuffer(i||1),this.position=0,this.endianness=s??e.LITTLE_ENDIAN};return e.prototype={},Uint8Array.prototype.BYTES_PER_ELEMENT===void 0&&(Uint8Array.prototype.BYTES_PER_ELEMENT=Uint8Array.BYTES_PER_ELEMENT,Int8Array.prototype.BYTES_PER_ELEMENT=Int8Array.BYTES_PER_ELEMENT,Uint8ClampedArray.prototype.BYTES_PER_ELEMENT=Uint8ClampedArray.BYTES_PER_ELEMENT,Uint16Array.prototype.BYTES_PER_ELEMENT=Uint16Array.BYTES_PER_ELEMENT,Int16Array.prototype.BYTES_PER_ELEMENT=Int16Array.BYTES_PER_ELEMENT,Uint32Array.prototype.BYTES_PER_ELEMENT=Uint32Array.BYTES_PER_ELEMENT,Int32Array.prototype.BYTES_PER_ELEMENT=Int32Array.BYTES_PER_ELEMENT,Float64Array.prototype.BYTES_PER_ELEMENT=Float64Array.BYTES_PER_ELEMENT),e.prototype.save=function(i){var n=new Blob(this.buffer),s=window.webkitURL||window.URL;if(s&&s.createObjectURL){var a=s.createObjectURL(n),o=document.createElement("a");o.setAttribute("href",a),o.setAttribute("download",i),o.click(),s.revokeObjectURL(a)}else throw"DataStream.save: Can't create object URL."},e.BIG_ENDIAN=!1,e.LITTLE_ENDIAN=!0,e.prototype._dynamicSize=!0,Object.defineProperty(e.prototype,"dynamicSize",{get:function(){return this._dynamicSize},set:function(i){i||this._trimAlloc(),this._dynamicSize=i}}),e.prototype._byteLength=0,Object.defineProperty(e.prototype,"byteLength",{get:function(){return this._byteLength-this._byteOffset}}),Object.defineProperty(e.prototype,"buffer",{get:function(){return this._trimAlloc(),this._buffer},set:function(i){this._buffer=i,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._buffer.byteLength}}),Object.defineProperty(e.prototype,"byteOffset",{get:function(){return this._byteOffset},set:function(i){this._byteOffset=i,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._buffer.byteLength}}),Object.defineProperty(e.prototype,"dataView",{get:function(){return this._dataView},set:function(i){this._byteOffset=i.byteOffset,this._buffer=i.buffer,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._byteOffset+i.byteLength}}),e.prototype._realloc=function(i){if(this._dynamicSize){var n=this._byteOffset+this.position+i,s=this._buffer.byteLength;if(n<=s){n>this._byteLength&&(this._byteLength=n);return}for(s<1&&(s=1);n>s;)s*=2;var a=new ArrayBuffer(s),o=new Uint8Array(this._buffer),l=new Uint8Array(a,0,o.length);l.set(o),this.buffer=a,this._byteLength=n}},e.prototype._trimAlloc=function(){if(this._byteLength!=this._buffer.byteLength){var i=new ArrayBuffer(this._byteLength),n=new Uint8Array(i),s=new Uint8Array(this._buffer,0,n.length);n.set(s),this.buffer=i}},e.prototype.seek=function(i){var n=Math.max(0,Math.min(this.byteLength,i));this.position=isNaN(n)||!isFinite(n)?0:n},e.prototype.isEof=function(){return this.position>=this.byteLength},e.prototype.mapInt32Array=function(i,n){this._realloc(i*4);var s=new Int32Array(this._buffer,this.byteOffset+this.position,i);return e.arrayToNative(s,n??this.endianness),this.position+=i*4,s},e.prototype.mapInt16Array=function(i,n){this._realloc(i*2);var s=new Int16Array(this._buffer,this.byteOffset+this.position,i);return e.arrayToNative(s,n??this.endianness),this.position+=i*2,s},e.prototype.mapInt8Array=function(i){this._realloc(i*1);var n=new Int8Array(this._buffer,this.byteOffset+this.position,i);return this.position+=i*1,n},e.prototype.mapUint32Array=function(i,n){this._realloc(i*4);var s=new Uint32Array(this._buffer,this.byteOffset+this.position,i);return e.arrayToNative(s,n??this.endianness),this.position+=i*4,s},e.prototype.mapUint16Array=function(i,n){this._realloc(i*2);var s=new Uint16Array(this._buffer,this.byteOffset+this.position,i);return e.arrayToNative(s,n??this.endianness),this.position+=i*2,s},e.prototype.mapUint8Array=function(i){this._realloc(i*1);var n=new Uint8Array(this._buffer,this.byteOffset+this.position,i);return this.position+=i*1,n},e.prototype.mapFloat64Array=function(i,n){this._realloc(i*8);var s=new Float64Array(this._buffer,this.byteOffset+this.position,i);return e.arrayToNative(s,n??this.endianness),this.position+=i*8,s},e.prototype.mapFloat32Array=function(i,n){this._realloc(i*4);var s=new Float32Array(this._buffer,this.byteOffset+this.position,i);return e.arrayToNative(s,n??this.endianness),this.position+=i*4,s},e.prototype.readInt32Array=function(i,n){i=i??this.byteLength-this.position/4;var s=new Int32Array(i);return e.memcpy(s.buffer,0,this.buffer,this.byteOffset+this.position,i*s.BYTES_PER_ELEMENT),e.arrayToNative(s,n??this.endianness),this.position+=s.byteLength,s},e.prototype.readInt16Array=function(i,n){i=i??this.byteLength-this.position/2;var s=new Int16Array(i);return e.memcpy(s.buffer,0,this.buffer,this.byteOffset+this.position,i*s.BYTES_PER_ELEMENT),e.arrayToNative(s,n??this.endianness),this.position+=s.byteLength,s},e.prototype.readInt8Array=function(i){i=i??this.byteLength-this.position;var n=new Int8Array(i);return e.memcpy(n.buffer,0,this.buffer,this.byteOffset+this.position,i*n.BYTES_PER_ELEMENT),this.position+=n.byteLength,n},e.prototype.readUint32Array=function(i,n){i=i??this.byteLength-this.position/4;var s=new Uint32Array(i);return e.memcpy(s.buffer,0,this.buffer,this.byteOffset+this.position,i*s.BYTES_PER_ELEMENT),e.arrayToNative(s,n??this.endianness),this.position+=s.byteLength,s},e.prototype.readUint16Array=function(i,n){i=i??this.byteLength-this.position/2;var s=new Uint16Array(i);return e.memcpy(s.buffer,0,this.buffer,this.byteOffset+this.position,i*s.BYTES_PER_ELEMENT),e.arrayToNative(s,n??this.endianness),this.position+=s.byteLength,s},e.prototype.readUint8Array=function(i){i=i??this.byteLength-this.position;var n=new Uint8Array(i);return e.memcpy(n.buffer,0,this.buffer,this.byteOffset+this.position,i*n.BYTES_PER_ELEMENT),this.position+=n.byteLength,n},e.prototype.readFloat64Array=function(i,n){i=i??this.byteLength-this.position/8;var s=new Float64Array(i);return e.memcpy(s.buffer,0,this.buffer,this.byteOffset+this.position,i*s.BYTES_PER_ELEMENT),e.arrayToNative(s,n??this.endianness),this.position+=s.byteLength,s},e.prototype.readFloat32Array=function(i,n){i=i??this.byteLength-this.position/4;var s=new Float32Array(i);return e.memcpy(s.buffer,0,this.buffer,this.byteOffset+this.position,i*s.BYTES_PER_ELEMENT),e.arrayToNative(s,n??this.endianness),this.position+=s.byteLength,s},e.prototype.writeInt32Array=function(i,n){if(this._realloc(i.length*4),i instanceof Int32Array&&this.byteOffset+this.position%i.BYTES_PER_ELEMENT==0)e.memcpy(this._buffer,this.byteOffset+this.position,i.buffer,0,i.byteLength),this.mapInt32Array(i.length,n);else for(var s=0;s<i.length;s++)this.writeInt32(i[s],n)},e.prototype.writeInt16Array=function(i,n){if(this._realloc(i.length*2),i instanceof Int16Array&&this.byteOffset+this.position%i.BYTES_PER_ELEMENT==0)e.memcpy(this._buffer,this.byteOffset+this.position,i.buffer,0,i.byteLength),this.mapInt16Array(i.length,n);else for(var s=0;s<i.length;s++)this.writeInt16(i[s],n)},e.prototype.writeInt8Array=function(i){if(this._realloc(i.length*1),i instanceof Int8Array&&this.byteOffset+this.position%i.BYTES_PER_ELEMENT==0)e.memcpy(this._buffer,this.byteOffset+this.position,i.buffer,0,i.byteLength),this.mapInt8Array(i.length);else for(var n=0;n<i.length;n++)this.writeInt8(i[n])},e.prototype.writeUint32Array=function(i,n){if(this._realloc(i.length*4),i instanceof Uint32Array&&this.byteOffset+this.position%i.BYTES_PER_ELEMENT==0)e.memcpy(this._buffer,this.byteOffset+this.position,i.buffer,0,i.byteLength),this.mapUint32Array(i.length,n);else for(var s=0;s<i.length;s++)this.writeUint32(i[s],n)},e.prototype.writeUint16Array=function(i,n){if(this._realloc(i.length*2),i instanceof Uint16Array&&this.byteOffset+this.position%i.BYTES_PER_ELEMENT==0)e.memcpy(this._buffer,this.byteOffset+this.position,i.buffer,0,i.byteLength),this.mapUint16Array(i.length,n);else for(var s=0;s<i.length;s++)this.writeUint16(i[s],n)},e.prototype.writeUint8Array=function(i){if(this._realloc(i.length*1),i instanceof Uint8Array&&this.byteOffset+this.position%i.BYTES_PER_ELEMENT==0)e.memcpy(this._buffer,this.byteOffset+this.position,i.buffer,0,i.byteLength),this.mapUint8Array(i.length);else for(var n=0;n<i.length;n++)this.writeUint8(i[n])},e.prototype.writeFloat64Array=function(i,n){if(this._realloc(i.length*8),i instanceof Float64Array&&this.byteOffset+this.position%i.BYTES_PER_ELEMENT==0)e.memcpy(this._buffer,this.byteOffset+this.position,i.buffer,0,i.byteLength),this.mapFloat64Array(i.length,n);else for(var s=0;s<i.length;s++)this.writeFloat64(i[s],n)},e.prototype.writeFloat32Array=function(i,n){if(this._realloc(i.length*4),i instanceof Float32Array&&this.byteOffset+this.position%i.BYTES_PER_ELEMENT==0)e.memcpy(this._buffer,this.byteOffset+this.position,i.buffer,0,i.byteLength),this.mapFloat32Array(i.length,n);else for(var s=0;s<i.length;s++)this.writeFloat32(i[s],n)},e.prototype.readInt32=function(i){var n=this._dataView.getInt32(this.position,i??this.endianness);return this.position+=4,n},e.prototype.readInt=function(i){return this.seek(i),this.readInt32()},e.prototype.readInt16=function(i){var n=this._dataView.getInt16(this.position,i??this.endianness);return this.position+=2,n},e.prototype.readShort=function(i){return this.seek(i),this.readInt16()},e.prototype.readInt8=function(){var i=this._dataView.getInt8(this.position);return this.position+=1,i},e.prototype.readByte=function(i){return this.seek(i),this.readInt8()},e.prototype.readUint32=function(i){var n=this._dataView.getUint32(this.position,i??this.endianness);return this.position+=4,n},e.prototype.readUint16=function(i){var n=this._dataView.getUint16(this.position,i??this.endianness);return this.position+=2,n},e.prototype.readUint8=function(){var i=this._dataView.getUint8(this.position);return this.position+=1,i},e.prototype.readFloat32=function(i){var n=this._dataView.getFloat32(this.position,i??this.endianness);return this.position+=4,n},e.prototype.readFloat64=function(i){var n=this._dataView.getFloat64(this.position,i??this.endianness);return this.position+=8,n},e.prototype.writeInt32=function(i,n){this._realloc(4),this._dataView.setInt32(this.position,i,n??this.endianness),this.position+=4},e.prototype.writeInt16=function(i,n){this._realloc(2),this._dataView.setInt16(this.position,i,n??this.endianness),this.position+=2},e.prototype.writeInt8=function(i){this._realloc(1),this._dataView.setInt8(this.position,i),this.position+=1},e.prototype.writeUint32=function(i,n){this._realloc(4),this._dataView.setUint32(this.position,i,n??this.endianness),this.position+=4},e.prototype.writeUint16=function(i,n){this._realloc(2),this._dataView.setUint16(this.position,i,n??this.endianness),this.position+=2},e.prototype.writeUint8=function(i){this._realloc(1),this._dataView.setUint8(this.position,i),this.position+=1},e.prototype.writeFloat32=function(i,n){this._realloc(4),this._dataView.setFloat32(this.position,i,n??this.endianness),this.position+=4},e.prototype.writeFloat64=function(i,n){this._realloc(8),this._dataView.setFloat64(this.position,i,n??this.endianness),this.position+=8},e.endianness=new Int8Array(new Int16Array([1]).buffer)[0]>0,e.memcpy=function(i,n,s,a,o){var l=new Uint8Array(i,n,o),c=new Uint8Array(s,a,o);l.set(c)},e.arrayToNative=function(i,n){return n==this.endianness?i:this.flipArrayEndianness(i)},e.nativeToEndian=function(i,n){return this.endianness==n?i:this.flipArrayEndianness(i)},e.flipArrayEndianness=function(i){for(var n=new Uint8Array(i.buffer,i.byteOffset,i.byteLength),s=0;s<i.byteLength;s+=i.BYTES_PER_ELEMENT)for(var a=s+i.BYTES_PER_ELEMENT-1,o=s;a>o;a--,o++){var l=n[o];n[o]=n[a],n[a]=l}return i},e.createStringFromArray=function(i){for(var n="",s=0;s<i.length;s++)n+=String.fromCharCode(i[s]);return n},e.prototype.failurePosition=0,e.prototype.readStruct=function(i){for(var n={},s,a,o=this.position,l=0;l<i.length;l+=2){if(s=i[l+1],a=this.readType(s,n),a==null)return this.failurePosition==0&&(this.failurePosition=this.position),this.position=o,null;n[i[l]]=a}return n},e.prototype.readUCS2String=function(i,n){return e.createStringFromArray(this.readUint16Array(i,n))},e.prototype.readStringAt=function(i,n){return this.seek(i),this.readUCS2String(n)},e.prototype.writeUCS2String=function(i,n,s){s==null&&(s=i.length);for(var a=0;a<i.length&&a<s;a++)this.writeUint16(i.charCodeAt(a),n);for(;a<s;a++)this.writeUint16(0)},e.prototype.readString=function(i,n){return n==null||n=="ASCII"?e.createStringFromArray(this.mapUint8Array(i??this.byteLength-this.position)):new TextDecoder(n).decode(this.mapUint8Array(i))},e.prototype.writeString=function(i,n,s){if(n==null||n=="ASCII")if(s!=null){var a=0,o=Math.min(i.length,s);for(a=0;a<o;a++)this.writeUint8(i.charCodeAt(a));for(;a<s;a++)this.writeUint8(0)}else for(var a=0;a<i.length;a++)this.writeUint8(i.charCodeAt(a));else this.writeUint8Array(new TextEncoder(n).encode(i.substring(0,s)))},e.prototype.readCString=function(i){var n=this.byteLength-this.position,s=new Uint8Array(this._buffer,this._byteOffset+this.position),a=n;i!=null&&(a=Math.min(i,n));for(var o=0;o<a&&s[o]!=0;o++);var l=e.createStringFromArray(this.mapUint8Array(o));return i!=null?this.position+=a-o:o!=n&&(this.position+=1),l},e.prototype.writeCString=function(i,n){if(n!=null){var s=0,a=Math.min(i.length,n);for(s=0;s<a;s++)this.writeUint8(i.charCodeAt(s));for(;s<n;s++)this.writeUint8(0)}else{for(var s=0;s<i.length;s++)this.writeUint8(i.charCodeAt(s));this.writeUint8(0)}},e.prototype.readType=function(i,n){if(typeof i=="function")return i(this,n);if(typeof i=="object"&&!(i instanceof Array))return i.get(this,n);if(i instanceof Array&&i.length!=3)return this.readStruct(i,n);var s=null,a=null,o="ASCII",l=this.position,c;if(typeof i=="string"&&/:/.test(i)){var h=i.split(":");i=h[0],c=h[1],n[c]!=null?a=parseInt(n[c]):a=parseInt(h[1])}if(typeof i=="string"&&/,/.test(i)){var h=i.split(",");i=h[0],o=parseInt(h[1])}switch(i){case"uint8":s=this.readUint8();break;case"int8":s=this.readInt8();break;case"uint16":s=this.readUint16(this.endianness);break;case"int16":s=this.readInt16(this.endianness);break;case"uint32":s=this.readUint32(this.endianness);break;case"int32":s=this.readInt32(this.endianness);break;case"float32":s=this.readFloat32(this.endianness);break;case"float64":s=this.readFloat64(this.endianness);break;case"uint16be":s=this.readUint16(e.BIG_ENDIAN);break;case"int16be":s=this.readInt16(e.BIG_ENDIAN);break;case"uint32be":s=this.readUint32(e.BIG_ENDIAN);break;case"int32be":s=this.readInt32(e.BIG_ENDIAN);break;case"float32be":s=this.readFloat32(e.BIG_ENDIAN);break;case"float64be":s=this.readFloat64(e.BIG_ENDIAN);break;case"uint16le":s=this.readUint16(e.LITTLE_ENDIAN);break;case"int16le":s=this.readInt16(e.LITTLE_ENDIAN);break;case"uint32le":s=this.readUint32(e.LITTLE_ENDIAN);break;case"int32le":s=this.readInt32(e.LITTLE_ENDIAN);break;case"float32le":s=this.readFloat32(e.LITTLE_ENDIAN);break;case"float64le":s=this.readFloat64(e.LITTLE_ENDIAN);break;case"cstring":s=this.readCString(a);break;case"string":s=this.readString(a,o);break;case"u16string":s=this.readUCS2String(a,this.endianness);break;case"u16stringle":s=this.readUCS2String(a,e.LITTLE_ENDIAN);break;case"u16stringbe":s=this.readUCS2String(a,e.BIG_ENDIAN);break;default:if(i.length==3){var d=i[1],c=i[2],u=0;if(typeof c=="function"?u=c(n,this,i):typeof c=="string"&&n[c]!=null?u=parseInt(n[c]):u=parseInt(c),typeof d=="string"){var p=d.replace(/(le|be)$/,""),f=null;switch(/le$/.test(d)?f=e.LITTLE_ENDIAN:/be$/.test(d)&&(f=e.BIG_ENDIAN),c=="*"&&(u=null),p){case"uint8":s=this.readUint8Array(u);break;case"uint16":s=this.readUint16Array(u,f);break;case"uint32":s=this.readUint32Array(u,f);break;case"int8":s=this.readInt8Array(u);break;case"int16":s=this.readInt16Array(u,f);break;case"int32":s=this.readInt32Array(u,f);break;case"float32":s=this.readFloat32Array(u,f);break;case"float64":s=this.readFloat64Array(u,f);break;case"cstring":case"utf16string":case"string":if(u==null)for(s=[];!this.isEof();){var m=this.readType(d,n);if(m==null)break;s.push(m)}else{s=new Array(u);for(var b=0;b<u;b++)s[b]=this.readType(d,n)}break}}else if(c=="*")for(s=[],this.buffer;;){var g=this.position;try{var y=this.readType(d,n);if(y==null){this.position=g;break}s.push(y)}catch{this.position=g;break}}else{s=new Array(u);for(var b=0;b<u;b++){var m=this.readType(d,n);if(m==null)return null;s[b]=m}}break}}return a!=null&&(this.position=l+a),s},e.prototype.writeStruct=function(i,n){for(var s=0;s<i.length;s+=2){var a=i[s+1];this.writeType(a,n[i[s]],n)}},e.prototype.writeType=function(i,n,s){if(typeof i=="function")return i(this,n);if(typeof i=="object"&&!(i instanceof Array))return i.set(this,n,s);var a=null,o="ASCII",l=this.position;if(typeof i=="string"&&/:/.test(i)){var c=i.split(":");i=c[0],a=parseInt(c[1])}if(typeof i=="string"&&/,/.test(i)){var c=i.split(",");i=c[0],o=parseInt(c[1])}switch(i){case"uint8":this.writeUint8(n);break;case"int8":this.writeInt8(n);break;case"uint16":this.writeUint16(n,this.endianness);break;case"int16":this.writeInt16(n,this.endianness);break;case"uint32":this.writeUint32(n,this.endianness);break;case"int32":this.writeInt32(n,this.endianness);break;case"float32":this.writeFloat32(n,this.endianness);break;case"float64":this.writeFloat64(n,this.endianness);break;case"uint16be":this.writeUint16(n,e.BIG_ENDIAN);break;case"int16be":this.writeInt16(n,e.BIG_ENDIAN);break;case"uint32be":this.writeUint32(n,e.BIG_ENDIAN);break;case"int32be":this.writeInt32(n,e.BIG_ENDIAN);break;case"float32be":this.writeFloat32(n,e.BIG_ENDIAN);break;case"float64be":this.writeFloat64(n,e.BIG_ENDIAN);break;case"uint16le":this.writeUint16(n,e.LITTLE_ENDIAN);break;case"int16le":this.writeInt16(n,e.LITTLE_ENDIAN);break;case"uint32le":this.writeUint32(n,e.LITTLE_ENDIAN);break;case"int32le":this.writeInt32(n,e.LITTLE_ENDIAN);break;case"float32le":this.writeFloat32(n,e.LITTLE_ENDIAN);break;case"float64le":this.writeFloat64(n,e.LITTLE_ENDIAN);break;case"cstring":this.writeCString(n,a);break;case"string":this.writeString(n,o,a);break;case"u16string":this.writeUCS2String(n,this.endianness,a);break;case"u16stringle":this.writeUCS2String(n,e.LITTLE_ENDIAN,a);break;case"u16stringbe":this.writeUCS2String(n,e.BIG_ENDIAN,a);break;default:if(i.length==3){for(var h=i[1],d=0;d<n.length;d++)this.writeType(h,n[d]);break}else{this.writeStruct(i,n);break}}a!=null&&(this.position=l,this._realloc(a),this.position=l+a)},e})})(xi)),xi.exports}var Si={exports:{}},bc=Si.exports,Qs;function vc(){return Qs||(Qs=1,(function(r,t){(function(e,i){r.exports=i(Ca())})(bc,function(e){var i={FILE_HEADER:s([208,207,17,224,161,177,26,225]),MSG:{UNUSED_BLOCK:-1,END_OF_CHAIN:-2,S_BIG_BLOCK_SIZE:512,L_BIG_BLOCK_SIZE:4096,L_BIG_BLOCK_MARK:12,SMALL_BLOCK_SIZE:64,BIG_BLOCK_MIN_DOC_SIZE:4096,HEADER:{PROPERTY_START_OFFSET:48,BAT_START_OFFSET:76,BAT_COUNT_OFFSET:44,SBAT_START_OFFSET:60,SBAT_COUNT_OFFSET:64,XBAT_START_OFFSET:68,XBAT_COUNT_OFFSET:72},PROP:{NO_INDEX:-1,PROPERTY_SIZE:128,NAME_SIZE_OFFSET:64,TYPE_OFFSET:66,PREVIOUS_PROPERTY_OFFSET:68,NEXT_PROPERTY_OFFSET:72,CHILD_PROPERTY_OFFSET:76,START_BLOCK_OFFSET:116,SIZE_OFFSET:120,TYPE_ENUM:{DIRECTORY:1,DOCUMENT:2,ROOT:5}},FIELD:{PREFIX:{ATTACHMENT:"__attach_version1.0",RECIPIENT:"__recip_version1.0",DOCUMENT:"__substg1."},NAME_MAPPING:{"0037":"subject","0c1a":"senderName","5d02":"senderEmail",1e3:"body","007d":"headers",3703:"extension",3704:"fileNameShort",3707:"fileName",3712:"pidContentId",3001:"name","39fe":"email"},CLASS_MAPPING:{ATTACHMENT_DATA:"3701"},TYPE_MAPPING:{"001e":"string","001f":"unicode","0102":"binary"},DIR_TYPE:{INNER_MSG:"000d"}}}};function n(_,A){if(_===A)return!0;if(_==null||A==null||_.length!=A.length)return!1;for(var C=0;C<_.length;C++)if(_[C]!==A[C])return!1;return!0}function s(_){for(var A=new Array(_.length),C=0;C<_.length;C++)A[C]=_[C]<<24>>24;return A}function a(_){return _.seek(0),n(i.FILE_HEADER,_.readInt8Array(i.FILE_HEADER.length))}function o(_,A){return(A+1)*_.bigBlockSize}function l(_,A,C){var O=o(A,C);return _.seek(O),_.readInt32Array(A.bigBlockLength)}function c(_,A,C,O){var S=Math.floor(C/A.bigBlockLength),T=C%A.bigBlockLength,L=O[S];return l(_,A,L)[T]}function h(_,A,C){return c(_,A,C,A.batData)}function d(_,A,C){return c(_,A,C,A.sbatData)}function u(_){var A=p(_);return A.batData=m(_,A),A.sbatData=b(_,A),A.xbatCount>0&&g(_,A),A.propertyData=y(_,A),A.fieldsData=I(_,A),A}function p(_){var A={};return A.bigBlockSize=_.readByte(30)==i.MSG.L_BIG_BLOCK_MARK?i.MSG.L_BIG_BLOCK_SIZE:i.MSG.S_BIG_BLOCK_SIZE,A.bigBlockLength=A.bigBlockSize/4,A.xBlockLength=A.bigBlockLength-1,A.batCount=_.readInt(i.MSG.HEADER.BAT_COUNT_OFFSET),A.propertyStart=_.readInt(i.MSG.HEADER.PROPERTY_START_OFFSET),A.sbatStart=_.readInt(i.MSG.HEADER.SBAT_START_OFFSET),A.sbatCount=_.readInt(i.MSG.HEADER.SBAT_COUNT_OFFSET),A.xbatStart=_.readInt(i.MSG.HEADER.XBAT_START_OFFSET),A.xbatCount=_.readInt(i.MSG.HEADER.XBAT_COUNT_OFFSET),A}function f(_){var A=(i.MSG.S_BIG_BLOCK_SIZE-i.MSG.HEADER.BAT_START_OFFSET)/4;return Math.min(_.batCount,A)}function m(_,A){var C=new Array(f(A));_.seek(i.MSG.HEADER.BAT_START_OFFSET);for(var O=0;O<C.length;O++)C[O]=_.readInt32();return C}function b(_,A){for(var C=[],O=A.sbatStart,S=0;S<A.sbatCount&&O!=i.MSG.END_OF_CHAIN;S++)C.push(O),O=h(_,A,O);return C}function g(_,A){for(var C=f(A),O=A.batCount,S=O-C,T=A.xbatStart,L=0;L<A.xbatCount;L++){var U=l(_,A,T);T=U[A.xBlockLength];for(var E=Math.min(S,A.xBlockLength),N=0;N<E;N++){var k=U[N];if(k==i.MSG.UNUSED_BLOCK||k==i.MSG.END_OF_CHAIN)break;A.batData.push(k)}S-=E}}function y(_,A){for(var C=[],O=A.propertyStart;O!=i.MSG.END_OF_CHAIN;)v(_,A,O,C),O=h(_,A,O);return R(C,C[0]),C}function x(_,A){var C=_.readShort(A+i.MSG.PROP.NAME_SIZE_OFFSET);return C<1?"":_.readStringAt(A,C/2)}function w(_,A,C){return{index:A,type:_.readByte(C+i.MSG.PROP.TYPE_OFFSET),name:x(_,C),previousProperty:_.readInt(C+i.MSG.PROP.PREVIOUS_PROPERTY_OFFSET),nextProperty:_.readInt(C+i.MSG.PROP.NEXT_PROPERTY_OFFSET),childProperty:_.readInt(C+i.MSG.PROP.CHILD_PROPERTY_OFFSET),startBlock:_.readInt(C+i.MSG.PROP.START_BLOCK_OFFSET),sizeBlock:_.readInt(C+i.MSG.PROP.SIZE_OFFSET)}}function v(_,A,C,O){for(var S=A.bigBlockSize/i.MSG.PROP.PROPERTY_SIZE,T=o(A,C),L=0;L<S;L++){var U=_.readByte(T+i.MSG.PROP.TYPE_OFFSET);switch(U){case i.MSG.PROP.TYPE_ENUM.ROOT:case i.MSG.PROP.TYPE_ENUM.DIRECTORY:case i.MSG.PROP.TYPE_ENUM.DOCUMENT:O.push(w(_,O.length,T));break;default:O.push(null)}T+=i.MSG.PROP.PROPERTY_SIZE}}function R(_,A){if(A.childProperty!=i.MSG.PROP.NO_INDEX){A.children=[];for(var C=[A.childProperty];C.length!=0;){var O=C.shift(),S=_[O];S!=null&&(A.children.push(O),S.type==i.MSG.PROP.TYPE_ENUM.DIRECTORY&&R(_,S),S.previousProperty!=i.MSG.PROP.NO_INDEX&&C.push(S.previousProperty),S.nextProperty!=i.MSG.PROP.NO_INDEX&&C.push(S.nextProperty))}}}function I(_,A){var C={attachments:[],recipients:[]};return j(_,A,A.propertyData[0],C),C}function j(_,A,C,O){if(C.children&&C.children.length>0)for(var S=0;S<C.children.length;S++){var T=A.propertyData[C.children[S]];T.type==i.MSG.PROP.TYPE_ENUM.DIRECTORY?H(_,A,T,O):T.type==i.MSG.PROP.TYPE_ENUM.DOCUMENT&&T.name.indexOf(i.MSG.FIELD.PREFIX.DOCUMENT)==0&&z(_,A,T,O)}}function H(_,A,C,O){if(C.name.indexOf(i.MSG.FIELD.PREFIX.ATTACHMENT)==0){var S={};O.attachments.push(S),j(_,A,C,S)}else if(C.name.indexOf(i.MSG.FIELD.PREFIX.RECIPIENT)==0){var T={};O.recipients.push(T),j(_,A,C,T)}else{var L=D(C);L!=i.MSG.FIELD.DIR_TYPE.INNER_MSG?j(_,A,C,O):O.innerMsgContent=!0}}function z(_,A,C,O){var S=C.name.substring(12).toLowerCase(),T=S.substring(0,4),L=S.substring(4,8),U=i.MSG.FIELD.NAME_MAPPING[T];U&&(O[U]=J(_,A,C,L)),T==i.MSG.FIELD.CLASS_MAPPING.ATTACHMENT_DATA&&(O.dataId=C.index,O.contentLength=C.sizeBlock)}function D(_){var A=_.name.substring(12).toLowerCase();return A.substring(4,8)}var $={sbat:{extractor:function(A,C,O,S){var T=G(A,C,O);return T.length==1?W(A,C,O.startBlock,O.sizeBlock,S):T.length>1?Y(A,C,O,T,S):null},dataType:{string:function(A,C,O,S,T){return A.seek(O+S),A.readString(T)},unicode:function(A,C,O,S,T){return A.seek(O+S),A.readUCS2String(T/2)},binary:function(A,C,O,S,T){A.seek(O+S);var L=Math.min(Math.min(C.bigBlockSize-S,T),i.MSG.SMALL_BLOCK_SIZE);return A.readUint8Array(L)}}},bat:{extractor:function(A,C,O,S){var T=o(C,O.startBlock);return A.seek(T),S(A,O)},dataType:{string:function(A,C){return A.readString(C.sizeBlock)},unicode:function(A,C){return A.readUCS2String(C.sizeBlock/2)},binary:function(A,C){return A.readUint8Array(C.sizeBlock)}}}};function W(_,A,C,O,S){for(var T=C*i.MSG.SMALL_BLOCK_SIZE,L=Math.floor(T/A.bigBlockSize),U=T%A.bigBlockSize,E=A.propertyData[0],N=E.startBlock,k=0;k<L;k++)N=h(_,A,N);var rt=o(A,N);return S(_,A,rt,U,O)}function Y(_,A,C,O,S){for(var T=new Int8Array(C.sizeBlock),L=0,U=0;L<O.length;L++)for(var E=W(_,A,O[L],i.MSG.SMALL_BLOCK_SIZE,$.sbat.dataType.binary),N=0;N<E.length;N++)T[U++]=E[N];var k=new e(T,0,e.LITTLE_ENDIAN);return S(k,A,0,0,C.sizeBlock)}function G(_,A,C){for(var O=[],S=C.startBlock;S!=i.MSG.END_OF_CHAIN;)O.push(S),S=d(_,A,S);return O}function J(_,A,C,O){var S=null,T=C.sizeBlock<i.MSG.BIG_BLOCK_MIN_DOC_SIZE?$.sbat:$.bat,L=T.dataType[i.MSG.FIELD.TYPE_MAPPING[O]];return L&&(S=T.extractor(_,A,C,L)),S}var F=function(_){this.ds=new e(_,0,e.LITTLE_ENDIAN)};return F.prototype={getFileData:function(){return a(this.ds)?(this.fileData==null&&(this.fileData=u(this.ds)),this.fileData.fieldsData):{error:"Unsupported file type!"}},getAttachment:function(_){var A=typeof _=="number"?this.fileData.fieldsData.attachments[_]:_,C=this.fileData.propertyData[A.dataId],O=J(this.ds,this.fileData,C,D(C));return{fileName:A.fileName,content:O}}},F})})(Si)),Si.exports}var Js;function yc(){return Js||(Js=1,Object.defineProperty(Ke,"__esModule",{value:!0}),Ke.DataStream=Ca(),Ke.MSGReader=vc()),Ke}var _c=yc(),zi=function(r,t){return Object.defineProperty?Object.defineProperty(r,"raw",{value:t}):r.raw=t,r},Gi=function(r){var t=r.mainState.currentDocument,e=M.useState(),i=e[0],n=e[1];if(M.useEffect(function(){if(!(!t||!t.fileData)){var h=new _c.MSGReader(t.fileData).getFileData();n(h)}},[t?.fileData]),M.useEffect(function(){if(!(!i||i.hasOwnProperty("error"))){var h=document.getElementById("msg-body"),d=h?.contentWindow&&h.contentWindow;if(d){var u=d.document,p=i.body.replace(/(\r\n|\n|\r)/gm,"<br />");u.open(),u.write("".concat(p)),u.close()}}},[i]),!i||i.hasOwnProperty("error"))return P.createElement("span",null,i?.error);var s=i,a=s.recipients,o=s.subject,l=s.senderEmail,c=s.senderName;return P.createElement(Ec,{id:"msg-renderer"},P.createElement("h2",{id:"msg-subject-title",style:{marginBottom:0}},o),P.createElement(Ac,{name:c,email:l}),P.createElement(xc,{id:"msg-recipient"},P.createElement("h3",{id:"msg-recipient-title"},"Recipients"),P.createElement("ul",{id:"msg-recipient-ul"},a.map(function(h,d){return P.createElement("li",{key:d,id:"msg-recipient-li"},P.createElement("span",{id:"msg-recipient-name"},h.name),h.hasOwnProperty("email")&&P.createElement("span",{id:"msg-recipient-email"}," - ",h.email))}))),P.createElement(Sc,{id:"msg-body",sandbox:"allow-same-origin"}))},Ac=function(r){var t=r.name,e=r.email;return!t&&!e?null:P.createElement(wc,{id:"msg-sender"},P.createElement("h3",{id:"msg-sender-title"},"Sender"),t!==void 0&&P.createElement("div",{id:"msg-sender-name"},t),e!==void 0&&P.createElement("div",{id:"msg-sender-email"},e))};Gi.fileTypes=["msg","application/vnd.ms-outlook"];Gi.weight=0;Gi.fileLoader=Ea;var Ec=lt.div(tr||(tr=zi([`
  display: flex;
  flex-direction: column;
  width: 100%;
  padding: 0 30px;
`],[`
  display: flex;
  flex-direction: column;
  width: 100%;
  padding: 0 30px;
`]))),wc=lt.div(er||(er=zi([`
  padding: 0 15px 15px 15px;
  margin-top: 20px;
  border: 1px solid `,`;
`],[`
  padding: 0 15px 15px 15px;
  margin-top: 20px;
  border: 1px solid `,`;
`])),function(r){return r.theme.secondary}),xc=lt.div(ir||(ir=zi([`
  padding: 0 15px;
  margin-top: 20px;
  border: 1px solid `,`;
`],[`
  padding: 0 15px;
  margin-top: 20px;
  border: 1px solid `,`;
`])),function(r){return r.theme.secondary}),Sc=lt.iframe(nr||(nr=zi([`
  height: 100%;
  padding: 15px;
  margin: 20px 0 20px 0;
  border: 1px solid `,`;
`],[`
  height: 100%;
  padding: 15px;
  margin: 20px 0 20px 0;
  border: 1px solid `,`;
`])),function(r){return r.theme.secondary}),tr,er,ir,nr,si={};si.d=(r,t)=>{for(var e in t)si.o(t,e)&&!si.o(r,e)&&Object.defineProperty(r,e,{enumerable:!0,get:t[e]})};si.o=(r,t)=>Object.prototype.hasOwnProperty.call(r,t);var it=globalThis.pdfjsLib={};si.d(it,{AbortException:()=>Ce,AnnotationEditorLayer:()=>se,AnnotationEditorParamsType:()=>st,AnnotationEditorType:()=>dt,AnnotationEditorUIManager:()=>pe,AnnotationLayer:()=>wd,AnnotationMode:()=>de,CMapCompressionType:()=>kn,ColorPicker:()=>Zt,DOMSVGFactory:()=>Jn,DrawLayer:()=>kt,FeatureTest:()=>Bt,GlobalWorkerOptions:()=>ri,ImageKind:()=>Ti,InvalidPDFException:()=>Ra,MissingPDFException:()=>Te,OPS:()=>Yt,Outliner:()=>jn,PDFDataRangeTransport:()=>Wa,PDFDateString:()=>Da,PDFWorker:()=>Wt,PasswordResponses:()=>Rc,PermissionFlag:()=>Pc,PixelsPerInch:()=>ze,RenderingCancelledException:()=>ts,TextLayer:()=>Oi,UnexpectedResponseException:()=>qi,Util:()=>q,VerbosityLevel:()=>Vi,XfaLayer:()=>qa,build:()=>nd,createValidAbsoluteUrl:()=>Mc,fetchData:()=>tn,getDocument:()=>qh,getFilenameFromUrl:()=>zc,getPdfFilenameFromUrl:()=>Gc,getXfaPageViewport:()=>Vc,isDataScheme:()=>es,isPdfFile:()=>is,noContextMenu:()=>jt,normalizeUnicode:()=>jc,renderTextLayer:()=>jh,setLayerDimensions:()=>we,shadow:()=>ut,updateTextLayer:()=>Hh,version:()=>id});const Mt=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Pa=[1,0,0,1,0,0],Ln=[.001,0,0,.001,0,0],Tc=1e7,gn=1.35,Vt={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256},de={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},Cc="pdfjs_internal_editor_",dt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},st={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35},Pc={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Rt={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Ti={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},wt={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,WIDGET:20},Ze={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Vi={ERRORS:0,WARNINGS:1,INFOS:5},kn={NONE:0,BINARY:1},Yt={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},Rc={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Wi=Vi.WARNINGS;function Lc(r){Number.isInteger(r)&&(Wi=r)}function kc(){return Wi}function Yi(r){Wi>=Vi.INFOS&&console.log(`Info: ${r}`)}function ct(r){Wi>=Vi.WARNINGS&&console.log(`Warning: ${r}`)}function gt(r){throw new Error(r)}function St(r,t){r||gt(t)}function Ic(r){switch(r?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Mc(r,t=null,e=null){if(!r)return null;try{if(e&&typeof r=="string"&&(e.addDefaultProtocol&&r.startsWith("www.")&&r.match(/\./g)?.length>=2&&(r=`http://${r}`),e.tryConvertEncoding))try{r=Bc(r)}catch{}const i=t?new URL(r,t):new URL(r);if(Ic(i))return i}catch{}return null}function ut(r,t,e,i=!1){return Object.defineProperty(r,t,{value:e,enumerable:!i,configurable:!0,writable:!1}),e}const ge=(function(){function t(e,i){this.constructor===t&&gt("Cannot initialize BaseException."),this.message=e,this.name=i}return t.prototype=new Error,t.constructor=t,t})();class In extends ge{constructor(t,e){super(t,"PasswordException"),this.code=e}}class Mn extends ge{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class Ra extends ge{constructor(t){super(t,"InvalidPDFException")}}class Te extends ge{constructor(t){super(t,"MissingPDFException")}}class qi extends ge{constructor(t,e){super(t,"UnexpectedResponseException"),this.status=e}}class Oc extends ge{constructor(t){super(t,"FormatError")}}class Ce extends ge{constructor(t){super(t,"AbortException")}}function La(r){(typeof r!="object"||r?.length===void 0)&&gt("Invalid argument for bytesToString");const t=r.length,e=8192;if(t<e)return String.fromCharCode.apply(null,r);const i=[];for(let n=0;n<t;n+=e){const s=Math.min(n+e,t),a=r.subarray(n,s);i.push(String.fromCharCode.apply(null,a))}return i.join("")}function Xi(r){typeof r!="string"&&gt("Invalid argument for stringToBytes");const t=r.length,e=new Uint8Array(t);for(let i=0;i<t;++i)e[i]=r.charCodeAt(i)&255;return e}function Dc(r){return String.fromCharCode(r>>24&255,r>>16&255,r>>8&255,r&255)}function Zn(r){const t=Object.create(null);for(const[e,i]of r)t[e]=i;return t}function Fc(){const r=new Uint8Array(4);return r[0]=1,new Uint32Array(r.buffer,0,1)[0]===1}function Nc(){try{return new Function(""),!0}catch{return!1}}class Bt{static get isLittleEndian(){return ut(this,"isLittleEndian",Fc())}static get isEvalSupported(){return ut(this,"isEvalSupported",Nc())}static get isOffscreenCanvasSupported(){return ut(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator<"u"&&typeof navigator?.platform=="string"?ut(this,"platform",{isMac:navigator.platform.includes("Mac")}):ut(this,"platform",{isMac:!1})}static get isCSSRoundSupported(){return ut(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const mn=Array.from(Array(256).keys(),r=>r.toString(16).padStart(2,"0"));class q{static makeHexColor(t,e,i){return`#${mn[t]}${mn[e]}${mn[i]}`}static scaleMinMax(t,e){let i;t[0]?(t[0]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[3],e[3]*=t[3]):(i=e[0],e[0]=e[1],e[1]=i,i=e[2],e[2]=e[3],e[3]=i,t[1]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static applyTransform(t,e){const i=t[0]*e[0]+t[1]*e[2]+e[4],n=t[0]*e[1]+t[1]*e[3]+e[5];return[i,n]}static applyInverseTransform(t,e){const i=e[0]*e[3]-e[1]*e[2],n=(t[0]*e[3]-t[1]*e[2]+e[2]*e[5]-e[4]*e[3])/i,s=(-t[0]*e[1]+t[1]*e[0]+e[4]*e[1]-e[5]*e[0])/i;return[n,s]}static getAxialAlignedBoundingBox(t,e){const i=this.applyTransform(t,e),n=this.applyTransform(t.slice(2,4),e),s=this.applyTransform([t[0],t[3]],e),a=this.applyTransform([t[2],t[1]],e);return[Math.min(i[0],n[0],s[0],a[0]),Math.min(i[1],n[1],s[1],a[1]),Math.max(i[0],n[0],s[0],a[0]),Math.max(i[1],n[1],s[1],a[1])]}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t){const e=[t[0],t[2],t[1],t[3]],i=t[0]*e[0]+t[1]*e[2],n=t[0]*e[1]+t[1]*e[3],s=t[2]*e[0]+t[3]*e[2],a=t[2]*e[1]+t[3]*e[3],o=(i+a)/2,l=Math.sqrt((i+a)**2-4*(i*a-s*n))/2,c=o+l||1,h=o-l||1;return[Math.sqrt(c),Math.sqrt(h)]}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const i=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),n=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(i>n)return null;const s=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),a=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return s>a?null:[i,s,n,a]}static#t(t,e,i,n,s,a,o,l,c,h){if(c<=0||c>=1)return;const d=1-c,u=c*c,p=u*c,f=d*(d*(d*t+3*c*e)+3*u*i)+p*n,m=d*(d*(d*s+3*c*a)+3*u*o)+p*l;h[0]=Math.min(h[0],f),h[1]=Math.min(h[1],m),h[2]=Math.max(h[2],f),h[3]=Math.max(h[3],m)}static#e(t,e,i,n,s,a,o,l,c,h,d,u){if(Math.abs(c)<1e-12){Math.abs(h)>=1e-12&&this.#t(t,e,i,n,s,a,o,l,-d/h,u);return}const p=h**2-4*d*c;if(p<0)return;const f=Math.sqrt(p),m=2*c;this.#t(t,e,i,n,s,a,o,l,(-h+f)/m,u),this.#t(t,e,i,n,s,a,o,l,(-h-f)/m,u)}static bezierBoundingBox(t,e,i,n,s,a,o,l,c){return c?(c[0]=Math.min(c[0],t,o),c[1]=Math.min(c[1],e,l),c[2]=Math.max(c[2],t,o),c[3]=Math.max(c[3],e,l)):c=[Math.min(t,o),Math.min(e,l),Math.max(t,o),Math.max(e,l)],this.#e(t,i,s,o,e,n,a,l,3*(-t+3*(i-s)+o),6*(t-2*i+s),3*(i-t),c),this.#e(t,i,s,o,e,n,a,l,3*(-e+3*(n-a)+l),6*(e-2*n+a),3*(n-e),c),c}}function Bc(r){return decodeURIComponent(escape(r))}let bn=null,sr=null;function jc(r){return bn||(bn=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,sr=new Map([["","t"]])),r.replaceAll(bn,(t,e,i)=>e?e.normalize("NFKC"):sr.get(i))}function Hc(){if(typeof crypto<"u"&&typeof crypto?.randomUUID=="function")return crypto.randomUUID();const r=new Uint8Array(32);if(typeof crypto<"u"&&typeof crypto?.getRandomValues=="function")crypto.getRandomValues(r);else for(let t=0;t<32;t++)r[t]=Math.floor(Math.random()*255);return La(r)}const ka="pdfjs_internal_id_",ee={BEZIER_CURVE_TO:0,MOVE_TO:1,LINE_TO:2,QUADRATIC_CURVE_TO:3,RESTORE:4,SAVE:5,SCALE:6,TRANSFORM:7,TRANSLATE:8};class Ki{constructor(){this.constructor===Ki&&gt("Cannot initialize BaseFilterFactory.")}addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,i,n,s){return"none"}destroy(t=!1){}}class Zi{constructor(){this.constructor===Zi&&gt("Cannot initialize BaseCanvasFactory.")}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(t,e);return{canvas:i,context:i.getContext("2d")}}reset(t,e,i){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||i<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=i}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){gt("Abstract method `_createCanvas` called.")}}class Qi{constructor({baseUrl:t=null,isCompressed:e=!0}){this.constructor===Qi&&gt("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":""),i=this.isCompressed?kn.BINARY:kn.NONE;return this._fetchData(e,i).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}_fetchData(t,e){gt("Abstract method `_fetchData` called.")}}class Ji{constructor({baseUrl:t=null}){this.constructor===Ji&&gt("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetchData(e).catch(i=>{throw new Error(`Unable to load font data at: ${e}`)})}_fetchData(t){gt("Abstract method `_fetchData` called.")}}class Qn{constructor(){this.constructor===Qn&&gt("Cannot initialize BaseSVGFactory.")}create(t,e,i=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const n=this._createSVG("svg:svg");return n.setAttribute("version","1.1"),i||(n.setAttribute("width",`${t}px`),n.setAttribute("height",`${e}px`)),n.setAttribute("preserveAspectRatio","none"),n.setAttribute("viewBox",`0 0 ${t} ${e}`),n}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){gt("Abstract method `_createSVG` called.")}}const ne="http://www.w3.org/2000/svg";class ze{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}class Uc extends Ki{#t;#e;#i;#s;#a;#n=0;constructor({docId:t,ownerDocument:e=globalThis.document}={}){super(),this.#i=t,this.#s=e}get#r(){return this.#t||=new Map}get#c(){return this.#a||=new Map}get#l(){if(!this.#e){const t=this.#s.createElement("div"),{style:e}=t;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const i=this.#s.createElementNS(ne,"svg");i.setAttribute("width",0),i.setAttribute("height",0),this.#e=this.#s.createElementNS(ne,"defs"),t.append(i),i.append(this.#e),this.#s.body.append(t)}return this.#e}#d(t){if(t.length===1){const l=t[0],c=new Array(256);for(let d=0;d<256;d++)c[d]=l[d]/255;const h=c.join(",");return[h,h,h]}const[e,i,n]=t,s=new Array(256),a=new Array(256),o=new Array(256);for(let l=0;l<256;l++)s[l]=e[l]/255,a[l]=i[l]/255,o[l]=n[l]/255;return[s.join(","),a.join(","),o.join(",")]}addFilter(t){if(!t)return"none";let e=this.#r.get(t);if(e)return e;const[i,n,s]=this.#d(t),a=t.length===1?i:`${i}${n}${s}`;if(e=this.#r.get(a),e)return this.#r.set(t,e),e;const o=`g_${this.#i}_transfer_map_${this.#n++}`,l=`url(#${o})`;this.#r.set(t,l),this.#r.set(a,l);const c=this.#o(o);return this.#g(i,n,s,c),l}addHCMFilter(t,e){const i=`${t}-${e}`,n="base";let s=this.#c.get(n);if(s?.key===i||(s?(s.filter?.remove(),s.key=i,s.url="none",s.filter=null):(s={key:i,url:"none",filter:null},this.#c.set(n,s)),!t||!e))return s.url;const a=this.#v(t);t=q.makeHexColor(...a);const o=this.#v(e);if(e=q.makeHexColor(...o),this.#l.style.color="",t==="#000000"&&e==="#ffffff"||t===e)return s.url;const l=new Array(256);for(let p=0;p<=255;p++){const f=p/255;l[p]=f<=.03928?f/12.92:((f+.055)/1.055)**2.4}const c=l.join(","),h=`g_${this.#i}_hcm_filter`,d=s.filter=this.#o(h);this.#g(c,c,c,d),this.#h(d);const u=(p,f)=>{const m=a[p]/255,b=o[p]/255,g=new Array(f+1);for(let y=0;y<=f;y++)g[y]=m+y/f*(b-m);return g.join(",")};return this.#g(u(0,5),u(1,5),u(2,5),d),s.url=`url(#${h})`,s.url}addAlphaFilter(t){let e=this.#r.get(t);if(e)return e;const[i]=this.#d([t]),n=`alpha_${i}`;if(e=this.#r.get(n),e)return this.#r.set(t,e),e;const s=`g_${this.#i}_alpha_map_${this.#n++}`,a=`url(#${s})`;this.#r.set(t,a),this.#r.set(n,a);const o=this.#o(s);return this.#u(i,o),a}addLuminosityFilter(t){let e=this.#r.get(t||"luminosity");if(e)return e;let i,n;if(t?([i]=this.#d([t]),n=`luminosity_${i}`):n="luminosity",e=this.#r.get(n),e)return this.#r.set(t,e),e;const s=`g_${this.#i}_luminosity_map_${this.#n++}`,a=`url(#${s})`;this.#r.set(t,a),this.#r.set(n,a);const o=this.#o(s);return this.#f(o),t&&this.#u(i,o),a}addHighlightHCMFilter(t,e,i,n,s){const a=`${e}-${i}-${n}-${s}`;let o=this.#c.get(t);if(o?.key===a||(o?(o.filter?.remove(),o.key=a,o.url="none",o.filter=null):(o={key:a,url:"none",filter:null},this.#c.set(t,o)),!e||!i))return o.url;const[l,c]=[e,i].map(this.#v.bind(this));let h=Math.round(.2126*l[0]+.7152*l[1]+.0722*l[2]),d=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),[u,p]=[n,s].map(this.#v.bind(this));d<h&&([h,d,u,p]=[d,h,p,u]),this.#l.style.color="";const f=(g,y,x)=>{const w=new Array(256),v=(d-h)/x,R=g/255,I=(y-g)/(255*x);let j=0;for(let H=0;H<=x;H++){const z=Math.round(h+H*v),D=R+H*I;for(let $=j;$<=z;$++)w[$]=D;j=z+1}for(let H=j;H<256;H++)w[H]=w[j-1];return w.join(",")},m=`g_${this.#i}_hcm_${t}_filter`,b=o.filter=this.#o(m);return this.#h(b),this.#g(f(u[0],p[0],5),f(u[1],p[1],5),f(u[2],p[2],5),b),o.url=`url(#${m})`,o.url}destroy(t=!1){t&&this.#c.size!==0||(this.#e&&(this.#e.parentNode.parentNode.remove(),this.#e=null),this.#t&&(this.#t.clear(),this.#t=null),this.#n=0)}#f(t){const e=this.#s.createElementNS(ne,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(e)}#h(t){const e=this.#s.createElementNS(ne,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(e)}#o(t){const e=this.#s.createElementNS(ne,"filter");return e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("id",t),this.#l.append(e),e}#p(t,e,i){const n=this.#s.createElementNS(ne,e);n.setAttribute("type","discrete"),n.setAttribute("tableValues",i),t.append(n)}#g(t,e,i,n){const s=this.#s.createElementNS(ne,"feComponentTransfer");n.append(s),this.#p(s,"feFuncR",t),this.#p(s,"feFuncG",e),this.#p(s,"feFuncB",i)}#u(t,e){const i=this.#s.createElementNS(ne,"feComponentTransfer");e.append(i),this.#p(i,"feFuncA",t)}#v(t){return this.#l.style.color=t,ns(getComputedStyle(this.#l).getPropertyValue("color"))}}class $c extends Zi{constructor({ownerDocument:t=globalThis.document}={}){super(),this._document=t}_createCanvas(t,e){const i=this._document.createElement("canvas");return i.width=t,i.height=e,i}}async function tn(r,t="text"){if(ti(r,document.baseURI)){const e=await fetch(r);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,i)=>{const n=new XMLHttpRequest;n.open("GET",r,!0),n.responseType=t,n.onreadystatechange=()=>{if(n.readyState===XMLHttpRequest.DONE){if(n.status===200||n.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(n.response);return}e(n.responseText);return}i(new Error(n.statusText))}},n.send(null)})}class Ia extends Qi{_fetchData(t,e){return tn(t,this.isCompressed?"arraybuffer":"text").then(i=>({cMapData:i instanceof ArrayBuffer?new Uint8Array(i):Xi(i),compressionType:e}))}}class Ma extends Ji{_fetchData(t){return tn(t,"arraybuffer").then(e=>new Uint8Array(e))}}class Jn extends Qn{_createSVG(t){return document.createElementNS(ne,t)}}class li{constructor({viewBox:t,scale:e,rotation:i,offsetX:n=0,offsetY:s=0,dontFlip:a=!1}){this.viewBox=t,this.scale=e,this.rotation=i,this.offsetX=n,this.offsetY=s;const o=(t[2]+t[0])/2,l=(t[3]+t[1])/2;let c,h,d,u;switch(i%=360,i<0&&(i+=360),i){case 180:c=-1,h=0,d=0,u=1;break;case 90:c=0,h=1,d=1,u=0;break;case 270:c=0,h=-1,d=-1,u=0;break;case 0:c=1,h=0,d=0,u=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}a&&(d=-d,u=-u);let p,f,m,b;c===0?(p=Math.abs(l-t[1])*e+n,f=Math.abs(o-t[0])*e+s,m=(t[3]-t[1])*e,b=(t[2]-t[0])*e):(p=Math.abs(o-t[0])*e+n,f=Math.abs(l-t[1])*e+s,m=(t[2]-t[0])*e,b=(t[3]-t[1])*e),this.transform=[c*e,h*e,d*e,u*e,p-c*e*o-d*e*l,f-h*e*o-u*e*l],this.width=m,this.height=b}get rawDims(){const{viewBox:t}=this;return ut(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:i=this.offsetX,offsetY:n=this.offsetY,dontFlip:s=!1}={}){return new li({viewBox:this.viewBox.slice(),scale:t,rotation:e,offsetX:i,offsetY:n,dontFlip:s})}convertToViewportPoint(t,e){return q.applyTransform([t,e],this.transform)}convertToViewportRectangle(t){const e=q.applyTransform([t[0],t[1]],this.transform),i=q.applyTransform([t[2],t[3]],this.transform);return[e[0],e[1],i[0],i[1]]}convertToPdfPoint(t,e){return q.applyInverseTransform([t,e],this.transform)}}class ts extends ge{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function es(r){const t=r.length;let e=0;for(;e<t&&r[e].trim()==="";)e++;return r.substring(e,e+5).toLowerCase()==="data:"}function is(r){return typeof r=="string"&&/\.pdf$/i.test(r)}function zc(r){return[r]=r.split(/[#?]/,1),r.substring(r.lastIndexOf("/")+1)}function Gc(r,t="document.pdf"){if(typeof r!="string")return t;if(es(r))return ct('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const e=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,i=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,n=e.exec(r);let s=i.exec(n[1])||i.exec(n[2])||i.exec(n[3]);if(s&&(s=s[0],s.includes("%")))try{s=i.exec(decodeURIComponent(s))[0]}catch{}return s||t}class rr{started=Object.create(null);times=[];time(t){t in this.started&&ct(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||ct(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:i}of this.times)e=Math.max(i.length,e);for(const{name:i,start:n,end:s}of this.times)t.push(`${i.padEnd(e)} ${s-n}ms
`);return t.join("")}}function ti(r,t){try{const{protocol:e}=t?new URL(r,t):new URL(r);return e==="http:"||e==="https:"}catch{return!1}}function jt(r){r.preventDefault()}function Oa(r){console.log("Deprecated API usage: "+r)}let ar;class Da{static toDateObject(t){if(!t||typeof t!="string")return null;ar||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const e=ar.exec(t);if(!e)return null;const i=parseInt(e[1],10);let n=parseInt(e[2],10);n=n>=1&&n<=12?n-1:0;let s=parseInt(e[3],10);s=s>=1&&s<=31?s:1;let a=parseInt(e[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(e[5],10);o=o>=0&&o<=59?o:0;let l=parseInt(e[6],10);l=l>=0&&l<=59?l:0;const c=e[7]||"Z";let h=parseInt(e[8],10);h=h>=0&&h<=23?h:0;let d=parseInt(e[9],10)||0;return d=d>=0&&d<=59?d:0,c==="-"?(a+=h,o+=d):c==="+"&&(a-=h,o-=d),new Date(Date.UTC(i,n,s,a,o,l))}}function Vc(r,{scale:t=1,rotation:e=0}){const{width:i,height:n}=r.attributes.style,s=[0,0,parseInt(i),parseInt(n)];return new li({viewBox:s,scale:t,rotation:e})}function ns(r){if(r.startsWith("#")){const t=parseInt(r.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return r.startsWith("rgb(")?r.slice(4,-1).split(",").map(t=>parseInt(t)):r.startsWith("rgba(")?r.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(ct(`Not a valid color format: "${r}"`),[0,0,0])}function Wc(r){const t=document.createElement("span");t.style.visibility="hidden",document.body.append(t);for(const e of r.keys()){t.style.color=e;const i=window.getComputedStyle(t).color;r.set(e,ns(i))}t.remove()}function vt(r){const{a:t,b:e,c:i,d:n,e:s,f:a}=r.getTransform();return[t,e,i,n,s,a]}function ie(r){const{a:t,b:e,c:i,d:n,e:s,f:a}=r.getTransform().invertSelf();return[t,e,i,n,s,a]}function we(r,t,e=!1,i=!0){if(t instanceof li){const{pageWidth:n,pageHeight:s}=t.rawDims,{style:a}=r,o=Bt.isCSSRoundSupported,l=`var(--scale-factor) * ${n}px`,c=`var(--scale-factor) * ${s}px`,h=o?`round(${l}, 1px)`:`calc(${l})`,d=o?`round(${c}, 1px)`:`calc(${c})`;!e||t.rotation%180===0?(a.width=h,a.height=d):(a.width=d,a.height=h)}i&&r.setAttribute("data-main-rotation",t.rotation)}class ss{#t=null;#e=null;#i;#s=null;constructor(t){this.#i=t}render(){const t=this.#t=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar"),t.addEventListener("contextmenu",jt),t.addEventListener("pointerdown",ss.#a);const e=this.#s=document.createElement("div");e.className="buttons",t.append(e);const i=this.#i.toolbarPosition;if(i){const{style:n}=t,s=this.#i._uiManager.direction==="ltr"?1-i[0]:i[0];n.insetInlineEnd=`${100*s}%`,n.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return this.#l(),t}static#a(t){t.stopPropagation()}#n(t){this.#i._focusEventsAllowed=!1,t.preventDefault(),t.stopPropagation()}#r(t){this.#i._focusEventsAllowed=!0,t.preventDefault(),t.stopPropagation()}#c(t){t.addEventListener("focusin",this.#n.bind(this),{capture:!0}),t.addEventListener("focusout",this.#r.bind(this),{capture:!0}),t.addEventListener("contextmenu",jt)}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden")}#l(){const t=document.createElement("button");t.className="delete",t.tabIndex=0,t.setAttribute("data-l10n-id",`pdfjs-editor-remove-${this.#i.editorType}-button`),this.#c(t),t.addEventListener("click",e=>{this.#i._uiManager.delete()}),this.#s.append(t)}get#d(){const t=document.createElement("div");return t.className="divider",t}addAltTextButton(t){this.#c(t),this.#s.prepend(t,this.#d)}addColorPicker(t){this.#e=t;const e=t.renderButton();this.#c(e),this.#s.prepend(e,this.#d)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class Yc{#t=null;#e=null;#i;constructor(t){this.#i=t}#s(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar"),t.addEventListener("contextmenu",jt);const e=this.#t=document.createElement("div");return e.className="buttons",t.append(e),this.#n(),t}#a(t,e){let i=0,n=0;for(const s of t){const a=s.y+s.height;if(a<i)continue;const o=s.x+(e?s.width:0);if(a>i){n=o,i=a;continue}e?o>n&&(n=o):o<n&&(n=o)}return[e?1-n:n,i]}show(t,e,i){const[n,s]=this.#a(e,i),{style:a}=this.#e||=this.#s();t.append(this.#e),a.insetInlineEnd=`${100*n}%`,a.top=`calc(${100*s}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#n(){const t=document.createElement("button");t.className="highlightButton",t.tabIndex=0,t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const e=document.createElement("span");t.append(e),e.className="visuallyHidden",e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label"),t.addEventListener("contextmenu",jt),t.addEventListener("click",()=>{this.#i.highlightSelection("floating_button")}),this.#t.append(t)}}function Ii(r,t,e){for(const i of e)t.addEventListener(i,r[i].bind(r))}function qc(r){return Math.round(Math.min(255,Math.max(1,255*r))).toString(16).padStart(2,"0")}class Xc{#t=0;get id(){return`${Cc}${this.#t++}`}}class rs{#t=Hc();#e=0;#i=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d"),n=new Image;n.src=t;const s=n.decode().then(()=>(i.drawImage(n,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return ut(this,"_isSVGFittingCanvas",s)}async#s(t,e){this.#i||=new Map;let i=this.#i.get(t);if(i===null)return null;if(i?.bitmap)return i.refCounter+=1,i;try{i||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let n;if(typeof e=="string"?(i.url=e,n=await tn(e,"blob")):n=i.file=e,n.type==="image/svg+xml"){const s=rs._isSVGFittingCanvas,a=new FileReader,o=new Image,l=new Promise((c,h)=>{o.onload=()=>{i.bitmap=o,i.isSvg=!0,c()},a.onload=async()=>{const d=i.svgUrl=a.result;o.src=await s?`${d}#svgView(preserveAspectRatio(none))`:d},o.onerror=a.onerror=h});a.readAsDataURL(n),await l}else i.bitmap=await createImageBitmap(n);i.refCounter=1}catch(n){console.error(n),i=null}return this.#i.set(t,i),i&&this.#i.set(i.id,i),i}async getFromFile(t){const{lastModified:e,name:i,size:n,type:s}=t;return this.#s(`${e}_${i}_${n}_${s}`,t)}async getFromUrl(t){return this.#s(t,t)}async getFromId(t){this.#i||=new Map;const e=this.#i.get(t);return e?e.bitmap?(e.refCounter+=1,e):e.file?this.getFromFile(e.file):this.getFromUrl(e.url):null}getSvgUrl(t){const e=this.#i.get(t);return e?.isSvg?e.svgUrl:null}deleteId(t){this.#i||=new Map;const e=this.#i.get(t);e&&(e.refCounter-=1,e.refCounter===0&&(e.bitmap=null))}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class Kc{#t=[];#e=!1;#i;#s=-1;constructor(t=128){this.#i=t}add({cmd:t,undo:e,post:i,mustExec:n,type:s=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}){if(n&&t(),this.#e)return;const l={cmd:t,undo:e,post:i,type:s};if(this.#s===-1){this.#t.length>0&&(this.#t.length=0),this.#s=0,this.#t.push(l);return}if(a&&this.#t[this.#s].type===s){o&&(l.undo=this.#t[this.#s].undo),this.#t[this.#s]=l;return}const c=this.#s+1;c===this.#i?this.#t.splice(0,1):(this.#s=c,c<this.#t.length&&this.#t.splice(c)),this.#t.push(l)}undo(){if(this.#s===-1)return;this.#e=!0;const{undo:t,post:e}=this.#t[this.#s];t(),e?.(),this.#e=!1,this.#s-=1}redo(){if(this.#s<this.#t.length-1){this.#s+=1,this.#e=!0;const{cmd:t,post:e}=this.#t[this.#s];t(),e?.(),this.#e=!1}}hasSomethingToUndo(){return this.#s!==-1}hasSomethingToRedo(){return this.#s<this.#t.length-1}destroy(){this.#t=null}}class ci{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=Bt.platform;for(const[i,n,s={}]of t)for(const a of i){const o=a.startsWith("mac+");e&&o?(this.callbacks.set(a.slice(4),{callback:n,options:s}),this.allKeys.add(a.split("+").at(-1))):!e&&!o&&(this.callbacks.set(a,{callback:n,options:s}),this.allKeys.add(a.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e}exec(t,e){if(!this.allKeys.has(e.key))return;const i=this.callbacks.get(this.#t(e));if(!i)return;const{callback:n,options:{bubbles:s=!1,args:a=[],checker:o=null}}=i;o&&!o(t,e)||(n.bind(t,...a,e)(),s||(e.stopPropagation(),e.preventDefault()))}}class as{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return Wc(t),ut(this,"_colors",t)}convert(t){const e=ns(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[i,n]of this._colors)if(n.every((s,a)=>s===e[a]))return as._colorsMapping.get(i);return e}getHexCode(t){const e=this._colors.get(t);return e?q.makeHexColor(...e):t}}class pe{#t=null;#e=new Map;#i=new Map;#s=null;#a=null;#n=null;#r=new Kc;#c=0;#l=new Set;#d=null;#f=null;#h=new Set;#o=!1;#p=null;#g=null;#u=null;#v=!1;#m=null;#y=new Xc;#A=!1;#x=!1;#S=null;#P=null;#T=null;#_=dt.NONE;#b=new Set;#E=null;#w=null;#L=null;#R=this.blur.bind(this);#M=this.focus.bind(this);#k=this.copy.bind(this);#O=this.cut.bind(this);#I=this.paste.bind(this);#D=this.keydown.bind(this);#U=this.keyup.bind(this);#G=this.onEditingAction.bind(this);#V=this.onPageChanging.bind(this);#$=this.onScaleChanging.bind(this);#j=this.#rt.bind(this);#F=this.onRotationChanging.bind(this);#X={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#z=[0,0];#N=null;#H=null;#K=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=pe.prototype,e=a=>a.#H.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),i=(a,{target:o})=>{if(o instanceof HTMLInputElement){const{type:l}=o;return l!=="text"&&l!=="number"}return!0},n=this.TRANSLATE_SMALL,s=this.TRANSLATE_BIG;return ut(this,"_keyboardManager",new ci([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],t.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:i}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&a.#H.contains(o)&&!a.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&a.#H.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-n,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-s,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[n,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[s,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-n],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-s],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,n],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,s],checker:e}]]))}constructor(t,e,i,n,s,a,o,l,c){this.#H=t,this.#K=e,this.#s=i,this._eventBus=n,this._eventBus._on("editingaction",this.#G),this._eventBus._on("pagechanging",this.#V),this._eventBus._on("scalechanging",this.#$),this._eventBus._on("rotationchanging",this.#F),this.#at(),this.#Q(),this.#a=s.annotationStorage,this.#p=s.filterFactory,this.#w=a,this.#u=o||null,this.#o=l,this.#T=c||null,this.viewParameters={realScale:ze.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1}destroy(){this.#J(),this.#Z(),this._eventBus._off("editingaction",this.#G),this._eventBus._off("pagechanging",this.#V),this._eventBus._off("scalechanging",this.#$),this._eventBus._off("rotationchanging",this.#F);for(const t of this.#i.values())t.destroy();this.#i.clear(),this.#e.clear(),this.#h.clear(),this.#t=null,this.#b.clear(),this.#r.destroy(),this.#s?.destroy(),this.#m?.hide(),this.#m=null,this.#g&&(clearTimeout(this.#g),this.#g=null),this.#N&&(clearTimeout(this.#N),this.#N=null),this.#ot()}async mlGuess(t){return this.#T?.guess(t)||null}get hasMLManager(){return!!this.#T}get hcmFilter(){return ut(this,"hcmFilter",this.#w?this.#p.addHCMFilter(this.#w.foreground,this.#w.background):"none")}get direction(){return ut(this,"direction",getComputedStyle(this.#H).direction)}get highlightColors(){return ut(this,"highlightColors",this.#u?new Map(this.#u.split(",").map(t=>t.split("=").map(e=>e.trim()))):null)}get highlightColorNames(){return ut(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}setMainHighlightColorPicker(t){this.#P=t}editAltText(t){this.#s?.editAltText(this,t)}onPageChanging({pageNumber:t}){this.#c=t-1}focusMainContainer(){this.#H.focus()}findParent(t,e){for(const i of this.#i.values()){const{x:n,y:s,width:a,height:o}=i.div.getBoundingClientRect();if(t>=n&&t<=n+a&&e>=s&&e<=s+o)return i}return null}disableUserSelect(t=!1){this.#K.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#h.add(t)}removeShouldRescale(t){this.#h.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*ze.PDF_TO_CSS_UNITS;for(const e of this.#h)e.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#Y({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}highlightSelection(t=""){const e=document.getSelection();if(!e||e.isCollapsed)return;const{anchorNode:i,anchorOffset:n,focusNode:s,focusOffset:a}=e,o=e.toString(),c=this.#Y(e).closest(".textLayer"),h=this.getSelectionBoxes(c);if(h){e.empty(),this.#_===dt.NONE&&(this._eventBus.dispatch("showannotationeditorui",{source:this,mode:dt.HIGHLIGHT}),this.showAllEditors("highlight",!0,!0));for(const d of this.#i.values())if(d.hasTextLayer(c)){d.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:h,anchorNode:i,anchorOffset:n,focusNode:s,focusOffset:a,text:o});break}}}#st(){const t=document.getSelection();if(!t||t.isCollapsed)return;const i=this.#Y(t).closest(".textLayer"),n=this.getSelectionBoxes(i);n&&(this.#m||=new Yc(this),this.#m.show(i,n,this.direction==="ltr"))}addToAnnotationStorage(t){!t.isEmpty()&&this.#a&&!this.#a.has(t.id)&&this.#a.setValue(t.id,t)}#rt(){const t=document.getSelection();if(!t||t.isCollapsed){this.#E&&(this.#m?.hide(),this.#E=null,this.#C({hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===this.#E)return;if(!this.#Y(t).closest(".textLayer")){this.#E&&(this.#m?.hide(),this.#E=null,this.#C({hasSelectedText:!1}));return}if(this.#m?.hide(),this.#E=e,this.#C({hasSelectedText:!0}),!(this.#_!==dt.HIGHLIGHT&&this.#_!==dt.NONE)&&(this.#_===dt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#v=this.isShiftKeyDown,!this.isShiftKeyDown)){const s=a=>{a.type==="pointerup"&&a.button!==0||(window.removeEventListener("pointerup",s),window.removeEventListener("blur",s),a.type==="pointerup"&&this.#q("main_toolbar"))};window.addEventListener("pointerup",s),window.addEventListener("blur",s)}}#q(t=""){this.#_===dt.HIGHLIGHT?this.highlightSelection(t):this.#o&&this.#st()}#at(){document.addEventListener("selectionchange",this.#j)}#ot(){document.removeEventListener("selectionchange",this.#j)}#lt(){window.addEventListener("focus",this.#M),window.addEventListener("blur",this.#R)}#Z(){window.removeEventListener("focus",this.#M),window.removeEventListener("blur",this.#R)}blur(){if(this.isShiftKeyDown=!1,this.#v&&(this.#v=!1,this.#q("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of this.#b)if(e.div.contains(t)){this.#S=[e,t],e._focusEventsAllowed=!1;break}}focus(){if(!this.#S)return;const[t,e]=this.#S;this.#S=null,e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0}),e.focus()}#Q(){window.addEventListener("keydown",this.#D),window.addEventListener("keyup",this.#U)}#J(){window.removeEventListener("keydown",this.#D),window.removeEventListener("keyup",this.#U)}#tt(){document.addEventListener("copy",this.#k),document.addEventListener("cut",this.#O),document.addEventListener("paste",this.#I)}#et(){document.removeEventListener("copy",this.#k),document.removeEventListener("cut",this.#O),document.removeEventListener("paste",this.#I)}addEditListeners(){this.#Q(),this.#tt()}removeEditListeners(){this.#J(),this.#et()}copy(t){if(t.preventDefault(),this.#t?.commitOrRemove(),!this.hasSelection)return;const e=[];for(const i of this.#b){const n=i.serialize(!0);n&&e.push(n)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}paste(t){t.preventDefault();const{clipboardData:e}=t;for(const s of e.items)for(const a of this.#f)if(a.isHandlingMimeForPasting(s.type)){a.paste(s,this.currentLayer);return}let i=e.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(s){ct(`paste: "${s.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const n=this.currentLayer;try{const s=[];for(const l of i){const c=n.deserialize(l);if(!c)return;s.push(c)}const a=()=>{for(const l of s)this.#it(l);this.#nt(s)},o=()=>{for(const l of s)l.remove()};this.addCommands({cmd:a,undo:o,mustExec:!0})}catch(s){ct(`paste: "${s.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#_!==dt.NONE&&!this.isEditorHandlingKeyboard&&pe._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#v&&(this.#v=!1,this.#q("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}#C(t){Object.entries(t).some(([i,n])=>this.#X[i]!==n)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#X,t)}),this.#_===dt.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#B([[st.HIGHLIGHT_FREE,!0]]))}#B(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#lt(),this.#tt(),this.#C({isEditing:this.#_!==dt.NONE,isEmpty:this.#W(),hasSomethingToUndo:this.#r.hasSomethingToUndo(),hasSomethingToRedo:this.#r.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#Z(),this.#et(),this.#C({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#f){this.#f=t;for(const e of this.#f)this.#B(e.defaultPropertiesToUpdate)}}getId(){return this.#y.id}get currentLayer(){return this.#i.get(this.#c)}getLayer(t){return this.#i.get(t)}get currentPageIndex(){return this.#c}addLayer(t){this.#i.set(t.pageIndex,t),this.#A?t.enable():t.disable()}removeLayer(t){this.#i.delete(t.pageIndex)}updateMode(t,e=null,i=!1){if(this.#_!==t){if(this.#_=t,t===dt.NONE){this.setEditingState(!1),this.#ht();return}this.setEditingState(!0),this.#ct(),this.unselectAll();for(const n of this.#i.values())n.updateMode(t);if(!e&&i){this.addNewEditorFromKeyboard();return}if(e){for(const n of this.#e.values())if(n.annotationElementId===e){this.setSelected(n),n.enterInEditMode();break}}}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t!==this.#_&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:t})}updateParams(t,e){if(this.#f){switch(t){case st.CREATE:this.currentLayer.addNewEditor();return;case st.HIGHLIGHT_DEFAULT_COLOR:this.#P?.updateColor(e);break;case st.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#L||=new Map).set(t,e),this.showAllEditors("highlight",e);break}for(const i of this.#b)i.updateParams(t,e);for(const i of this.#f)i.updateDefaultParams(t,e)}}showAllEditors(t,e,i=!1){for(const s of this.#e.values())s.editorType===t&&s.show(e);(this.#L?.get(st.HIGHLIGHT_SHOW_ALL)??!0)!==e&&this.#B([[st.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(this.#x!==t){this.#x=t;for(const e of this.#i.values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}#ct(){if(!this.#A){this.#A=!0;for(const t of this.#i.values())t.enable();for(const t of this.#e.values())t.enable()}}#ht(){if(this.unselectAll(),this.#A){this.#A=!1;for(const t of this.#i.values())t.disable();for(const t of this.#e.values())t.disable()}}getEditors(t){const e=[];for(const i of this.#e.values())i.pageIndex===t&&e.push(i);return e}getEditor(t){return this.#e.get(t)}addEditor(t){this.#e.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#g&&clearTimeout(this.#g),this.#g=setTimeout(()=>{this.focusMainContainer(),this.#g=null},0)),this.#e.delete(t.id),this.unselect(t),(!t.annotationElementId||!this.#l.has(t.annotationElementId))&&this.#a?.remove(t.id)}addDeletedAnnotationElement(t){this.#l.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#l.has(t)}removeDeletedAnnotationElement(t){this.#l.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#it(t){const e=this.#i.get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#t!==t&&(this.#t=t,t&&this.#B(t.propertiesToUpdate))}get#dt(){let t=null;for(t of this.#b);return t}updateUI(t){this.#dt===t&&this.#B(t.propertiesToUpdate)}toggleSelected(t){if(this.#b.has(t)){this.#b.delete(t),t.unselect(),this.#C({hasSelectedEditor:this.hasSelection});return}this.#b.add(t),t.select(),this.#B(t.propertiesToUpdate),this.#C({hasSelectedEditor:!0})}setSelected(t){for(const e of this.#b)e!==t&&e.unselect();this.#b.clear(),this.#b.add(t),t.select(),this.#B(t.propertiesToUpdate),this.#C({hasSelectedEditor:!0})}isSelected(t){return this.#b.has(t)}get firstSelectedEditor(){return this.#b.values().next().value}unselect(t){t.unselect(),this.#b.delete(t),this.#C({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#b.size!==0}get isEnterHandled(){return this.#b.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#r.undo(),this.#C({hasSomethingToUndo:this.#r.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#W()})}redo(){this.#r.redo(),this.#C({hasSomethingToUndo:!0,hasSomethingToRedo:this.#r.hasSomethingToRedo(),isEmpty:this.#W()})}addCommands(t){this.#r.add(t),this.#C({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#W()})}#W(){if(this.#e.size===0)return!0;if(this.#e.size===1)for(const t of this.#e.values())return t.isEmpty();return!1}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const t=[...this.#b],e=()=>{for(const n of t)n.remove()},i=()=>{for(const n of t)this.#it(n)};this.addCommands({cmd:e,undo:i,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}hasSomethingToControl(){return this.#t||this.hasSelection}#nt(t){for(const e of this.#b)e.unselect();this.#b.clear();for(const e of t)e.isEmpty()||(this.#b.add(e),e.select());this.#C({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#b)t.commit();this.#nt(this.#e.values())}unselectAll(){if(!(this.#t&&(this.#t.commitOrRemove(),this.#_!==dt.NONE))&&this.hasSelection){for(const t of this.#b)t.unselect();this.#b.clear(),this.#C({hasSelectedEditor:!1})}}translateSelectedEditors(t,e,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;this.#z[0]+=t,this.#z[1]+=e;const[n,s]=this.#z,a=[...this.#b],o=1e3;this.#N&&clearTimeout(this.#N),this.#N=setTimeout(()=>{this.#N=null,this.#z[0]=this.#z[1]=0,this.addCommands({cmd:()=>{for(const l of a)this.#e.has(l.id)&&l.translateInPage(n,s)},undo:()=>{for(const l of a)this.#e.has(l.id)&&l.translateInPage(-n,-s)},mustExec:!1})},o);for(const l of a)l.translateInPage(t,e)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#d=new Map;for(const t of this.#b)this.#d.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#d)return!1;this.disableUserSelect(!1);const t=this.#d;this.#d=null;let e=!1;for(const[{x:n,y:s,pageIndex:a},o]of t)o.newX=n,o.newY=s,o.newPageIndex=a,e||=n!==o.savedX||s!==o.savedY||a!==o.savedPageIndex;if(!e)return!1;const i=(n,s,a,o)=>{if(this.#e.has(n.id)){const l=this.#i.get(o);l?n._setParentAndPosition(l,s,a):(n.pageIndex=o,n.x=s,n.y=a)}};return this.addCommands({cmd:()=>{for(const[n,{newX:s,newY:a,newPageIndex:o}]of t)i(n,s,a,o)},undo:()=>{for(const[n,{savedX:s,savedY:a,savedPageIndex:o}]of t)i(n,s,a,o)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(this.#d)for(const i of this.#d.keys())i.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#b.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#t===t}getActive(){return this.#t}getMode(){return this.#_}get imageManager(){return ut(this,"imageManager",new rs)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let c=0,h=e.rangeCount;c<h;c++)if(!t.contains(e.getRangeAt(c).commonAncestorContainer))return null;const{x:i,y:n,width:s,height:a}=t.getBoundingClientRect();let o;switch(t.getAttribute("data-main-rotation")){case"90":o=(c,h,d,u)=>({x:(h-n)/a,y:1-(c+d-i)/s,width:u/a,height:d/s});break;case"180":o=(c,h,d,u)=>({x:1-(c+d-i)/s,y:1-(h+u-n)/a,width:d/s,height:u/a});break;case"270":o=(c,h,d,u)=>({x:1-(h+u-n)/a,y:(c-i)/s,width:u/a,height:d/s});break;default:o=(c,h,d,u)=>({x:(c-i)/s,y:(h-n)/a,width:d/s,height:u/a});break}const l=[];for(let c=0,h=e.rangeCount;c<h;c++){const d=e.getRangeAt(c);if(!d.collapsed)for(const{x:u,y:p,width:f,height:m}of d.getClientRects())f===0||m===0||l.push(o(u,p,f,m))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:t,id:e}){(this.#n||=new Map).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){this.#n?.delete(t)}renderAnnotationElement(t){const e=this.#n?.get(t.data.id);if(!e)return;const i=this.#a.getRawValue(e);i&&(this.#_===dt.NONE&&!i.hasBeenModified||i.renderAnnotationElement(t))}}class ye{#t="";#e=!1;#i=null;#s=null;#a=null;#n=!1;#r=null;static _l10nPromise=null;constructor(t){this.#r=t}static initialize(t){ye._l10nPromise||=t}async render(){const t=this.#i=document.createElement("button");t.className="altText";const e=await ye._l10nPromise.get("pdfjs-editor-alt-text-button-label");t.textContent=e,t.setAttribute("aria-label",e),t.tabIndex="0",t.addEventListener("contextmenu",jt),t.addEventListener("pointerdown",n=>n.stopPropagation());const i=n=>{n.preventDefault(),this.#r._uiManager.editAltText(this.#r)};return t.addEventListener("click",i,{capture:!0}),t.addEventListener("keydown",n=>{n.target===t&&n.key==="Enter"&&(this.#n=!0,i(n))}),await this.#c(),t}finish(){this.#i&&(this.#i.focus({focusVisible:this.#n}),this.#n=!1)}isEmpty(){return!this.#t&&!this.#e}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:e}){this.#t===t&&this.#e===e||(this.#t=t,this.#e=e,this.#c())}toggle(t=!1){this.#i&&(!t&&this.#a&&(clearTimeout(this.#a),this.#a=null),this.#i.disabled=!t)}destroy(){this.#i?.remove(),this.#i=null,this.#s=null}async#c(){const t=this.#i;if(!t)return;if(!this.#t&&!this.#e){t.classList.remove("done"),this.#s?.remove();return}t.classList.add("done"),ye._l10nPromise.get("pdfjs-editor-alt-text-edit-button-label").then(n=>{t.setAttribute("aria-label",n)});let e=this.#s;if(!e){this.#s=e=document.createElement("span"),e.className="tooltip",e.setAttribute("role","tooltip");const n=e.id=`alt-text-tooltip-${this.#r.id}`;t.setAttribute("aria-describedby",n);const s=100;t.addEventListener("mouseenter",()=>{this.#a=setTimeout(()=>{this.#a=null,this.#s.classList.add("show"),this.#r._reportTelemetry({action:"alt_text_tooltip"})},s)}),t.addEventListener("mouseleave",()=>{this.#a&&(clearTimeout(this.#a),this.#a=null),this.#s?.classList.remove("show")})}e.innerText=this.#e?await ye._l10nPromise.get("pdfjs-editor-alt-text-decorative-tooltip"):this.#t,e.parentNode||t.append(e),this.#r.getImageForAltText()?.setAttribute("aria-describedby",e.id)}}class nt{#t=null;#e=null;#i=!1;#s=!1;#a=null;#n=null;#r=this.focusin.bind(this);#c=this.focusout.bind(this);#l=null;#d="";#f=!1;#h=null;#o=!1;#p=!1;#g=!1;#u=null;#v=0;#m=0;#y=null;_initialOptions=Object.create(null);_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;_l10nPromise=null;#A=!1;#x=nt._zIndex++;static _borderLineWidth=-1;static _colorManager=new as;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=nt.prototype._resizeWithKeyboard,e=pe.TRANSLATE_SMALL,i=pe.TRANSLATE_BIG;return ut(this,"_resizerKeyboardManager",new ci([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,i]}],[["Escape","mac+Escape"],nt.prototype._stopResizingWithKeyboard]]))}constructor(t){this.constructor===nt&&gt("Cannot initialize AnnotationEditor."),this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null;const{rotation:e,rawDims:{pageWidth:i,pageHeight:n,pageX:s,pageY:a}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,n],this.pageTranslation=[s,a];const[o,l]=this.parentDimensions;this.x=t.x/o,this.y=t.y/l,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return ut(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new Zc({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e,i){if(nt._l10nPromise||=new Map(["pdfjs-editor-alt-text-button-label","pdfjs-editor-alt-text-edit-button-label","pdfjs-editor-alt-text-decorative-tooltip","pdfjs-editor-resizer-label-topLeft","pdfjs-editor-resizer-label-topMiddle","pdfjs-editor-resizer-label-topRight","pdfjs-editor-resizer-label-middleRight","pdfjs-editor-resizer-label-bottomRight","pdfjs-editor-resizer-label-bottomMiddle","pdfjs-editor-resizer-label-bottomLeft","pdfjs-editor-resizer-label-middleLeft"].map(s=>[s,t.get(s.replaceAll(/([A-Z])/g,a=>`-${a.toLowerCase()}`))])),i?.strings)for(const s of i.strings)nt._l10nPromise.set(s,t.get(s));if(nt._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);nt._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){gt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#A}set _isDraggable(t){this.#A=t,this.div?.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#x}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):this.#D(),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#f?this.#f=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,i,n){const[s,a]=this.parentDimensions;[i,n]=this.screenToPageTranslation(i,n),this.x=(t+i)/s,this.y=(e+n)/a,this.fixAndSetPosition()}#S([t,e],i,n){[i,n]=this.screenToPageTranslation(i,n),this.x+=i/t,this.y+=n/e,this.fixAndSetPosition()}translate(t,e){this.#S(this.parentDimensions,t,e)}translateInPage(t,e){this.#h||=[this.x,this.y],this.#S(this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}drag(t,e){this.#h||=[this.x,this.y];const[i,n]=this.parentDimensions;if(this.x+=t/i,this.y+=e/n,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:c,y:h}=this.div.getBoundingClientRect();this.parent.findNewParent(this,c,h)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:s,y:a}=this;const[o,l]=this.getBaseTranslation();s+=o,a+=l,this.div.style.left=`${(100*s).toFixed(2)}%`,this.div.style.top=`${(100*a).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}get _hasBeenMoved(){return!!this.#h&&(this.#h[0]!==this.x||this.#h[1]!==this.y)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:i}=nt,n=i/t,s=i/e;switch(this.rotation){case 90:return[-n,s];case 180:return[n,s];case 270:return[n,-s];default:return[-n,-s]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const[e,i]=this.pageDimensions;let{x:n,y:s,width:a,height:o}=this;if(a*=e,o*=i,n*=e,s*=i,this._mustFixPosition)switch(t){case 0:n=Math.max(0,Math.min(e-a,n)),s=Math.max(0,Math.min(i-o,s));break;case 90:n=Math.max(0,Math.min(e-o,n)),s=Math.min(i,Math.max(a,s));break;case 180:n=Math.min(e,Math.max(a,n)),s=Math.min(i,Math.max(o,s));break;case 270:n=Math.min(e,Math.max(o,n)),s=Math.max(0,Math.min(i-a,s));break}this.x=n/=e,this.y=s/=i;const[l,c]=this.getBaseTranslation();n+=l,s+=c;const{style:h}=this.div;h.left=`${(100*n).toFixed(2)}%`,h.top=`${(100*s).toFixed(2)}%`,this.moveInDOM()}static#P(t,e,i){switch(i){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}}screenToPageTranslation(t,e){return nt.#P(t,e,this.parentRotation)}pageTranslationToScreen(t,e){return nt.#P(t,e,360-this.parentRotation)}#T(t){switch(t){case 90:{const[e,i]=this.pageDimensions;return[0,-e/i,i/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,i]=this.pageDimensions;return[0,e/i,-i/e,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,i]}=this,n=e*t,s=i*t;return Bt.isCSSRoundSupported?[Math.round(n),Math.round(s)]:[n,s]}setDims(t,e){const[i,n]=this.parentDimensions;this.div.style.width=`${(100*t/i).toFixed(2)}%`,this.#s||(this.div.style.height=`${(100*e/n).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:e,width:i}=t,n=i.endsWith("%"),s=!this.#s&&e.endsWith("%");if(n&&s)return;const[a,o]=this.parentDimensions;n||(t.width=`${(100*parseFloat(i)/a).toFixed(2)}%`),!this.#s&&!s&&(t.height=`${(100*parseFloat(e)/o).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#_(){if(this.#a)return;this.#a=document.createElement("div"),this.#a.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"];for(const e of t){const i=document.createElement("div");this.#a.append(i),i.classList.add("resizer",e),i.setAttribute("data-resizer-name",e),i.addEventListener("pointerdown",this.#b.bind(this,e)),i.addEventListener("contextmenu",jt),i.tabIndex=-1}this.div.prepend(this.#a)}#b(t,e){e.preventDefault();const{isMac:i}=Bt.platform;if(e.button!==0||e.ctrlKey&&i)return;this.#e?.toggle(!1);const n=this.#w.bind(this,t),s=this._isDraggable;this._isDraggable=!1;const a={passive:!0,capture:!0};this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",n,a),window.addEventListener("contextmenu",jt);const o=this.x,l=this.y,c=this.width,h=this.height,d=this.parent.div.style.cursor,u=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const p=()=>{this.parent.togglePointerEvents(!0),this.#e?.toggle(!0),this._isDraggable=s,window.removeEventListener("pointerup",p),window.removeEventListener("blur",p),window.removeEventListener("pointermove",n,a),window.removeEventListener("contextmenu",jt),this.parent.div.style.cursor=d,this.div.style.cursor=u,this.#E(o,l,c,h)};window.addEventListener("pointerup",p),window.addEventListener("blur",p)}#E(t,e,i,n){const s=this.x,a=this.y,o=this.width,l=this.height;s===t&&a===e&&o===i&&l===n||this.addCommands({cmd:()=>{this.width=o,this.height=l,this.x=s,this.y=a;const[c,h]=this.parentDimensions;this.setDims(c*o,h*l),this.fixAndSetPosition()},undo:()=>{this.width=i,this.height=n,this.x=t,this.y=e;const[c,h]=this.parentDimensions;this.setDims(c*i,h*n),this.fixAndSetPosition()},mustExec:!0})}#w(t,e){const[i,n]=this.parentDimensions,s=this.x,a=this.y,o=this.width,l=this.height,c=nt.MIN_SIZE/i,h=nt.MIN_SIZE/n,d=F=>Math.round(F*1e4)/1e4,u=this.#T(this.rotation),p=(F,_)=>[u[0]*F+u[2]*_,u[1]*F+u[3]*_],f=this.#T(360-this.rotation),m=(F,_)=>[f[0]*F+f[2]*_,f[1]*F+f[3]*_];let b,g,y=!1,x=!1;switch(t){case"topLeft":y=!0,b=(F,_)=>[0,0],g=(F,_)=>[F,_];break;case"topMiddle":b=(F,_)=>[F/2,0],g=(F,_)=>[F/2,_];break;case"topRight":y=!0,b=(F,_)=>[F,0],g=(F,_)=>[0,_];break;case"middleRight":x=!0,b=(F,_)=>[F,_/2],g=(F,_)=>[0,_/2];break;case"bottomRight":y=!0,b=(F,_)=>[F,_],g=(F,_)=>[0,0];break;case"bottomMiddle":b=(F,_)=>[F/2,_],g=(F,_)=>[F/2,0];break;case"bottomLeft":y=!0,b=(F,_)=>[0,_],g=(F,_)=>[F,0];break;case"middleLeft":x=!0,b=(F,_)=>[0,_/2],g=(F,_)=>[F,_/2];break}const w=b(o,l),v=g(o,l);let R=p(...v);const I=d(s+R[0]),j=d(a+R[1]);let H=1,z=1,[D,$]=this.screenToPageTranslation(e.movementX,e.movementY);if([D,$]=m(D/i,$/n),y){const F=Math.hypot(o,l);H=z=Math.max(Math.min(Math.hypot(v[0]-w[0]-D,v[1]-w[1]-$)/F,1/o,1/l),c/o,h/l)}else x?H=Math.max(c,Math.min(1,Math.abs(v[0]-w[0]-D)))/o:z=Math.max(h,Math.min(1,Math.abs(v[1]-w[1]-$)))/l;const W=d(o*H),Y=d(l*z);R=p(...g(W,Y));const G=I-R[0],J=j-R[1];this.width=W,this.height=Y,this.x=G,this.y=J,this.setDims(i*W,n*Y),this.fixAndSetPosition()}altTextFinish(){this.#e?.finish()}async addEditToolbar(){return this.#l||this.#p?this.#l:(this.#l=new ss(this),this.div.append(this.#l.render()),this.#e&&this.#l.addAltTextButton(await this.#e.render()),this.#l)}removeEditToolbar(){this.#l&&(this.#l.remove(),this.#l=null,this.#e?.destroy())}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){this.#e||(ye.initialize(nt._l10nPromise),this.#e=new ye(this),await this.addEditToolbar())}get altTextData(){return this.#e?.data}set altTextData(t){this.#e&&(this.#e.data=t)}hasAltText(){return!this.#e?.isEmpty()}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=this.#i?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),this.div.addEventListener("focusin",this.#r),this.div.addEventListener("focusout",this.#c);const[t,e]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*e/t).toFixed(2)}%`,this.div.style.maxHeight=`${(100*t/e).toFixed(2)}%`);const[i,n]=this.getInitialTranslation();return this.translate(i,n),Ii(this,this.div,["pointerdown"]),this.div}pointerdown(t){const{isMac:e}=Bt.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(this.#f=!0,this._isDraggable){this.#R(t);return}this.#L(t)}#L(t){const{isMac:e}=Bt.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}#R(t){const e=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let i,n;e&&(this.div.classList.add("moving"),i={passive:!0,capture:!0},this.#v=t.clientX,this.#m=t.clientY,n=a=>{const{clientX:o,clientY:l}=a,[c,h]=this.screenToPageTranslation(o-this.#v,l-this.#m);this.#v=o,this.#m=l,this._uiManager.dragSelectedEditors(c,h)},window.addEventListener("pointermove",n,i));const s=()=>{window.removeEventListener("pointerup",s),window.removeEventListener("blur",s),e&&(this.div.classList.remove("moving"),window.removeEventListener("pointermove",n,i)),this.#f=!1,this._uiManager.endDragSession()||this.#L(t)};window.addEventListener("pointerup",s),window.addEventListener("blur",s)}moveInDOM(){this.#u&&clearTimeout(this.#u),this.#u=setTimeout(()=>{this.#u=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,e,i){t.changeParent(this),this.x=e,this.y=i,this.fixAndSetPosition()}getRect(t,e,i=this.rotation){const n=this.parentScale,[s,a]=this.pageDimensions,[o,l]=this.pageTranslation,c=t/n,h=e/n,d=this.x*s,u=this.y*a,p=this.width*s,f=this.height*a;switch(i){case 0:return[d+c+o,a-u-h-f+l,d+c+p+o,a-u-h+l];case 90:return[d+h+o,a-u+c+l,d+h+f+o,a-u+c+p+l];case 180:return[d-c-p+o,a-u+h+l,d-c+o,a-u+h+f+l];case 270:return[d-h-f+o,a-u-c-p+l,d-h+o,a-u-c+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[i,n,s,a]=t,o=s-i,l=a-n;switch(this.rotation){case 0:return[i,e-a,o,l];case 90:return[i,e-n,l,o];case 180:return[s,e-n,o,l];case 270:return[s,e-a,l,o];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#p=!0}disableEditMode(){this.#p=!1}isInEditMode(){return this.#p}shouldGetKeyboardEvents(){return this.#g}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){this.div?.addEventListener("focusin",this.#r),this.div?.addEventListener("focusout",this.#c)}rotate(t){}serialize(t=!1,e=null){gt("An editor must be serializable")}static deserialize(t,e,i){const n=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:i});n.rotation=t.rotation;const[s,a]=n.pageDimensions,[o,l,c,h]=n.getRectInCurrentCoords(t.rect,a);return n.x=o/s,n.y=l/a,n.width=c/s,n.height=h/a,n}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.div.removeEventListener("focusin",this.#r),this.div.removeEventListener("focusout",this.#c),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#u&&(clearTimeout(this.#u),this.#u=null),this.#D(),this.removeEditToolbar(),this.#y){for(const t of this.#y.values())clearTimeout(t);this.#y=null}this.parent=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#_(),this.#a.classList.remove("hidden"),Ii(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#n={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const e=this.#a.children;if(!this.#t){this.#t=Array.from(e);const a=this.#M.bind(this),o=this.#k.bind(this);for(const l of this.#t){const c=l.getAttribute("data-resizer-name");l.setAttribute("role","spinbutton"),l.addEventListener("keydown",a),l.addEventListener("blur",o),l.addEventListener("focus",this.#O.bind(this,c)),nt._l10nPromise.get(`pdfjs-editor-resizer-label-${c}`).then(h=>l.setAttribute("aria-label",h))}}const i=this.#t[0];let n=0;for(const a of e){if(a===i)break;n++}const s=(360-this.rotation+this.parentRotation)%360/90*(this.#t.length/4);if(s!==n){if(s<n)for(let o=0;o<n-s;o++)this.#a.append(this.#a.firstChild);else if(s>n)for(let o=0;o<s-n;o++)this.#a.firstChild.before(this.#a.lastChild);let a=0;for(const o of e){const c=this.#t[a++].getAttribute("data-resizer-name");nt._l10nPromise.get(`pdfjs-editor-resizer-label-${c}`).then(h=>o.setAttribute("aria-label",h))}}this.#I(0),this.#g=!0,this.#a.firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#M(t){nt._resizerKeyboardManager.exec(this,t)}#k(t){this.#g&&t.relatedTarget?.parentNode!==this.#a&&this.#D()}#O(t){this.#d=this.#g?t:""}#I(t){if(this.#t)for(const e of this.#t)e.tabIndex=t}_resizeWithKeyboard(t,e){this.#g&&this.#w(this.#d,{movementX:t,movementY:e})}#D(){if(this.#g=!1,this.#I(-1),this.#n){const{savedX:t,savedY:e,savedWidth:i,savedHeight:n}=this.#n;this.#E(t,e,i,n),this.#n=null}}_stopResizingWithKeyboard(){this.#D(),this.div.focus()}select(){if(this.makeResizable(),this.div?.classList.add("selectedEditor"),!this.#l){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this.#l?.show()});return}this.#l?.show()}unselect(){this.#a?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this.#l?.hide()}updateParams(t,e){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return this.#o}set isEditing(t){this.#o=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,e){this.#s=!0;const i=t/e,{style:n}=this.div;n.aspectRatio=i,n.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){this.#y||=new Map;const{action:i}=t;let n=this.#y.get(i);n&&clearTimeout(n),n=setTimeout(()=>{this._reportTelemetry(t),this.#y.delete(i),this.#y.size===0&&(this.#y=null)},nt._telemetryTimeout),this.#y.set(i,n);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#i=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#i=!0}renderAnnotationElement(t){let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const i=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),i.before(e)}return e}resetAnnotationElement(t){const{firstChild:e}=t.container;e.nodeName==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}}class Zc extends nt{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}const or=3285377520,zt=4294901760,Xt=65535;class Fa{constructor(t){this.h1=t?t&4294967295:or,this.h2=t?t&4294967295:or}update(t){let e,i;if(typeof t=="string"){e=new Uint8Array(t.length*2),i=0;for(let m=0,b=t.length;m<b;m++){const g=t.charCodeAt(m);g<=255?e[i++]=g:(e[i++]=g>>>8,e[i++]=g&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),i=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const n=i>>2,s=i-n*4,a=new Uint32Array(e.buffer,0,n);let o=0,l=0,c=this.h1,h=this.h2;const d=3432918353,u=461845907,p=d&Xt,f=u&Xt;for(let m=0;m<n;m++)m&1?(o=a[m],o=o*d&zt|o*p&Xt,o=o<<15|o>>>17,o=o*u&zt|o*f&Xt,c^=o,c=c<<13|c>>>19,c=c*5+3864292196):(l=a[m],l=l*d&zt|l*p&Xt,l=l<<15|l>>>17,l=l*u&zt|l*f&Xt,h^=l,h=h<<13|h>>>19,h=h*5+3864292196);switch(o=0,s){case 3:o^=e[n*4+2]<<16;case 2:o^=e[n*4+1]<<8;case 1:o^=e[n*4],o=o*d&zt|o*p&Xt,o=o<<15|o>>>17,o=o*u&zt|o*f&Xt,n&1?c^=o:h^=o}this.h1=c,this.h2=h}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&zt|t*36045&Xt,e=e*4283543511&zt|((e<<16|t>>>16)*2950163797&zt)>>>16,t^=e>>>1,t=t*444984403&zt|t*60499&Xt,e=e*3301882366&zt|((e<<16|t>>>16)*3120437893&zt)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const On=Object.freeze({map:null,hash:"",transfer:void 0});class os{#t=!1;#e=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const i=this.#e.get(t);return i===void 0?e:Object.assign(e,i)}getRawValue(t){return this.#e.get(t)}remove(t){if(this.#e.delete(t),this.#e.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const e of this.#e.values())if(e instanceof nt)return;this.onAnnotationEditor(null)}}setValue(t,e){const i=this.#e.get(t);let n=!1;if(i!==void 0)for(const[s,a]of Object.entries(e))i[s]!==a&&(n=!0,i[s]=a);else n=!0,this.#e.set(t,e);n&&this.#i(),e instanceof nt&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type)}has(t){return this.#e.has(t)}getAll(){return this.#e.size>0?Zn(this.#e):null}setAll(t){for(const[e,i]of Object.entries(t))this.setValue(e,i)}get size(){return this.#e.size}#i(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new Na(this)}get serializable(){if(this.#e.size===0)return On;const t=new Map,e=new Fa,i=[],n=Object.create(null);let s=!1;for(const[a,o]of this.#e){const l=o instanceof nt?o.serialize(!1,n):o;l&&(t.set(a,l),e.update(`${a}:${JSON.stringify(l)}`),s||=!!l.bitmap)}if(s)for(const a of t.values())a.bitmap&&i.push(a.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:i}:On}get editorStats(){let t=null;const e=new Map;for(const i of this.#e.values()){if(!(i instanceof nt))continue;const n=i.telemetryFinalData;if(!n)continue;const{type:s}=n;e.has(s)||e.set(s,Object.getPrototypeOf(i).constructor),t||=Object.create(null);const a=t[s]||=new Map;for(const[o,l]of Object.entries(n)){if(o==="type")continue;let c=a.get(o);c||(c=new Map,a.set(o,c));const h=c.get(l)??0;c.set(l,h+1)}}for(const[i,n]of e)t[i]=n.computeTelemetryFinalData(t[i]);return t}}class Na extends os{#t;constructor(t){super();const{map:e,hash:i,transfer:n}=t.serializable,s=structuredClone(e,n?{transfer:n}:null);this.#t={map:s,hash:i,transfer:n}}get print(){gt("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}}class Qc{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,_inspectFont:e}){if(!(!t||this.#t.has(t.loadedName))){if(St(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:n,style:s}=t,a=new FontFace(i,n,s);this.addNativeFontFace(a);try{await a.load(),this.#t.add(i),e?.(t)}catch{ct(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(a)}return}gt("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const i=t.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(n){throw ct(`Failed to load font '${i.family}': '${n}'.`),t.disableFontFace=!0,n}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const n=this._queueLoadingCallback(i);this._prepareFontLoadEvent(t,n)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return ut(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){let t=!1;return(Mt||typeof navigator<"u"&&typeof navigator?.userAgent=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(t=!0),ut(this,"isSyncFontLoadingSupported",t)}_queueLoadingCallback(t){function e(){for(St(!n.done,"completeRequest() cannot be called twice."),n.done=!0;i.length>0&&i[0].done;){const s=i.shift();setTimeout(s.callback,0)}}const{loadingRequests:i}=this,n={done:!1,complete:e,callback:t};return i.push(n),n}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return ut(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function i(w,v){return w.charCodeAt(v)<<24|w.charCodeAt(v+1)<<16|w.charCodeAt(v+2)<<8|w.charCodeAt(v+3)&255}function n(w,v,R,I){const j=w.substring(0,v),H=w.substring(v+R);return j+I+H}let s,a;const o=this._document.createElement("canvas");o.width=1,o.height=1;const l=o.getContext("2d");let c=0;function h(w,v){if(++c>30){ct("Load test font never loaded."),v();return}if(l.font="30px "+w,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){v();return}setTimeout(h.bind(null,w,v))}const d=`lt${Date.now()}${this.loadTestFontId++}`;let u=this._loadTestFont;u=n(u,976,d.length,d);const f=16,m=1482184792;let b=i(u,f);for(s=0,a=d.length-3;s<a;s+=4)b=b-m+i(d,s)|0;s<d.length&&(b=b-m+i(d+"XXX",s)|0),u=n(u,f,4,Dc(b));const g=`url(data:font/opentype;base64,${btoa(u)});`,y=`@font-face {font-family:"${d}";src:${g}}`;this.insertRule(y);const x=this._document.createElement("div");x.style.visibility="hidden",x.style.width=x.style.height="10px",x.style.position="absolute",x.style.top=x.style.left="0px";for(const w of[t.loadedName,d]){const v=this._document.createElement("span");v.textContent="Hi",v.style.fontFamily=w,x.append(v)}this._document.body.append(x),h(d,()=>{x.remove(),e.complete()})}}class Jc{constructor(t,{disableFontFace:e=!1,inspectFont:i=null}){this.compiledGlyphs=Object.create(null);for(const n in t)this[n]=t[n];this.disableFontFace=e===!0,this._inspectFont=i}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=La(this.data),e=`url(data:${this.mimetype};base64,${btoa(t)});`;let i;if(!this.cssFontInfo)i=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let n=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(n+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),i=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${n}src:${e}}`}return this._inspectFont?.(this,e),i}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];let i;try{i=t.get(this.loadedName+"_path_"+e)}catch(s){ct(`getPathGenerator - ignoring character: "${s}".`)}if(!Array.isArray(i)||i.length===0)return this.compiledGlyphs[e]=function(s,a){};const n=[];for(let s=0,a=i.length;s<a;)switch(i[s++]){case ee.BEZIER_CURVE_TO:{const[o,l,c,h,d,u]=i.slice(s,s+6);n.push(p=>p.bezierCurveTo(o,l,c,h,d,u)),s+=6}break;case ee.MOVE_TO:{const[o,l]=i.slice(s,s+2);n.push(c=>c.moveTo(o,l)),s+=2}break;case ee.LINE_TO:{const[o,l]=i.slice(s,s+2);n.push(c=>c.lineTo(o,l)),s+=2}break;case ee.QUADRATIC_CURVE_TO:{const[o,l,c,h]=i.slice(s,s+4);n.push(d=>d.quadraticCurveTo(o,l,c,h)),s+=4}break;case ee.RESTORE:n.push(o=>o.restore());break;case ee.SAVE:n.push(o=>o.save());break;case ee.SCALE:St(n.length===2,"Scale command is only valid at the third position.");break;case ee.TRANSFORM:{const[o,l,c,h,d,u]=i.slice(s,s+6);n.push(p=>p.transform(o,l,c,h,d,u)),s+=6}break;case ee.TRANSLATE:{const[o,l]=i.slice(s,s+2);n.push(c=>c.translate(o,l)),s+=2}break}return this.compiledGlyphs[e]=function(a,o){n[0](a),n[1](a),a.scale(o,-o);for(let l=2,c=n.length;l<c;l++)n[l](a)}}}if(Mt){var Dn=Promise.withResolvers(),Fn=null;(async()=>{const t=await fi(()=>import("./app-XseEcuwc.js").then(o=>o.h),__vite__mapDeps([0,1])),e=await fi(()=>import("./app-XseEcuwc.js").then(o=>o.h),__vite__mapDeps([0,1])),i=await fi(()=>import("./app-XseEcuwc.js").then(o=>o.h),__vite__mapDeps([0,1])),n=await fi(()=>import("./app-XseEcuwc.js").then(o=>o.h),__vite__mapDeps([0,1]));let s,a;return new Map(Object.entries({fs:t,http:e,https:i,url:n,canvas:s,path2d:a}))})().then(t=>{Fn=t,Dn.resolve()},t=>{ct(`loadPackages: ${t}`),Fn=new Map,Dn.resolve()})}class Jt{static get promise(){return Dn.promise}static get(t){return Fn?.get(t)}}const Ba=function(r){return Jt.get("fs").promises.readFile(r).then(e=>new Uint8Array(e))};class th extends Ki{}class eh extends Zi{_createCanvas(t,e){return Jt.get("canvas").createCanvas(t,e)}}class ih extends Qi{_fetchData(t,e){return Ba(t).then(i=>({cMapData:i,compressionType:e}))}}class nh extends Ji{_fetchData(t){return Ba(t)}}const Ot={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Nn(r,t){if(!t)return;const e=t[2]-t[0],i=t[3]-t[1],n=new Path2D;n.rect(t[0],t[1],e,i),r.clip(n)}class hi{constructor(){this.constructor===hi&&gt("Cannot initialize BaseShadingPattern.")}getPattern(){gt("Abstract method `getPattern` called.")}}class sh extends hi{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;this._type==="axial"?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const i of this._colorStops)e.addColorStop(i[0],i[1]);return e}getPattern(t,e,i,n){let s;if(n===Ot.STROKE||n===Ot.FILL){const a=e.current.getClippedPathBoundingBox(n,vt(t))||[0,0,0,0],o=Math.ceil(a[2]-a[0])||1,l=Math.ceil(a[3]-a[1])||1,c=e.cachedCanvases.getCanvas("pattern",o,l,!0),h=c.context;h.clearRect(0,0,h.canvas.width,h.canvas.height),h.beginPath(),h.rect(0,0,h.canvas.width,h.canvas.height),h.translate(-a[0],-a[1]),i=q.transform(i,[1,0,0,1,a[0],a[1]]),h.transform(...e.baseTransform),this.matrix&&h.transform(...this.matrix),Nn(h,this._bbox),h.fillStyle=this._createGradient(h),h.fill(),s=t.createPattern(c.canvas,"no-repeat");const d=new DOMMatrix(i);s.setTransform(d)}else Nn(t,this._bbox),s=this._createGradient(t);return s}}function vn(r,t,e,i,n,s,a,o){const l=t.coords,c=t.colors,h=r.data,d=r.width*4;let u;l[e+1]>l[i+1]&&(u=e,e=i,i=u,u=s,s=a,a=u),l[i+1]>l[n+1]&&(u=i,i=n,n=u,u=a,a=o,o=u),l[e+1]>l[i+1]&&(u=e,e=i,i=u,u=s,s=a,a=u);const p=(l[e]+t.offsetX)*t.scaleX,f=(l[e+1]+t.offsetY)*t.scaleY,m=(l[i]+t.offsetX)*t.scaleX,b=(l[i+1]+t.offsetY)*t.scaleY,g=(l[n]+t.offsetX)*t.scaleX,y=(l[n+1]+t.offsetY)*t.scaleY;if(f>=y)return;const x=c[s],w=c[s+1],v=c[s+2],R=c[a],I=c[a+1],j=c[a+2],H=c[o],z=c[o+1],D=c[o+2],$=Math.round(f),W=Math.round(y);let Y,G,J,F,_,A,C,O;for(let S=$;S<=W;S++){if(S<b){const N=S<f?0:(f-S)/(f-b);Y=p-(p-m)*N,G=x-(x-R)*N,J=w-(w-I)*N,F=v-(v-j)*N}else{let N;S>y?N=1:b===y?N=0:N=(b-S)/(b-y),Y=m-(m-g)*N,G=R-(R-H)*N,J=I-(I-z)*N,F=j-(j-D)*N}let T;S<f?T=0:S>y?T=1:T=(f-S)/(f-y),_=p-(p-g)*T,A=x-(x-H)*T,C=w-(w-z)*T,O=v-(v-D)*T;const L=Math.round(Math.min(Y,_)),U=Math.round(Math.max(Y,_));let E=d*S+L*4;for(let N=L;N<=U;N++)T=(Y-N)/(Y-_),T<0?T=0:T>1&&(T=1),h[E++]=G-(G-A)*T|0,h[E++]=J-(J-C)*T|0,h[E++]=F-(F-O)*T|0,h[E++]=255}}function rh(r,t,e){const i=t.coords,n=t.colors;let s,a;switch(t.type){case"lattice":const o=t.verticesPerRow,l=Math.floor(i.length/o)-1,c=o-1;for(s=0;s<l;s++){let h=s*o;for(let d=0;d<c;d++,h++)vn(r,e,i[h],i[h+1],i[h+o],n[h],n[h+1],n[h+o]),vn(r,e,i[h+o+1],i[h+1],i[h+o],n[h+o+1],n[h+1],n[h+o])}break;case"triangles":for(s=0,a=i.length;s<a;s+=3)vn(r,e,i[s],i[s+1],i[s+2],n[s],n[s+1],n[s+2]);break;default:throw new Error("illegal figure")}}class ah extends hi{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[7],this._background=t[8],this.matrix=null}_createMeshCanvas(t,e,i){const o=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),c=Math.ceil(this._bounds[2])-o,h=Math.ceil(this._bounds[3])-l,d=Math.min(Math.ceil(Math.abs(c*t[0]*1.1)),3e3),u=Math.min(Math.ceil(Math.abs(h*t[1]*1.1)),3e3),p=c/d,f=h/u,m={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-l,scaleX:1/p,scaleY:1/f},b=d+4,g=u+4,y=i.getCanvas("mesh",b,g,!1),x=y.context,w=x.createImageData(d,u);if(e){const R=w.data;for(let I=0,j=R.length;I<j;I+=4)R[I]=e[0],R[I+1]=e[1],R[I+2]=e[2],R[I+3]=255}for(const R of this._figures)rh(w,R,m);return x.putImageData(w,2,2),{canvas:y.canvas,offsetX:o-2*p,offsetY:l-2*f,scaleX:p,scaleY:f}}getPattern(t,e,i,n){Nn(t,this._bbox);let s;if(n===Ot.SHADING)s=q.singularValueDecompose2dScale(vt(t));else if(s=q.singularValueDecompose2dScale(e.baseTransform),this.matrix){const o=q.singularValueDecompose2dScale(this.matrix);s=[s[0]*o[0],s[1]*o[1]]}const a=this._createMeshCanvas(s,n===Ot.SHADING?null:this._background,e.cachedCanvases);return n!==Ot.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(a.offsetX,a.offsetY),t.scale(a.scaleX,a.scaleY),t.createPattern(a.canvas,"no-repeat")}}class oh extends hi{getPattern(){return"hotpink"}}function lh(r){switch(r[0]){case"RadialAxial":return new sh(r);case"Mesh":return new ah(r);case"Dummy":return new oh}throw new Error(`Unknown IR type: ${r[0]}`)}const lr={COLORED:1,UNCOLORED:2};class ls{static MAX_PATTERN_SIZE=3e3;constructor(t,e,i,n,s){this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.color=e,this.ctx=i,this.canvasGraphicsFactory=n,this.baseTransform=s}createPatternCanvas(t){const e=this.operatorList,i=this.bbox,n=this.xstep,s=this.ystep,a=this.paintType,o=this.tilingType,l=this.color,c=this.canvasGraphicsFactory;Yi("TilingType: "+o);const h=i[0],d=i[1],u=i[2],p=i[3],f=q.singularValueDecompose2dScale(this.matrix),m=q.singularValueDecompose2dScale(this.baseTransform),b=[f[0]*m[0],f[1]*m[1]],g=this.getSizeAndScale(n,this.ctx.canvas.width,b[0]),y=this.getSizeAndScale(s,this.ctx.canvas.height,b[1]),x=t.cachedCanvases.getCanvas("pattern",g.size,y.size,!0),w=x.context,v=c.createCanvasGraphics(w);v.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(v,a,l);let R=h,I=d,j=u,H=p;return h<0&&(R=0,j+=Math.abs(h)),d<0&&(I=0,H+=Math.abs(d)),w.translate(-(g.scale*R),-(y.scale*I)),v.transform(g.scale,0,0,y.scale,0,0),w.save(),this.clipBbox(v,R,I,j,H),v.baseTransform=vt(v.ctx),v.executeOperatorList(e),v.endDrawing(),{canvas:x.canvas,scaleX:g.scale,scaleY:y.scale,offsetX:R,offsetY:I}}getSizeAndScale(t,e,i){t=Math.abs(t);const n=Math.max(ls.MAX_PATTERN_SIZE,e);let s=Math.ceil(t*i);return s>=n?s=n:i=s/t,{scale:i,size:s}}clipBbox(t,e,i,n,s){const a=n-e,o=s-i;t.ctx.rect(e,i,a,o),t.current.updateRectMinMax(vt(t.ctx),[e,i,n,s]),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,i){const n=t.ctx,s=t.current;switch(e){case lr.COLORED:const a=this.ctx;n.fillStyle=a.fillStyle,n.strokeStyle=a.strokeStyle,s.fillColor=a.fillStyle,s.strokeColor=a.strokeStyle;break;case lr.UNCOLORED:const o=q.makeHexColor(i[0],i[1],i[2]);n.fillStyle=o,n.strokeStyle=o,s.fillColor=o,s.strokeColor=o;break;default:throw new Oc(`Unsupported paint type: ${e}`)}}getPattern(t,e,i,n){let s=i;n!==Ot.SHADING&&(s=q.transform(s,e.baseTransform),this.matrix&&(s=q.transform(s,this.matrix)));const a=this.createPatternCanvas(e);let o=new DOMMatrix(s);o=o.translate(a.offsetX,a.offsetY),o=o.scale(1/a.scaleX,1/a.scaleY);const l=t.createPattern(a.canvas,"repeat");return l.setTransform(o),l}}function ch({src:r,srcPos:t=0,dest:e,width:i,height:n,nonBlackColor:s=4294967295,inverseDecode:a=!1}){const o=Bt.isLittleEndian?4278190080:255,[l,c]=a?[s,o]:[o,s],h=i>>3,d=i&7,u=r.length;e=new Uint32Array(e.buffer);let p=0;for(let f=0;f<n;f++){for(const b=t+h;t<b;t++){const g=t<u?r[t]:255;e[p++]=g&128?c:l,e[p++]=g&64?c:l,e[p++]=g&32?c:l,e[p++]=g&16?c:l,e[p++]=g&8?c:l,e[p++]=g&4?c:l,e[p++]=g&2?c:l,e[p++]=g&1?c:l}if(d===0)continue;const m=t<u?r[t++]:255;for(let b=0;b<d;b++)e[p++]=m&1<<7-b?c:l}return{srcPos:t,destPos:p}}const cr=16,hr=100,hh=15,dr=10,ur=1e3,Ft=16;function dh(r,t){if(r._removeMirroring)throw new Error("Context is already forwarding operations.");r.__originalSave=r.save,r.__originalRestore=r.restore,r.__originalRotate=r.rotate,r.__originalScale=r.scale,r.__originalTranslate=r.translate,r.__originalTransform=r.transform,r.__originalSetTransform=r.setTransform,r.__originalResetTransform=r.resetTransform,r.__originalClip=r.clip,r.__originalMoveTo=r.moveTo,r.__originalLineTo=r.lineTo,r.__originalBezierCurveTo=r.bezierCurveTo,r.__originalRect=r.rect,r.__originalClosePath=r.closePath,r.__originalBeginPath=r.beginPath,r._removeMirroring=()=>{r.save=r.__originalSave,r.restore=r.__originalRestore,r.rotate=r.__originalRotate,r.scale=r.__originalScale,r.translate=r.__originalTranslate,r.transform=r.__originalTransform,r.setTransform=r.__originalSetTransform,r.resetTransform=r.__originalResetTransform,r.clip=r.__originalClip,r.moveTo=r.__originalMoveTo,r.lineTo=r.__originalLineTo,r.bezierCurveTo=r.__originalBezierCurveTo,r.rect=r.__originalRect,r.closePath=r.__originalClosePath,r.beginPath=r.__originalBeginPath,delete r._removeMirroring},r.save=function(){t.save(),this.__originalSave()},r.restore=function(){t.restore(),this.__originalRestore()},r.translate=function(i,n){t.translate(i,n),this.__originalTranslate(i,n)},r.scale=function(i,n){t.scale(i,n),this.__originalScale(i,n)},r.transform=function(i,n,s,a,o,l){t.transform(i,n,s,a,o,l),this.__originalTransform(i,n,s,a,o,l)},r.setTransform=function(i,n,s,a,o,l){t.setTransform(i,n,s,a,o,l),this.__originalSetTransform(i,n,s,a,o,l)},r.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},r.rotate=function(i){t.rotate(i),this.__originalRotate(i)},r.clip=function(i){t.clip(i),this.__originalClip(i)},r.moveTo=function(e,i){t.moveTo(e,i),this.__originalMoveTo(e,i)},r.lineTo=function(e,i){t.lineTo(e,i),this.__originalLineTo(e,i)},r.bezierCurveTo=function(e,i,n,s,a,o){t.bezierCurveTo(e,i,n,s,a,o),this.__originalBezierCurveTo(e,i,n,s,a,o)},r.rect=function(e,i,n,s){t.rect(e,i,n,s),this.__originalRect(e,i,n,s)},r.closePath=function(){t.closePath(),this.__originalClosePath()},r.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class uh{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,i){let n;return this.cache[t]!==void 0?(n=this.cache[t],this.canvasFactory.reset(n,e,i)):(n=this.canvasFactory.create(e,i),this.cache[t]=n),n}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function bi(r,t,e,i,n,s,a,o,l,c){const[h,d,u,p,f,m]=vt(r);if(d===0&&u===0){const y=a*h+f,x=Math.round(y),w=o*p+m,v=Math.round(w),R=(a+l)*h+f,I=Math.abs(Math.round(R)-x)||1,j=(o+c)*p+m,H=Math.abs(Math.round(j)-v)||1;return r.setTransform(Math.sign(h),0,0,Math.sign(p),x,v),r.drawImage(t,e,i,n,s,0,0,I,H),r.setTransform(h,d,u,p,f,m),[I,H]}if(h===0&&p===0){const y=o*u+f,x=Math.round(y),w=a*d+m,v=Math.round(w),R=(o+c)*u+f,I=Math.abs(Math.round(R)-x)||1,j=(a+l)*d+m,H=Math.abs(Math.round(j)-v)||1;return r.setTransform(0,Math.sign(d),Math.sign(u),0,x,v),r.drawImage(t,e,i,n,s,0,0,H,I),r.setTransform(h,d,u,p,f,m),[H,I]}r.drawImage(t,e,i,n,s,a,o,l,c);const b=Math.hypot(h,d),g=Math.hypot(u,p);return[b*l,g*c]}function fh(r){const{width:t,height:e}=r;if(t>ur||e>ur)return null;const i=1e3,n=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),s=t+1;let a=new Uint8Array(s*(e+1)),o,l,c;const h=t+7&-8;let d=new Uint8Array(h*e),u=0;for(const g of r.data){let y=128;for(;y>0;)d[u++]=g&y?0:255,y>>=1}let p=0;for(u=0,d[u]!==0&&(a[0]=1,++p),l=1;l<t;l++)d[u]!==d[u+1]&&(a[l]=d[u]?2:1,++p),u++;for(d[u]!==0&&(a[l]=2,++p),o=1;o<e;o++){u=o*h,c=o*s,d[u-h]!==d[u]&&(a[c]=d[u]?1:8,++p);let g=(d[u]?4:0)+(d[u-h]?8:0);for(l=1;l<t;l++)g=(g>>2)+(d[u+1]?4:0)+(d[u-h+1]?8:0),n[g]&&(a[c+l]=n[g],++p),u++;if(d[u-h]!==d[u]&&(a[c+l]=d[u]?2:4,++p),p>i)return null}for(u=h*(e-1),c=o*s,d[u]!==0&&(a[c]=8,++p),l=1;l<t;l++)d[u]!==d[u+1]&&(a[c+l]=d[u]?4:8,++p),u++;if(d[u]!==0&&(a[c+l]=4,++p),p>i)return null;const f=new Int32Array([0,s,-1,0,-s,0,0,0,1]),m=new Path2D;for(o=0;p&&o<=e;o++){let g=o*s;const y=g+t;for(;g<y&&!a[g];)g++;if(g===y)continue;m.moveTo(g%s,o);const x=g;let w=a[g];do{const v=f[w];do g+=v;while(!a[g]);const R=a[g];R!==5&&R!==10?(w=R,a[g]=0):(w=R&51*w>>4,a[g]&=w>>2|w<<2),m.lineTo(g%s,g/s|0),a[g]||--p}while(x!==g);--o}return d=null,a=null,function(g){g.save(),g.scale(1/t,-1/e),g.translate(0,-e),g.fill(m),g.beginPath(),g.restore()}}class fr{constructor(t,e){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=Pa,this.textMatrixScale=1,this.fontMatrix=Ln,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=Rt.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,t,e])}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t}setCurrentPoint(t,e){this.x=t,this.y=e}updatePathMinMax(t,e,i){[e,i]=q.applyTransform([e,i],t),this.minX=Math.min(this.minX,e),this.minY=Math.min(this.minY,i),this.maxX=Math.max(this.maxX,e),this.maxY=Math.max(this.maxY,i)}updateRectMinMax(t,e){const i=q.applyTransform(e,t),n=q.applyTransform(e.slice(2),t),s=q.applyTransform([e[0],e[3]],t),a=q.applyTransform([e[2],e[1]],t);this.minX=Math.min(this.minX,i[0],n[0],s[0],a[0]),this.minY=Math.min(this.minY,i[1],n[1],s[1],a[1]),this.maxX=Math.max(this.maxX,i[0],n[0],s[0],a[0]),this.maxY=Math.max(this.maxY,i[1],n[1],s[1],a[1])}updateScalingPathMinMax(t,e){q.scaleMinMax(t,e),this.minX=Math.min(this.minX,e[0]),this.minY=Math.min(this.minY,e[1]),this.maxX=Math.max(this.maxX,e[2]),this.maxY=Math.max(this.maxY,e[3])}updateCurvePathMinMax(t,e,i,n,s,a,o,l,c,h){const d=q.bezierBoundingBox(e,i,n,s,a,o,l,c,h);h||this.updateRectMinMax(t,d)}getPathBoundingBox(t=Ot.FILL,e=null){const i=[this.minX,this.minY,this.maxX,this.maxY];if(t===Ot.STROKE){e||gt("Stroke bounding box must include transform.");const n=q.singularValueDecompose2dScale(e),s=n[0]*this.lineWidth/2,a=n[1]*this.lineWidth/2;i[0]-=s,i[1]-=a,i[2]+=s,i[3]+=a}return i}updateClipFromPath(){const t=q.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(t){this.clipBox=t,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(t=Ot.FILL,e=null){return q.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function pr(r,t){if(typeof ImageData<"u"&&t instanceof ImageData){r.putImageData(t,0,0);return}const e=t.height,i=t.width,n=e%Ft,s=(e-n)/Ft,a=n===0?s:s+1,o=r.createImageData(i,Ft);let l=0,c;const h=t.data,d=o.data;let u,p,f,m;if(t.kind===Ti.GRAYSCALE_1BPP){const b=h.byteLength,g=new Uint32Array(d.buffer,0,d.byteLength>>2),y=g.length,x=i+7>>3,w=4294967295,v=Bt.isLittleEndian?4278190080:255;for(u=0;u<a;u++){for(f=u<s?Ft:n,c=0,p=0;p<f;p++){const R=b-l;let I=0;const j=R>x?i:R*8-7,H=j&-8;let z=0,D=0;for(;I<H;I+=8)D=h[l++],g[c++]=D&128?w:v,g[c++]=D&64?w:v,g[c++]=D&32?w:v,g[c++]=D&16?w:v,g[c++]=D&8?w:v,g[c++]=D&4?w:v,g[c++]=D&2?w:v,g[c++]=D&1?w:v;for(;I<j;I++)z===0&&(D=h[l++],z=128),g[c++]=D&z?w:v,z>>=1}for(;c<y;)g[c++]=0;r.putImageData(o,0,u*Ft)}}else if(t.kind===Ti.RGBA_32BPP){for(p=0,m=i*Ft*4,u=0;u<s;u++)d.set(h.subarray(l,l+m)),l+=m,r.putImageData(o,0,p),p+=Ft;u<a&&(m=i*n*4,d.set(h.subarray(l,l+m)),r.putImageData(o,0,p))}else if(t.kind===Ti.RGB_24BPP)for(f=Ft,m=i*f,u=0;u<a;u++){for(u>=s&&(f=n,m=i*f),c=0,p=m;p--;)d[c++]=h[l++],d[c++]=h[l++],d[c++]=h[l++],d[c++]=255;r.putImageData(o,0,u*Ft)}else throw new Error(`bad image kind: ${t.kind}`)}function gr(r,t){if(t.bitmap){r.drawImage(t.bitmap,0,0);return}const e=t.height,i=t.width,n=e%Ft,s=(e-n)/Ft,a=n===0?s:s+1,o=r.createImageData(i,Ft);let l=0;const c=t.data,h=o.data;for(let d=0;d<a;d++){const u=d<s?Ft:n;({srcPos:l}=ch({src:c,srcPos:l,dest:h,width:i,height:u,nonBlackColor:0})),r.putImageData(o,0,d*Ft)}}function Qe(r,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of e)r[i]!==void 0&&(t[i]=r[i]);r.setLineDash!==void 0&&(t.setLineDash(r.getLineDash()),t.lineDashOffset=r.lineDashOffset)}function vi(r){if(r.strokeStyle=r.fillStyle="#000000",r.fillRule="nonzero",r.globalAlpha=1,r.lineWidth=1,r.lineCap="butt",r.lineJoin="miter",r.miterLimit=10,r.globalCompositeOperation="source-over",r.font="10px sans-serif",r.setLineDash!==void 0&&(r.setLineDash([]),r.lineDashOffset=0),!Mt){const{filter:t}=r;t!=="none"&&t!==""&&(r.filter="none")}}function mr(r,t){if(t)return!0;const e=q.singularValueDecompose2dScale(r);e[0]=Math.fround(e[0]),e[1]=Math.fround(e[1]);const i=Math.fround((globalThis.devicePixelRatio||1)*ze.PDF_TO_CSS_UNITS);return e[0]<=i&&e[1]<=i}const ph=["butt","round","square"],gh=["miter","round","bevel"],mh={},br={};class Ne{constructor(t,e,i,n,s,{optionalContentConfig:a,markedContentStack:o=null},l,c){this.ctx=t,this.current=new fr(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=i,this.canvasFactory=n,this.filterFactory=s,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=a,this.cachedCanvases=new uh(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=c,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(t,e=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):e}beginDrawing({transform:t,viewport:e,transparency:i=!1,background:n=null}){const s=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=n||"#ffffff",this.ctx.fillRect(0,0,s,a),this.ctx.fillStyle=o,i){const l=this.cachedCanvases.getCanvas("transparent",s,a);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...vt(this.compositeCtx))}this.ctx.save(),vi(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=vt(this.ctx)}executeOperatorList(t,e,i,n){const s=t.argsArray,a=t.fnArray;let o=e||0;const l=s.length;if(l===o)return o;const c=l-o>dr&&typeof i=="function",h=c?Date.now()+hh:0;let d=0;const u=this.commonObjs,p=this.objs;let f;for(;;){if(n!==void 0&&o===n.nextBreakPoint)return n.breakIt(o,i),o;if(f=a[o],f!==Yt.dependency)this[f].apply(this,s[o]);else for(const m of s[o]){const b=m.startsWith("g_")?u:p;if(!b.has(m))return b.get(m,i),o}if(o++,o===l)return o;if(c&&++d>dr){if(Date.now()>h)return i(),o;d=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}}_scaleImage(t,e){const i=t.width,n=t.height;let s=Math.max(Math.hypot(e[0],e[1]),1),a=Math.max(Math.hypot(e[2],e[3]),1),o=i,l=n,c="prescale1",h,d;for(;s>2&&o>1||a>2&&l>1;){let u=o,p=l;s>2&&o>1&&(u=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),s/=o/u),a>2&&l>1&&(p=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,a/=l/p),h=this.cachedCanvases.getCanvas(c,u,p),d=h.context,d.clearRect(0,0,u,p),d.drawImage(t,0,0,o,l,0,0,u,p),t=h.canvas,o=u,l=p,c=c==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:o,paintHeight:l}}_createMaskCanvas(t){const e=this.ctx,{width:i,height:n}=t,s=this.current.fillColor,a=this.current.patternFill,o=vt(e);let l,c,h,d;if((t.bitmap||t.data)&&t.count>1){const j=t.bitmap||t.data.buffer;c=JSON.stringify(a?o:[o.slice(0,4),s]),l=this._cachedBitmapsMap.get(j),l||(l=new Map,this._cachedBitmapsMap.set(j,l));const H=l.get(c);if(H&&!a){const z=Math.round(Math.min(o[0],o[2])+o[4]),D=Math.round(Math.min(o[1],o[3])+o[5]);return{canvas:H,offsetX:z,offsetY:D}}h=H}h||(d=this.cachedCanvases.getCanvas("maskCanvas",i,n),gr(d.context,t));let u=q.transform(o,[1/i,0,0,-1/n,0,0]);u=q.transform(u,[1,0,0,1,0,-n]);const[p,f,m,b]=q.getAxialAlignedBoundingBox([0,0,i,n],u),g=Math.round(m-p)||1,y=Math.round(b-f)||1,x=this.cachedCanvases.getCanvas("fillCanvas",g,y),w=x.context,v=p,R=f;w.translate(-v,-R),w.transform(...u),h||(h=this._scaleImage(d.canvas,ie(w)),h=h.img,l&&a&&l.set(c,h)),w.imageSmoothingEnabled=mr(vt(w),t.interpolate),bi(w,h,0,0,h.width,h.height,0,0,i,n),w.globalCompositeOperation="source-in";const I=q.transform(ie(w),[1,0,0,1,-v,-R]);return w.fillStyle=a?s.getPattern(e,this,I,Ot.FILL):s,w.fillRect(0,0,i,n),l&&!a&&(this.cachedCanvases.delete("fillCanvas"),l.set(c,x.canvas)),{canvas:x.canvas,offsetX:Math.round(v),offsetY:Math.round(R)}}setLineWidth(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=ph[t]}setLineJoin(t){this.ctx.lineJoin=gh[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,e){const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(t),i.lineDashOffset=e)}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[e,i]of t)switch(e){case"LW":this.setLineWidth(i);break;case"LC":this.setLineCap(i);break;case"LJ":this.setLineJoin(i);break;case"ML":this.setMiterLimit(i);break;case"D":this.setDash(i[0],i[1]);break;case"RI":this.setRenderingIntent(i);break;case"FL":this.setFlatness(i);break;case"Font":this.setFont(i[0],i[1]);break;case"CA":this.current.strokeAlpha=i;break;case"ca":this.current.fillAlpha=i,this.ctx.globalAlpha=i;break;case"BM":this.ctx.globalCompositeOperation=i;break;case"SMask":this.current.activeSMask=i?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(i);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,e=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,n=this.cachedCanvases.getCanvas(i,t,e);this.suspendedCtx=this.ctx,this.ctx=n.context;const s=this.ctx;s.setTransform(...vt(this.suspendedCtx)),Qe(this.suspendedCtx,s),dh(s,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Qe(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,i,n){const s=n[0],a=n[1],o=n[2]-s,l=n[3]-a;o===0||l===0||(this.genericComposeSMask(e.context,i,o,l,e.subtype,e.backdrop,e.transferMap,s,a,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(i.canvas,0,0),t.restore())}genericComposeSMask(t,e,i,n,s,a,o,l,c,h,d){let u=t.canvas,p=l-h,f=c-d;if(a){if(p<0||f<0||p+i>u.width||f+n>u.height){const b=this.cachedCanvases.getCanvas("maskExtension",i,n),g=b.context;g.drawImage(u,-p,-f),a.some(y=>y!==0)&&(g.globalCompositeOperation="destination-atop",g.fillStyle=q.makeHexColor(...a),g.fillRect(0,0,i,n),g.globalCompositeOperation="source-over"),u=b.canvas,p=f=0}else if(a.some(b=>b!==0)){t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const b=new Path2D;b.rect(p,f,i,n),t.clip(b),t.globalCompositeOperation="destination-atop",t.fillStyle=q.makeHexColor(...a),t.fillRect(p,f,i,n),t.restore()}}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),s==="Alpha"&&o?e.filter=this.filterFactory.addAlphaFilter(o):s==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(o));const m=new Path2D;m.rect(l,c,i,n),e.clip(m),e.globalCompositeOperation="destination-in",e.drawImage(u,p,f,i,n,l,c,i,n),e.restore()}save(){this.inSMaskMode?(Qe(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Qe(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(t,e,i,n,s,a){this.ctx.transform(t,e,i,n,s,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,i){const n=this.ctx,s=this.current;let a=s.x,o=s.y,l,c;const h=vt(n),d=h[0]===0&&h[3]===0||h[1]===0&&h[2]===0,u=d?i.slice(0):null;for(let p=0,f=0,m=t.length;p<m;p++)switch(t[p]|0){case Yt.rectangle:a=e[f++],o=e[f++];const b=e[f++],g=e[f++],y=a+b,x=o+g;n.moveTo(a,o),b===0||g===0?n.lineTo(y,x):(n.lineTo(y,o),n.lineTo(y,x),n.lineTo(a,x)),d||s.updateRectMinMax(h,[a,o,y,x]),n.closePath();break;case Yt.moveTo:a=e[f++],o=e[f++],n.moveTo(a,o),d||s.updatePathMinMax(h,a,o);break;case Yt.lineTo:a=e[f++],o=e[f++],n.lineTo(a,o),d||s.updatePathMinMax(h,a,o);break;case Yt.curveTo:l=a,c=o,a=e[f+4],o=e[f+5],n.bezierCurveTo(e[f],e[f+1],e[f+2],e[f+3],a,o),s.updateCurvePathMinMax(h,l,c,e[f],e[f+1],e[f+2],e[f+3],a,o,u),f+=6;break;case Yt.curveTo2:l=a,c=o,n.bezierCurveTo(a,o,e[f],e[f+1],e[f+2],e[f+3]),s.updateCurvePathMinMax(h,l,c,a,o,e[f],e[f+1],e[f+2],e[f+3],u),a=e[f+2],o=e[f+3],f+=4;break;case Yt.curveTo3:l=a,c=o,a=e[f+2],o=e[f+3],n.bezierCurveTo(e[f],e[f+1],a,o,a,o),s.updateCurvePathMinMax(h,l,c,e[f],e[f+1],a,o,a,o,u),f+=4;break;case Yt.closePath:n.closePath();break}d&&s.updateScalingPathMinMax(h,u),s.setCurrentPoint(a,o)}closePath(){this.ctx.closePath()}stroke(t=!0){const e=this.ctx,i=this.current.strokeColor;e.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof i=="object"&&i?.getPattern?(e.save(),e.strokeStyle=i.getPattern(e,this,ie(e),Ot.STROKE),this.rescaleAndStroke(!1),e.restore()):this.rescaleAndStroke(!0)),t&&this.consumePath(this.current.getClippedPathBoundingBox()),e.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(t=!0){const e=this.ctx,i=this.current.fillColor,n=this.current.patternFill;let s=!1;n&&(e.save(),e.fillStyle=i.getPattern(e,this,ie(e),Ot.FILL),s=!0);const a=this.current.getClippedPathBoundingBox();this.contentVisible&&a!==null&&(this.pendingEOFill?(e.fill("evenodd"),this.pendingEOFill=!1):e.fill()),s&&e.restore(),t&&this.consumePath(a)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=mh}eoClip(){this.pendingClip=br}beginText(){this.current.textMatrix=Pa,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,e=this.ctx;if(t===void 0){e.beginPath();return}e.save(),e.beginPath();for(const i of t)e.setTransform(...i.transform),e.translate(i.x,i.y),i.addToPath(e,i.fontSize);e.restore(),e.clip(),e.beginPath(),delete this.pendingTextPaths}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,e){const i=this.commonObjs.get(t),n=this.current;if(!i)throw new Error(`Can't find font for ${t}`);if(n.fontMatrix=i.fontMatrix||Ln,(n.fontMatrix[0]===0||n.fontMatrix[3]===0)&&ct("Invalid font matrix for font "+t),e<0?(e=-e,n.fontDirection=-1):n.fontDirection=1,this.current.font=i,this.current.fontSize=e,i.isType3Font)return;const s=i.loadedName||"sans-serif",a=i.systemFontInfo?.css||`"${s}", ${i.fallbackName}`;let o="normal";i.black?o="900":i.bold&&(o="bold");const l=i.italic?"italic":"normal";let c=e;e<cr?c=cr:e>hr&&(c=hr),this.current.fontSizeScale=e/c,this.ctx.font=`${l} ${o} ${c}px ${a}`}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,e){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=e}setLeadingMoveText(t,e){this.setLeading(-e),this.moveText(t,e)}setTextMatrix(t,e,i,n,s,a){this.current.textMatrix=[t,e,i,n,s,a],this.current.textMatrixScale=Math.hypot(t,e),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(t,e,i,n){const s=this.ctx,a=this.current,o=a.font,l=a.textRenderingMode,c=a.fontSize/a.fontSizeScale,h=l&Rt.FILL_STROKE_MASK,d=!!(l&Rt.ADD_TO_PATH_FLAG),u=a.patternFill&&!o.missingFile;let p;(o.disableFontFace||d||u)&&(p=o.getPathGenerator(this.commonObjs,t)),o.disableFontFace||u?(s.save(),s.translate(e,i),s.beginPath(),p(s,c),n&&s.setTransform(...n),(h===Rt.FILL||h===Rt.FILL_STROKE)&&s.fill(),(h===Rt.STROKE||h===Rt.FILL_STROKE)&&s.stroke(),s.restore()):((h===Rt.FILL||h===Rt.FILL_STROKE)&&s.fillText(t,e,i),(h===Rt.STROKE||h===Rt.FILL_STROKE)&&s.strokeText(t,e,i)),d&&(this.pendingTextPaths||=[]).push({transform:vt(s),x:e,y:i,fontSize:c,addToPath:p})}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let i=!1;for(let n=3;n<e.length;n+=4)if(e[n]>0&&e[n]<255){i=!0;break}return ut(this,"isFontSubpixelAAEnabled",i)}showText(t){const e=this.current,i=e.font;if(i.isType3Font)return this.showType3Text(t);const n=e.fontSize;if(n===0)return;const s=this.ctx,a=e.fontSizeScale,o=e.charSpacing,l=e.wordSpacing,c=e.fontDirection,h=e.textHScale*c,d=t.length,u=i.vertical,p=u?1:-1,f=i.defaultVMetrics,m=n*e.fontMatrix[0],b=e.textRenderingMode===Rt.FILL&&!i.disableFontFace&&!e.patternFill;s.save(),s.transform(...e.textMatrix),s.translate(e.x,e.y+e.textRise),c>0?s.scale(h,-1):s.scale(h,1);let g;if(e.patternFill){s.save();const R=e.fillColor.getPattern(s,this,ie(s),Ot.FILL);g=vt(s),s.restore(),s.fillStyle=R}let y=e.lineWidth;const x=e.textMatrixScale;if(x===0||y===0){const R=e.textRenderingMode&Rt.FILL_STROKE_MASK;(R===Rt.STROKE||R===Rt.FILL_STROKE)&&(y=this.getSinglePixelWidth())}else y/=x;if(a!==1&&(s.scale(a,a),y/=a),s.lineWidth=y,i.isInvalidPDFjsFont){const R=[];let I=0;for(const j of t)R.push(j.unicode),I+=j.width;s.fillText(R.join(""),0,0),e.x+=I*m*h,s.restore(),this.compose();return}let w=0,v;for(v=0;v<d;++v){const R=t[v];if(typeof R=="number"){w+=p*R*n/1e3;continue}let I=!1;const j=(R.isSpace?l:0)+o,H=R.fontChar,z=R.accent;let D,$,W=R.width;if(u){const G=R.vmetric||f,J=-(R.vmetric?G[1]:W*.5)*m,F=G[2]*m;W=G?-G[0]:W,D=J/a,$=(w+F)/a}else D=w/a,$=0;if(i.remeasure&&W>0){const G=s.measureText(H).width*1e3/n*a;if(W<G&&this.isFontSubpixelAAEnabled){const J=W/G;I=!0,s.save(),s.scale(J,1),D/=J}else W!==G&&(D+=(W-G)/2e3*n/a)}if(this.contentVisible&&(R.isInFont||i.missingFile)){if(b&&!z)s.fillText(H,D,$);else if(this.paintChar(H,D,$,g),z){const G=D+n*z.offset.x/a,J=$-n*z.offset.y/a;this.paintChar(z.fontChar,G,J,g)}}const Y=u?W*m-j*c:W*m+j*c;w+=Y,I&&s.restore()}u?e.y-=w:e.x+=w*h,s.restore(),this.compose()}showType3Text(t){const e=this.ctx,i=this.current,n=i.font,s=i.fontSize,a=i.fontDirection,o=n.vertical?1:-1,l=i.charSpacing,c=i.wordSpacing,h=i.textHScale*a,d=i.fontMatrix||Ln,u=t.length,p=i.textRenderingMode===Rt.INVISIBLE;let f,m,b,g;if(!(p||s===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,e.save(),e.transform(...i.textMatrix),e.translate(i.x,i.y),e.scale(h,a),f=0;f<u;++f){if(m=t[f],typeof m=="number"){g=o*m*s/1e3,this.ctx.translate(g,0),i.x+=g*h;continue}const y=(m.isSpace?c:0)+l,x=n.charProcOperatorList[m.operatorListId];if(!x){ct(`Type3 character "${m.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=m,this.save(),e.scale(s,s),e.transform(...d),this.executeOperatorList(x),this.restore()),b=q.applyTransform([m.width,0],d)[0]*s+y,e.translate(b,0),i.x+=b*h}e.restore(),this.processingType3=null}}setCharWidth(t,e){}setCharWidthAndBounds(t,e,i,n,s,a){this.ctx.rect(i,n,s-i,a-n),this.ctx.clip(),this.endPath()}getColorN_Pattern(t){let e;if(t[0]==="TilingPattern"){const i=t[1],n=this.baseTransform||vt(this.ctx),s={createCanvasGraphics:a=>new Ne(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};e=new ls(t,i,this.ctx,s,n)}else e=this._getPattern(t[1],t[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(t,e,i){const n=q.makeHexColor(t,e,i);this.ctx.strokeStyle=n,this.current.strokeColor=n}setFillRGBColor(t,e,i){const n=q.makeHexColor(t,e,i);this.ctx.fillStyle=n,this.current.fillColor=n,this.current.patternFill=!1}_getPattern(t,e=null){let i;return this.cachedPatterns.has(t)?i=this.cachedPatterns.get(t):(i=lh(this.getObject(t)),this.cachedPatterns.set(t,i)),e&&(i.matrix=e),i}shadingFill(t){if(!this.contentVisible)return;const e=this.ctx;this.save();const i=this._getPattern(t);e.fillStyle=i.getPattern(e,this,ie(e),Ot.SHADING);const n=ie(e);if(n){const{width:s,height:a}=e.canvas,[o,l,c,h]=q.getAxialAlignedBoundingBox([0,0,s,a],n);this.ctx.fillRect(o,l,c-o,h-l)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){gt("Should not call beginInlineImage")}beginImageData(){gt("Should not call beginImageData")}paintFormXObjectBegin(t,e){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),t&&this.transform(...t),this.baseTransform=vt(this.ctx),e)){const i=e[2]-e[0],n=e[3]-e[1];this.ctx.rect(e[0],e[1],i,n),this.current.updateRectMinMax(vt(this.ctx),e),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const e=this.ctx;t.isolated||Yi("TODO: Support non-isolated groups."),t.knockout&&ct("Knockout groups not supported.");const i=vt(e);if(t.matrix&&e.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let n=q.getAxialAlignedBoundingBox(t.bbox,vt(e));const s=[0,0,e.canvas.width,e.canvas.height];n=q.intersect(n,s)||[0,0,0,0];const a=Math.floor(n[0]),o=Math.floor(n[1]),l=Math.max(Math.ceil(n[2])-a,1),c=Math.max(Math.ceil(n[3])-o,1);this.current.startNewPathAndClipBox([0,0,l,c]);let h="groupAt"+this.groupLevel;t.smask&&(h+="_smask_"+this.smaskCounter++%2);const d=this.cachedCanvases.getCanvas(h,l,c),u=d.context;u.translate(-a,-o),u.transform(...i),t.smask?this.smaskStack.push({canvas:d.canvas,context:u,offsetX:a,offsetY:o,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(a,o),e.save()),Qe(e,u),this.ctx=u,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,t.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const n=vt(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...n);const s=q.getAxialAlignedBoundingBox([0,0,e.canvas.width,e.canvas.height],n);this.ctx.drawImage(e.canvas,0,0),this.ctx.restore(),this.compose(s)}}beginAnnotation(t,e,i,n,s){if(this.#t(),vi(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),e){const a=e[2]-e[0],o=e[3]-e[1];if(s&&this.annotationCanvasMap){i=i.slice(),i[4]-=e[0],i[5]-=e[1],e=e.slice(),e[0]=e[1]=0,e[2]=a,e[3]=o;const[l,c]=q.singularValueDecompose2dScale(vt(this.ctx)),{viewportScale:h}=this,d=Math.ceil(a*this.outputScaleX*h),u=Math.ceil(o*this.outputScaleY*h);this.annotationCanvas=this.canvasFactory.create(d,u);const{canvas:p,context:f}=this.annotationCanvas;this.annotationCanvasMap.set(t,p),this.annotationCanvas.savedCtx=this.ctx,this.ctx=f,this.ctx.save(),this.ctx.setTransform(l,0,0,-c,0,o*c),vi(this.ctx)}else vi(this.ctx),this.ctx.rect(e[0],e[1],a,o),this.ctx.clip(),this.endPath()}this.current=new fr(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...i),this.transform(...n)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t){if(!this.contentVisible)return;const e=t.count;t=this.getObject(t.data,t),t.count=e;const i=this.ctx,n=this.processingType3;if(n&&(n.compiled===void 0&&(n.compiled=fh(t)),n.compiled)){n.compiled(i);return}const s=this._createMaskCanvas(t),a=s.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(a,s.offsetX,s.offsetY),i.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,i=0,n=0,s,a){if(!this.contentVisible)return;t=this.getObject(t.data,t);const o=this.ctx;o.save();const l=vt(o);o.transform(e,i,n,s,0,0);const c=this._createMaskCanvas(t);o.setTransform(1,0,0,1,c.offsetX-l[4],c.offsetY-l[5]);for(let h=0,d=a.length;h<d;h+=2){const u=q.transform(l,[e,i,n,s,a[h],a[h+1]]),[p,f]=q.applyTransform([0,0],u);o.drawImage(c.canvas,p,f)}o.restore(),this.compose()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const e=this.ctx,i=this.current.fillColor,n=this.current.patternFill;for(const s of t){const{data:a,width:o,height:l,transform:c}=s,h=this.cachedCanvases.getCanvas("maskCanvas",o,l),d=h.context;d.save();const u=this.getObject(a,s);gr(d,u),d.globalCompositeOperation="source-in",d.fillStyle=n?i.getPattern(d,this,ie(e),Ot.FILL):i,d.fillRect(0,0,o,l),d.restore(),e.save(),e.transform(...c),e.scale(1,-1),bi(e,h.canvas,0,0,o,l,0,-1,1,1),e.restore()}this.compose()}paintImageXObject(t){if(!this.contentVisible)return;const e=this.getObject(t);if(!e){ct("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e)}paintImageXObjectRepeat(t,e,i,n){if(!this.contentVisible)return;const s=this.getObject(t);if(!s){ct("Dependent image isn't ready yet");return}const a=s.width,o=s.height,l=[];for(let c=0,h=n.length;c<h;c+=2)l.push({transform:[e,0,0,i,n[c],n[c+1]],x:0,y:0,w:a,h:o});this.paintInlineImageXObjectGroup(s,l)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:i,height:n}=t,s=this.cachedCanvases.getCanvas("inlineImage",i,n),a=s.context;return a.filter=this.current.transferMaps,a.drawImage(e,0,0),a.filter="none",s.canvas}paintInlineImageXObject(t){if(!this.contentVisible)return;const e=t.width,i=t.height,n=this.ctx;if(this.save(),!Mt){const{filter:o}=n;o!=="none"&&o!==""&&(n.filter="none")}n.scale(1/e,-1/i);let s;if(t.bitmap)s=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)s=t;else{const l=this.cachedCanvases.getCanvas("inlineImage",e,i).context;pr(l,t),s=this.applyTransferMapsToCanvas(l)}const a=this._scaleImage(s,ie(n));n.imageSmoothingEnabled=mr(vt(n),t.interpolate),bi(n,a.img,0,0,a.paintWidth,a.paintHeight,0,-i,e,i),this.compose(),this.restore()}paintInlineImageXObjectGroup(t,e){if(!this.contentVisible)return;const i=this.ctx;let n;if(t.bitmap)n=t.bitmap;else{const s=t.width,a=t.height,l=this.cachedCanvases.getCanvas("inlineImage",s,a).context;pr(l,t),n=this.applyTransferMapsToCanvas(l)}for(const s of e)i.save(),i.transform(...s.transform),i.scale(1,-1),bi(i,n,s.x,s.y,s.w,s.h,0,-1,1,1),i.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t){}markPointProps(t,e){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e){t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(t){const e=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const i=this.ctx;this.pendingClip&&(e||(this.pendingClip===br?i.clip("evenodd"):i.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),i.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=vt(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),i=Math.hypot(t[0],t[2]),n=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(i,n)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:i,c:n,d:s}=this.ctx.getTransform();let a,o;if(i===0&&n===0){const l=Math.abs(e),c=Math.abs(s);if(l===c)if(t===0)a=o=1/l;else{const h=l*t;a=o=h<1?1/h:1}else if(t===0)a=1/l,o=1/c;else{const h=l*t,d=c*t;a=h<1?1/h:1,o=d<1?1/d:1}}else{const l=Math.abs(e*s-i*n),c=Math.hypot(e,i),h=Math.hypot(n,s);if(t===0)a=h/l,o=c/l;else{const d=t*l;a=h>d?h/d:1,o=c>d?c/d:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(t){const{ctx:e}=this,{lineWidth:i}=this.current,[n,s]=this.getScaleForStroking();if(e.lineWidth=i||1,n===1&&s===1){e.stroke();return}const a=e.getLineDash();if(t&&e.save(),e.scale(n,s),a.length>0){const o=Math.max(n,s);e.setLineDash(a.map(l=>l/o)),e.lineDashOffset/=o}e.stroke(),t&&e.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const r in Yt)Ne.prototype[r]!==void 0&&(Ne.prototype[Yt[r]]=Ne.prototype[r]);class ri{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}}const yi={DATA:1,ERROR:2},_t={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Ht(r){switch(r instanceof Error||typeof r=="object"&&r!==null||gt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),r.name){case"AbortException":return new Ce(r.message);case"MissingPDFException":return new Te(r.message);case"PasswordException":return new In(r.message,r.code);case"UnexpectedResponseException":return new qi(r.message,r.status);case"UnknownErrorException":return new Mn(r.message,r.details);default:return new Mn(r.message,r.toString())}}class ei{constructor(t,e,i){this.sourceName=t,this.targetName=e,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=n=>{const s=n.data;if(s.targetName!==this.sourceName)return;if(s.stream){this.#e(s);return}if(s.callback){const o=s.callbackId,l=this.callbackCapabilities[o];if(!l)throw new Error(`Cannot resolve callback ${o}`);if(delete this.callbackCapabilities[o],s.callback===yi.DATA)l.resolve(s.data);else if(s.callback===yi.ERROR)l.reject(Ht(s.reason));else throw new Error("Unexpected callback case");return}const a=this.actionHandler[s.action];if(!a)throw new Error(`Unknown action from worker: ${s.action}`);if(s.callbackId){const o=this.sourceName,l=s.sourceName;new Promise(function(c){c(a(s.data))}).then(function(c){i.postMessage({sourceName:o,targetName:l,callback:yi.DATA,callbackId:s.callbackId,data:c})},function(c){i.postMessage({sourceName:o,targetName:l,callback:yi.ERROR,callbackId:s.callbackId,reason:Ht(c)})});return}if(s.streamId){this.#t(s);return}a(s.data)},i.addEventListener("message",this._onComObjOnMessage)}on(t,e){const i=this.actionHandler;if(i[t])throw new Error(`There is already an actionName called "${t}"`);i[t]=e}send(t,e,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},i)}sendWithPromise(t,e,i){const n=this.callbackId++,s=Promise.withResolvers();this.callbackCapabilities[n]=s;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:n,data:e},i)}catch(a){s.reject(a)}return s.promise}sendWithStream(t,e,i,n){const s=this.streamId++,a=this.sourceName,o=this.targetName,l=this.comObj;return new ReadableStream({start:c=>{const h=Promise.withResolvers();return this.streamControllers[s]={controller:c,startCall:h,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:a,targetName:o,action:t,streamId:s,data:e,desiredSize:c.desiredSize},n),h.promise},pull:c=>{const h=Promise.withResolvers();return this.streamControllers[s].pullCall=h,l.postMessage({sourceName:a,targetName:o,stream:_t.PULL,streamId:s,desiredSize:c.desiredSize}),h.promise},cancel:c=>{St(c instanceof Error,"cancel must have a valid reason");const h=Promise.withResolvers();return this.streamControllers[s].cancelCall=h,this.streamControllers[s].isClosed=!0,l.postMessage({sourceName:a,targetName:o,stream:_t.CANCEL,streamId:s,reason:Ht(c)}),h.promise}},i)}#t(t){const e=t.streamId,i=this.sourceName,n=t.sourceName,s=this.comObj,a=this,o=this.actionHandler[t.action],l={enqueue(c,h=1,d){if(this.isCancelled)return;const u=this.desiredSize;this.desiredSize-=h,u>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),s.postMessage({sourceName:i,targetName:n,stream:_t.ENQUEUE,streamId:e,chunk:c},d)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:i,targetName:n,stream:_t.CLOSE,streamId:e}),delete a.streamSinks[e])},error(c){St(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,s.postMessage({sourceName:i,targetName:n,stream:_t.ERROR,streamId:e,reason:Ht(c)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[e]=l,new Promise(function(c){c(o(t.data,l))}).then(function(){s.postMessage({sourceName:i,targetName:n,stream:_t.START_COMPLETE,streamId:e,success:!0})},function(c){s.postMessage({sourceName:i,targetName:n,stream:_t.START_COMPLETE,streamId:e,reason:Ht(c)})})}#e(t){const e=t.streamId,i=this.sourceName,n=t.sourceName,s=this.comObj,a=this.streamControllers[e],o=this.streamSinks[e];switch(t.stream){case _t.START_COMPLETE:t.success?a.startCall.resolve():a.startCall.reject(Ht(t.reason));break;case _t.PULL_COMPLETE:t.success?a.pullCall.resolve():a.pullCall.reject(Ht(t.reason));break;case _t.PULL:if(!o){s.postMessage({sourceName:i,targetName:n,stream:_t.PULL_COMPLETE,streamId:e,success:!0});break}o.desiredSize<=0&&t.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=t.desiredSize,new Promise(function(l){l(o.onPull?.())}).then(function(){s.postMessage({sourceName:i,targetName:n,stream:_t.PULL_COMPLETE,streamId:e,success:!0})},function(l){s.postMessage({sourceName:i,targetName:n,stream:_t.PULL_COMPLETE,streamId:e,reason:Ht(l)})});break;case _t.ENQUEUE:if(St(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(t.chunk);break;case _t.CLOSE:if(St(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),this.#i(a,e);break;case _t.ERROR:St(a,"error should have stream controller"),a.controller.error(Ht(t.reason)),this.#i(a,e);break;case _t.CANCEL_COMPLETE:t.success?a.cancelCall.resolve():a.cancelCall.reject(Ht(t.reason)),this.#i(a,e);break;case _t.CANCEL:if(!o)break;new Promise(function(l){l(o.onCancel?.(Ht(t.reason)))}).then(function(){s.postMessage({sourceName:i,targetName:n,stream:_t.CANCEL_COMPLETE,streamId:e,success:!0})},function(l){s.postMessage({sourceName:i,targetName:n,stream:_t.CANCEL_COMPLETE,streamId:e,reason:Ht(l)})}),o.sinkCapability.reject(Ht(t.reason)),o.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}async#i(t,e){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[e]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}class bh{#t;#e;constructor({parsedData:t,rawData:e}){this.#t=t,this.#e=e}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}getAll(){return Zn(this.#t)}has(t){return this.#t.has(t)}}const he=Symbol("INTERNAL");class vh{#t=!1;#e=!1;#i=!1;#s=!0;constructor(t,{name:e,intent:i,usage:n}){this.#t=!!(t&Vt.DISPLAY),this.#e=!!(t&Vt.PRINT),this.name=e,this.intent=i,this.usage=n}get visible(){if(this.#i)return this.#s;if(!this.#s)return!1;const{print:t,view:e}=this.usage;return this.#t?e?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,e,i=!1){t!==he&&gt("Internal method `_setVisible` called."),this.#i=i,this.#s=e}}class yh{#t=null;#e=new Map;#i=null;#s=null;constructor(t,e=Vt.DISPLAY){if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#s=t.order;for(const i of t.groups)this.#e.set(i.id,new vh(e,i));if(t.baseState==="OFF")for(const i of this.#e.values())i._setVisible(he,!1);for(const i of t.on)this.#e.get(i)._setVisible(he,!0);for(const i of t.off)this.#e.get(i)._setVisible(he,!1);this.#i=this.getHash()}}#a(t){const e=t.length;if(e<2)return!0;const i=t[0];for(let n=1;n<e;n++){const s=t[n];let a;if(Array.isArray(s))a=this.#a(s);else if(this.#e.has(s))a=this.#e.get(s).visible;else return ct(`Optional content group not found: ${s}`),!0;switch(i){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return i==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return Yi("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(ct(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#a(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!this.#e.has(e))return ct(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!this.#e.has(e))return ct(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!this.#e.has(e))return ct(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!this.#e.has(e))return ct(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!1}return!0}return ct(`Unknown optional content policy ${t.policy}.`),!0}return ct(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0){const i=this.#e.get(t);if(!i){ct(`Optional content group not found: ${t}`);return}i._setVisible(he,!!e,!0),this.#t=null}setOCGState({state:t,preserveRB:e}){let i;for(const n of t){switch(n){case"ON":case"OFF":case"Toggle":i=n;continue}const s=this.#e.get(n);if(s)switch(i){case"ON":s._setVisible(he,!0);break;case"OFF":s._setVisible(he,!1);break;case"Toggle":s._setVisible(he,!s.visible);break}}this.#t=null}get hasInitialVisibility(){return this.#i===null||this.getHash()===this.#i}getOrder(){return this.#e.size?this.#s?this.#s.slice():[...this.#e.keys()]:null}getGroups(){return this.#e.size>0?Zn(this.#e):null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new Fa;for(const[e,i]of this.#e)t.update(`${e}:${i.visible}`);return this.#t=t.hexdigest()}}class _h{constructor(t,{disableRange:e=!1,disableStream:i=!1}){St(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:n,initialData:s,progressiveDone:a,contentDispositionFilename:o}=t;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=o,s?.length>0){const l=s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!i,this._isRangeSupported=!e,this._contentLength=n,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((l,c)=>{this._onReceiveData({begin:l,chunk:c})}),t.addProgressListener((l,c)=>{this._onProgress({loaded:l,total:c})}),t.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const i=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{const n=this._rangeReaders.some(function(s){return s._begin!==t?!1:(s._enqueue(i),!0)});St(n,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){t.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){St(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new Ah(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new Eh(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeReaders.slice(0))e.cancel(t);this._pdfDataRangeTransport.abort()}}class Ah{constructor(t,e,i=!1,n=null){this._stream=t,this._done=i||!1,this._filename=is(n)?n:null,this._queuedChunks=e||[],this._loaded=0;for(const s of this._queuedChunks)this._loaded+=s.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class Eh{constructor(t,e,i){this._stream=t,this._begin=e,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function wh(r){let t=!0,e=i("filename\\*","i").exec(r);if(e){e=e[1];let h=o(e);return h=unescape(h),h=l(h),h=c(h),s(h)}if(e=a(r),e){const h=c(e);return s(h)}if(e=i("filename","i").exec(r),e){e=e[1];let h=o(e);return h=c(h),s(h)}function i(h,d){return new RegExp("(?:^|;)\\s*"+h+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',d)}function n(h,d){if(h){if(!/^[\x00-\xFF]+$/.test(d))return d;try{const u=new TextDecoder(h,{fatal:!0}),p=Xi(d);d=u.decode(p),t=!1}catch{}}return d}function s(h){return t&&/[\x80-\xff]/.test(h)&&(h=n("utf-8",h),t&&(h=n("iso-8859-1",h))),h}function a(h){const d=[];let u;const p=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(u=p.exec(h))!==null;){let[,m,b,g]=u;if(m=parseInt(m,10),m in d){if(m===0)break;continue}d[m]=[b,g]}const f=[];for(let m=0;m<d.length&&m in d;++m){let[b,g]=d[m];g=o(g),b&&(g=unescape(g),m===0&&(g=l(g))),f.push(g)}return f.join("")}function o(h){if(h.startsWith('"')){const d=h.slice(1).split('\\"');for(let u=0;u<d.length;++u){const p=d[u].indexOf('"');p!==-1&&(d[u]=d[u].slice(0,p),d.length=u+1),d[u]=d[u].replaceAll(/\\(.)/g,"$1")}h=d.join('"')}return h}function l(h){const d=h.indexOf("'");if(d===-1)return h;const u=h.slice(0,d),f=h.slice(d+1).replace(/^[^']*'/,"");return n(u,f)}function c(h){return!h.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(h)?h:h.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(d,u,p,f){if(p==="q"||p==="Q")return f=f.replaceAll("_"," "),f=f.replaceAll(/=([0-9a-fA-F]{2})/g,function(m,b){return String.fromCharCode(parseInt(b,16))}),n(u,f);try{f=atob(f)}catch{}return n(u,f)})}return""}function cs({getResponseHeader:r,isHttp:t,rangeChunkSize:e,disableRange:i}){const n={allowRangeRequests:!1,suggestedLength:void 0},s=parseInt(r("Content-Length"),10);return!Number.isInteger(s)||(n.suggestedLength=s,s<=2*e)||i||!t||r("Accept-Ranges")!=="bytes"||(r("Content-Encoding")||"identity")!=="identity"||(n.allowRangeRequests=!0),n}function hs(r){const t=r("Content-Disposition");if(t){let e=wh(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(is(e))return e}return null}function en(r,t){return r===404||r===0&&t.startsWith("file:")?new Te('Missing PDF "'+t+'".'):new qi(`Unexpected server response (${r}) while retrieving PDF "${t}".`,r)}function ja(r){return r===200||r===206}function Ha(r,t,e){return{method:"GET",headers:r,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function Ua(r){const t=new Headers;for(const e in r){const i=r[e];i!==void 0&&t.append(e,i)}return t}function $a(r){return r instanceof Uint8Array?r.buffer:r instanceof ArrayBuffer?r:(ct(`getArrayBuffer - unexpected data format: ${r}`),new Uint8Array(r).buffer)}class vr{constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.httpHeaders=this.isHttp&&t.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return St(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new xh(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new Sh(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class xh{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._headers=Ua(this._stream.httpHeaders);const i=e.url;fetch(i,Ha(this._headers,this._withCredentials,this._abortController)).then(n=>{if(!ja(n.status))throw en(n.status,i);this._reader=n.body.getReader(),this._headersCapability.resolve();const s=l=>n.headers.get(l),{allowRangeRequests:a,suggestedLength:o}=cs({getResponseHeader:s,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=a,this._contentLength=o||this._contentLength,this._filename=hs(s),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Ce("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:$a(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class Sh{constructor(t,e,i){this._stream=t,this._reader=null,this._loaded=0;const n=t.source;this._withCredentials=n.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!n.disableStream,this._abortController=new AbortController,this._headers=Ua(this._stream.httpHeaders),this._headers.append("Range",`bytes=${e}-${i-1}`);const s=n.url;fetch(s,Ha(this._headers,this._withCredentials,this._abortController)).then(a=>{if(!ja(a.status))throw en(a.status,s);this._readCapability.resolve(),this._reader=a.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded}),{value:$a(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const yn=200,_n=206;function Th(r){const t=r.response;return typeof t!="string"?t:Xi(t).buffer}class Ch{constructor(t,e={}){this.url=t,this.isHttp=/^https?:/i.test(t),this.httpHeaders=this.isHttp&&e.httpHeaders||Object.create(null),this.withCredentials=e.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(t,e,i){const n={begin:t,end:e};for(const s in i)n[s]=i[s];return this.request(n)}requestFull(t){return this.request(t)}request(t){const e=new XMLHttpRequest,i=this.currXhrId++,n=this.pendingRequests[i]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const s in this.httpHeaders){const a=this.httpHeaders[s];a!==void 0&&e.setRequestHeader(s,a)}return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),n.expectedStatus=_n):n.expectedStatus=yn,e.responseType="arraybuffer",t.onError&&(e.onerror=function(s){t.onError(e.status)}),e.onreadystatechange=this.onStateChange.bind(this,i),e.onprogress=this.onProgress.bind(this,i),n.onHeadersReceived=t.onHeadersReceived,n.onDone=t.onDone,n.onError=t.onError,n.onProgress=t.onProgress,e.send(null),i}onProgress(t,e){const i=this.pendingRequests[t];i&&i.onProgress?.(e)}onStateChange(t,e){const i=this.pendingRequests[t];if(!i)return;const n=i.xhr;if(n.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),n.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],n.status===0&&this.isHttp){i.onError?.(n.status);return}const s=n.status||yn;if(!(s===yn&&i.expectedStatus===_n)&&s!==i.expectedStatus){i.onError?.(n.status);return}const o=Th(n);if(s===_n){const l=n.getResponseHeader("Content-Range"),c=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);i.onDone({begin:parseInt(c[1],10),chunk:o})}else o?i.onDone({begin:0,chunk:o}):i.onError?.(n.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class Ph{constructor(t){this._source=t,this._manager=new Ch(t.url,{httpHeaders:t.httpHeaders,withCredentials:t.withCredentials}),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return St(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new Rh(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const i=new Lh(this._manager,t,e);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class Rh{constructor(t,e){this._manager=t;const i={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=e.url,this._fullRequestId=t.requestFull(i),this._headersReceivedCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t),i=a=>e.getResponseHeader(a),{allowRangeRequests:n,suggestedLength:s}=cs({getResponseHeader:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});n&&(this._isRangeSupported=!0),this._contentLength=s||this._contentLength,this._filename=hs(i),this._isRangeSupported&&this._manager.abortRequest(t),this._headersReceivedCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=en(t,this._url),this._headersReceivedCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersReceivedCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class Lh{constructor(t,e,i){this._manager=t;const n={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=t.url,this._requestId=t.requestRange(e,i,n),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError=en(t,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const za=/^file:\/\/\/[a-zA-Z]:\//;function kh(r){const t=Jt.get("url"),e=t.parse(r);return e.protocol==="file:"||e.host?e:/^[a-z]:[/\\]/i.test(r)?t.parse(`file:///${r}`):(e.host||(e.protocol="file:"),e)}class Ih{constructor(t){this.source=t,this.url=kh(t.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&t.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return St(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new Dh(this):new Mh(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=this.isFsUrl?new Fh(this,t,e):new Oh(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class Ga{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Ce("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class Va{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const e=t.source;this._isStreamingSupported=!e.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function Mi(r,t){return{protocol:r.protocol,auth:r.auth,host:r.hostname,port:r.port,path:r.path,method:"GET",headers:t}}class Mh extends Ga{constructor(t){super(t);const e=i=>{if(i.statusCode===404){const o=new Te(`Missing PDF "${this._url}".`);this._storedError=o,this._headersCapability.reject(o);return}this._headersCapability.resolve(),this._setReadableStream(i);const n=o=>this._readableStream.headers[o.toLowerCase()],{allowRangeRequests:s,suggestedLength:a}=cs({getResponseHeader:n,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=s,this._contentLength=a||this._contentLength,this._filename=hs(n)};if(this._request=null,this._url.protocol==="http:"){const i=Jt.get("http");this._request=i.request(Mi(this._url,t.httpHeaders),e)}else{const i=Jt.get("https");this._request=i.request(Mi(this._url,t.httpHeaders),e)}this._request.on("error",i=>{this._storedError=i,this._headersCapability.reject(i)}),this._request.end()}}class Oh extends Va{constructor(t,e,i){super(t),this._httpHeaders={};for(const s in t.httpHeaders){const a=t.httpHeaders[s];a!==void 0&&(this._httpHeaders[s]=a)}this._httpHeaders.Range=`bytes=${e}-${i-1}`;const n=s=>{if(s.statusCode===404){const a=new Te(`Missing PDF "${this._url}".`);this._storedError=a;return}this._setReadableStream(s)};if(this._request=null,this._url.protocol==="http:"){const s=Jt.get("http");this._request=s.request(Mi(this._url,this._httpHeaders),n)}else{const s=Jt.get("https");this._request=s.request(Mi(this._url,this._httpHeaders),n)}this._request.on("error",s=>{this._storedError=s}),this._request.end()}}class Dh extends Ga{constructor(t){super(t);let e=decodeURIComponent(this._url.path);za.test(this._url.href)&&(e=e.replace(/^\//,""));const i=Jt.get("fs");i.promises.lstat(e).then(n=>{this._contentLength=n.size,this._setReadableStream(i.createReadStream(e)),this._headersCapability.resolve()},n=>{n.code==="ENOENT"&&(n=new Te(`Missing PDF "${e}".`)),this._storedError=n,this._headersCapability.reject(n)})}}class Fh extends Va{constructor(t,e,i){super(t);let n=decodeURIComponent(this._url.path);za.test(this._url.href)&&(n=n.replace(/^\//,""));const s=Jt.get("fs");this._setReadableStream(s.createReadStream(n,{start:e,end:i-1}))}}const Nh=1e5,Dt=30,Bh=.8;let Oi=class Me{#t=Promise.withResolvers();#e=null;#i=!1;#s=!!globalThis.FontInspector?.enabled;#a=null;#n=null;#r=0;#c=0;#l=null;#d=null;#f=0;#h=0;#o=Object.create(null);#p=[];#g=null;#u=[];#v=new WeakMap;#m=null;static#y=new Map;static#A=new Map;static#x=new Set;constructor({textContentSource:t,container:e,viewport:i}){if(t instanceof ReadableStream)this.#g=t;else if(typeof t=="object")this.#g=new ReadableStream({start(l){l.enqueue(t),l.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#d=e,this.#h=i.scale*(globalThis.devicePixelRatio||1),this.#f=i.rotation,this.#n={prevFontSize:null,prevFontFamily:null,div:null,properties:null,ctx:null};const{pageWidth:n,pageHeight:s,pageX:a,pageY:o}=i.rawDims;this.#m=[1,0,0,-1,-a,o+s],this.#c=n,this.#r=s,we(e,i),this.#t.promise.catch(()=>{}).then(()=>{Me.#x.delete(this),this.#n=null,this.#o=null})}render(){const t=()=>{this.#l.read().then(({value:e,done:i})=>{if(i){this.#t.resolve();return}this.#a??=e.lang,Object.assign(this.#o,e.styles),this.#S(e.items),t()},this.#t.reject)};return this.#l=this.#g.getReader(),Me.#x.add(this),t(),this.#t.promise}update({viewport:t,onBefore:e=null}){const i=t.scale*(globalThis.devicePixelRatio||1),n=t.rotation;if(n!==this.#f&&(e?.(),this.#f=n,we(this.#d,{rotation:n})),i!==this.#h){e?.(),this.#h=i;const s={prevFontSize:null,prevFontFamily:null,div:null,properties:null,ctx:Me.#_(this.#a)};for(const a of this.#u)s.properties=this.#v.get(a),s.div=a,this.#T(s)}}cancel(){const t=new Ce("TextLayer task cancelled.");this.#l?.cancel(t).catch(()=>{}),this.#l=null,this.#t.reject(t)}get textDivs(){return this.#u}get textContentItemsStr(){return this.#p}#S(t){if(this.#i)return;this.#n.ctx||=Me.#_(this.#a);const e=this.#u,i=this.#p;for(const n of t){if(e.length>Nh){ct("Ignoring additional textDivs for performance reasons."),this.#i=!0;return}if(n.str===void 0){if(n.type==="beginMarkedContentProps"||n.type==="beginMarkedContent"){const s=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),n.id!==null&&this.#e.setAttribute("id",`${n.id}`),s.append(this.#e)}else n.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}i.push(n.str),this.#P(n)}}#P(t){const e=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#u.push(e);const n=q.transform(this.#m,t.transform);let s=Math.atan2(n[1],n[0]);const a=this.#o[t.fontName];a.vertical&&(s+=Math.PI/2);const o=this.#s&&a.fontSubstitution||a.fontFamily,l=Math.hypot(n[2],n[3]),c=l*Me.#b(o,this.#a);let h,d;s===0?(h=n[4],d=n[5]-c):(h=n[4]+c*Math.sin(s),d=n[5]-c*Math.cos(s));const u="calc(var(--scale-factor)*",p=e.style;this.#e===this.#d?(p.left=`${(100*h/this.#c).toFixed(2)}%`,p.top=`${(100*d/this.#r).toFixed(2)}%`):(p.left=`${u}${h.toFixed(2)}px)`,p.top=`${u}${d.toFixed(2)}px)`),p.fontSize=`${u}${l.toFixed(2)}px)`,p.fontFamily=o,i.fontSize=l,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,this.#s&&(e.dataset.fontName=a.fontSubstitutionLoadedName||t.fontName),s!==0&&(i.angle=s*(180/Math.PI));let f=!1;if(t.str.length>1)f=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const m=Math.abs(t.transform[0]),b=Math.abs(t.transform[3]);m!==b&&Math.max(m,b)/Math.min(m,b)>1.5&&(f=!0)}if(f&&(i.canvasWidth=a.vertical?t.height:t.width),this.#v.set(e,i),this.#n.div=e,this.#n.properties=i,this.#T(this.#n),i.hasText&&this.#e.append(e),i.hasEOL){const m=document.createElement("br");m.setAttribute("role","presentation"),this.#e.append(m)}}#T(t){const{div:e,properties:i,ctx:n,prevFontSize:s,prevFontFamily:a}=t,{style:o}=e;let l="";if(i.canvasWidth!==0&&i.hasText){const{fontFamily:c}=o,{canvasWidth:h,fontSize:d}=i;(s!==d||a!==c)&&(n.font=`${d*this.#h}px ${c}`,t.prevFontSize=d,t.prevFontFamily=c);const{width:u}=n.measureText(e.textContent);u>0&&(l=`scaleX(${h*this.#h/u})`)}i.angle!==0&&(l=`rotate(${i.angle}deg) ${l}`),l.length>0&&(o.transform=l)}static cleanup(){if(!(this.#x.size>0)){this.#y.clear();for(const{canvas:t}of this.#A.values())t.remove();this.#A.clear()}}static#_(t=null){let e=this.#A.get(t||="");if(!e){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=t,document.body.append(i),e=i.getContext("2d",{alpha:!1}),this.#A.set(t,e)}return e}static#b(t,e){const i=this.#y.get(t);if(i)return i;const n=this.#_(e),s=n.font;n.canvas.width=n.canvas.height=Dt,n.font=`${Dt}px ${t}`;const a=n.measureText("");let o=a.fontBoundingBoxAscent,l=Math.abs(a.fontBoundingBoxDescent);if(o){const d=o/(o+l);return this.#y.set(t,d),n.canvas.width=n.canvas.height=0,n.font=s,d}n.strokeStyle="red",n.clearRect(0,0,Dt,Dt),n.strokeText("g",0,0);let c=n.getImageData(0,0,Dt,Dt).data;l=0;for(let d=c.length-1-3;d>=0;d-=4)if(c[d]>0){l=Math.ceil(d/4/Dt);break}n.clearRect(0,0,Dt,Dt),n.strokeText("A",0,Dt),c=n.getImageData(0,0,Dt,Dt).data,o=0;for(let d=0,u=c.length;d<u;d+=4)if(c[d]>0){o=Dt-Math.floor(d/4/Dt);break}n.canvas.width=n.canvas.height=0,n.font=s;const h=o?o/(o+l):Bh;return this.#y.set(t,h),h}};function jh(){Oa("`renderTextLayer`, please use `TextLayer` instead.");const{textContentSource:r,container:t,viewport:e,...i}=arguments[0],n=Object.keys(i);n.length>0&&ct("Ignoring `renderTextLayer` parameters: "+n.join(", "));const s=new Oi({textContentSource:r,container:t,viewport:e}),{textDivs:a,textContentItemsStr:o}=s;return{promise:s.render(),textDivs:a,textContentItemsStr:o}}function Hh(){Oa("`updateTextLayer`, please use `TextLayer` instead.")}class ai{static textContent(t){const e=[],i={items:e,styles:Object.create(null)};function n(s){if(!s)return;let a=null;const o=s.name;if(o==="#text")a=s.value;else if(ai.shouldBuildText(o))s?.attributes?.textContent?a=s.attributes.textContent:s.value&&(a=s.value);else return;if(a!==null&&e.push({str:a}),!!s.children)for(const l of s.children)n(l)}return n(t),i}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}const Uh=65536,$h=100,zh=5e3,Gh=Mt?eh:$c,Vh=Mt?ih:Ia,Wh=Mt?th:Uc,Yh=Mt?nh:Ma;function qh(r){if(typeof r=="string"||r instanceof URL?r={url:r}:(r instanceof ArrayBuffer||ArrayBuffer.isView(r))&&(r={data:r}),typeof r!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!r.url&&!r.data&&!r.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const t=new ds,{docId:e}=t,i=r.url?Xh(r.url):null,n=r.data?Kh(r.data):null,s=r.httpHeaders||null,a=r.withCredentials===!0,o=r.password??null,l=r.range instanceof Wa?r.range:null,c=Number.isInteger(r.rangeChunkSize)&&r.rangeChunkSize>0?r.rangeChunkSize:Uh;let h=r.worker instanceof Wt?r.worker:null;const d=r.verbosity,u=typeof r.docBaseUrl=="string"&&!es(r.docBaseUrl)?r.docBaseUrl:null,p=typeof r.cMapUrl=="string"?r.cMapUrl:null,f=r.cMapPacked!==!1,m=r.CMapReaderFactory||Vh,b=typeof r.standardFontDataUrl=="string"?r.standardFontDataUrl:null,g=r.StandardFontDataFactory||Yh,y=r.stopAtErrors!==!0,x=Number.isInteger(r.maxImageSize)&&r.maxImageSize>-1?r.maxImageSize:-1,w=r.isEvalSupported!==!1,v=typeof r.isOffscreenCanvasSupported=="boolean"?r.isOffscreenCanvasSupported:!Mt,R=Number.isInteger(r.canvasMaxAreaInBytes)?r.canvasMaxAreaInBytes:-1,I=typeof r.disableFontFace=="boolean"?r.disableFontFace:Mt,j=r.fontExtraProperties===!0,H=r.enableXfa===!0,z=r.ownerDocument||globalThis.document,D=r.disableRange===!0,$=r.disableStream===!0,W=r.disableAutoFetch===!0,Y=r.pdfBug===!0,G=l?l.length:r.length??NaN,J=typeof r.useSystemFonts=="boolean"?r.useSystemFonts:!Mt&&!I,F=typeof r.useWorkerFetch=="boolean"?r.useWorkerFetch:m===Ia&&g===Ma&&p&&b&&ti(p,document.baseURI)&&ti(b,document.baseURI),_=r.canvasFactory||new Gh({ownerDocument:z}),A=r.filterFactory||new Wh({docId:e,ownerDocument:z}),C=null;Lc(d);const O={canvasFactory:_,filterFactory:A};if(F||(O.cMapReaderFactory=new m({baseUrl:p,isCompressed:f}),O.standardFontDataFactory=new g({baseUrl:b})),!h){const L={verbosity:d,port:ri.workerPort};h=L.port?Wt.fromPort(L):new Wt(L),t._worker=h}const S={docId:e,apiVersion:"4.3.136",data:n,password:o,disableAutoFetch:W,rangeChunkSize:c,length:G,docBaseUrl:u,enableXfa:H,evaluatorOptions:{maxImageSize:x,disableFontFace:I,ignoreErrors:y,isEvalSupported:w,isOffscreenCanvasSupported:v,canvasMaxAreaInBytes:R,fontExtraProperties:j,useSystemFonts:J,cMapUrl:F?p:null,standardFontDataUrl:F?b:null}},T={disableFontFace:I,fontExtraProperties:j,ownerDocument:z,pdfBug:Y,styleElement:C,loadingParams:{disableAutoFetch:W,enableXfa:H}};return h.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const L=h.messageHandler.sendWithPromise("GetDocRequest",S,n?[n.buffer]:null);let U;return l?U=new _h(l,{disableRange:D,disableStream:$}):n||(U=(N=>Mt?function(){return typeof fetch<"u"&&typeof Response<"u"&&"body"in Response.prototype}()&&ti(N.url)?new vr(N):new Ih(N):ti(N.url)?new vr(N):new Ph(N))({url:i,length:G,httpHeaders:s,withCredentials:a,rangeChunkSize:c,disableRange:D,disableStream:$})),L.then(E=>{if(t.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const N=new ei(e,E,h.port),k=new td(N,t,U,T,O);t._transport=k,N.send("Ready",null)})}).catch(t._capability.reject),t}function Xh(r){if(r instanceof URL)return r.href;try{return new URL(r,window.location).href}catch{if(Mt&&typeof r=="string")return r}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function Kh(r){if(Mt&&typeof Buffer<"u"&&r instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength)return r;if(typeof r=="string")return Xi(r);if(r instanceof ArrayBuffer||ArrayBuffer.isView(r)||typeof r=="object"&&!isNaN(r?.length))return new Uint8Array(r);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function yr(r){return typeof r=="object"&&Number.isInteger(r?.num)&&r.num>=0&&Number.isInteger(r?.gen)&&r.gen>=0}class ds{static#t=0;constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${ds.#t++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}}let Wa=class{constructor(t,e,i=!1,n=null){this.length=t,this.initialData=e,this.progressiveDone=i,this.contentDispositionFilename=n,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,e){for(const i of this._rangeListeners)i(t,e)}onDataProgress(t,e){this._readyCapability.promise.then(()=>{for(const i of this._progressListeners)i(t,e)})}onDataProgressiveRead(t){this._readyCapability.promise.then(()=>{for(const e of this._progressiveReadListeners)e(t)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const t of this._progressiveDoneListeners)t()})}transportReady(){this._readyCapability.resolve()}requestDataRange(t,e){gt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}};class Zh{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return ut(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class Qh{#t=null;#e=!1;constructor(t,e,i,n=!1){this._pageIndex=t,this._pageInfo=e,this._transport=i,this._stats=n?new rr:null,this._pdfBug=n,this.commonObjs=i.commonObjs,this.objs=new Ya,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:i=0,offsetY:n=0,dontFlip:s=!1}={}){return new li({viewBox:this.view,scale:t,rotation:e,offsetX:i,offsetY:n,dontFlip:s})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return ut(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,viewport:e,intent:i="display",annotationMode:n=de.ENABLE,transform:s=null,background:a=null,optionalContentConfigPromise:o=null,annotationCanvasMap:l=null,pageColors:c=null,printAnnotationStorage:h=null}){this._stats?.time("Overall");const d=this._transport.getRenderingIntent(i,n,h),{renderingIntent:u,cacheKey:p}=d;this.#e=!1,this.#s(),o||=this._transport.getOptionalContentConfig(u);let f=this._intentStates.get(p);f||(f=Object.create(null),this._intentStates.set(p,f)),f.streamReaderCancelTimeout&&(clearTimeout(f.streamReaderCancelTimeout),f.streamReaderCancelTimeout=null);const m=!!(u&Vt.PRINT);f.displayReadyCapability||(f.displayReadyCapability=Promise.withResolvers(),f.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(d));const b=x=>{f.renderTasks.delete(g),(this._maybeCleanupAfterRender||m)&&(this.#e=!0),this.#i(!m),x?(g.capability.reject(x),this._abortOperatorList({intentState:f,reason:x instanceof Error?x:new Error(x)})):g.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},g=new De({callback:b,params:{canvasContext:t,viewport:e,transform:s,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:l,operatorList:f.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!m,pdfBug:this._pdfBug,pageColors:c});(f.renderTasks||=new Set).add(g);const y=g.task;return Promise.all([f.displayReadyCapability.promise,o]).then(([x,w])=>{if(this.destroyed){b();return}if(this._stats?.time("Rendering"),!(w.renderingIntent&u))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");g.initializeGraphics({transparency:x,optionalContentConfig:w}),g.operatorListChanged()}).catch(b),y}getOperatorList({intent:t="display",annotationMode:e=de.ENABLE,printAnnotationStorage:i=null}={}){function n(){a.operatorList.lastChunk&&(a.opListReadCapability.resolve(a.operatorList),a.renderTasks.delete(o))}const s=this._transport.getRenderingIntent(t,e,i,!0);let a=this._intentStates.get(s.cacheKey);a||(a=Object.create(null),this._intentStates.set(s.cacheKey,a));let o;return a.opListReadCapability||(o=Object.create(null),o.operatorListChanged=n,a.opListReadCapability=Promise.withResolvers(),(a.renderTasks||=new Set).add(o),a.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(s)),a.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(n){return n.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>ai.textContent(i));const e=this.streamTextContent(t);return new Promise(function(i,n){function s(){a.read().then(function({value:l,done:c}){if(c){i(o);return}o.lang??=l.lang,Object.assign(o.styles,l.styles),o.items.push(...l.items),s()},n)}const a=e.getReader(),o={items:[],styles:Object.create(null),lang:null};s()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const i of e.renderTasks)t.push(i.completed),i.cancel();return this.objs.clear(),this.#e=!1,this.#s(),Promise.all(t)}cleanup(t=!1){this.#e=!0;const e=this.#i(!1);return t&&e&&(this._stats&&=new rr),e}#i(t=!1){if(this.#s(),!this.#e||this.destroyed)return!1;if(t)return this.#t=setTimeout(()=>{this.#t=null,this.#i(!1)},zh),!1;for(const{renderTasks:e,operatorList:i}of this._intentStates.values())if(e.size>0||!i.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#e=!1,!0}#s(){this.#t&&(clearTimeout(this.#t),this.#t=null)}_startRenderPage(t,e){const i=this._intentStates.get(e);i&&(this._stats?.timeEnd("Page Request"),i.displayReadyCapability?.resolve(t))}_renderPageChunk(t,e){for(let i=0,n=t.length;i<n;i++)e.operatorList.fnArray.push(t.fnArray[i]),e.operatorList.argsArray.push(t.argsArray[i]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const i of e.renderTasks)i.operatorListChanged();t.lastChunk&&this.#i(!0)}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:i}){const{map:n,transfer:s}=i,o=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:n},s).getReader(),l=this._intentStates.get(e);l.streamReader=o;const c=()=>{o.read().then(({value:h,done:d})=>{if(d){l.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(h,l),c())},h=>{if(l.streamReader=null,!this._transport.destroyed){if(l.operatorList){l.operatorList.lastChunk=!0;for(const d of l.renderTasks)d.operatorListChanged();this.#i(!0)}if(l.displayReadyCapability)l.displayReadyCapability.reject(h);else if(l.opListReadCapability)l.opListReadCapability.reject(h);else throw h}})};c()}_abortOperatorList({intentState:t,reason:e,force:i=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!i){if(t.renderTasks.size>0)return;if(e instanceof ts){let n=$h;e.extraDelay>0&&e.extraDelay<1e3&&(n+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},n);return}}if(t.streamReader.cancel(new Ce(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[n,s]of this._intentStates)if(s===t){this._intentStates.delete(n);break}this.cleanup()}}}get stats(){return this._stats}}class Jh{#t=new Set;#e=Promise.resolve();postMessage(t,e){const i={data:structuredClone(t,e?{transfer:e}:null)};this.#e.then(()=>{for(const n of this.#t)n.call(this,i)})}addEventListener(t,e){this.#t.add(e)}removeEventListener(t,e){this.#t.delete(e)}terminate(){this.#t.clear()}}const re={isWorkerDisabled:!1,fakeWorkerId:0};Mt&&(re.isWorkerDisabled=!0,ri.workerSrc||="./pdf.worker.mjs"),re.isSameOrigin=function(r,t){let e;try{if(e=new URL(r),!e.origin||e.origin==="null")return!1}catch{return!1}const i=new URL(t,e);return e.origin===i.origin},re.createCDNWrapper=function(r){const t=`await import("${r}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))};class Wt{static#t;constructor({name:t=null,port:e=null,verbosity:i=kc()}={}){if(this.name=t,this.destroyed=!1,this.verbosity=i,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,e){if(Wt.#t?.has(e))throw new Error("Cannot use more than one PDFWorker per port.");(Wt.#t||=new WeakMap).set(e,this),this._initializeFromPort(e);return}this._initialize()}get promise(){return Mt?Promise.all([Jt.promise,this._readyCapability.promise]):this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(t){this._port=t,this._messageHandler=new ei("main","worker",t),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!re.isWorkerDisabled&&!Wt.#e){let{workerSrc:t}=Wt;try{re.isSameOrigin(window.location.href,t)||(t=re.createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),i=new ei("main","worker",e),n=()=>{e.removeEventListener("error",s),i.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},s=()=>{this._webWorker||n()};e.addEventListener("error",s),i.on("test",o=>{if(e.removeEventListener("error",s),this.destroyed){n();return}o?(this._messageHandler=i,this._port=e,this._webWorker=e,this._readyCapability.resolve(),i.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),i.destroy(),e.terminate())}),i.on("ready",o=>{if(e.removeEventListener("error",s),this.destroyed){n();return}try{a()}catch{this._setupFakeWorker()}});const a=()=>{const o=new Uint8Array;i.send("test",o,[o.buffer])};a();return}catch{Yi("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){re.isWorkerDisabled||(ct("Setting up fake worker."),re.isWorkerDisabled=!0),Wt._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const e=new Jh;this._port=e;const i=`fake${re.fakeWorkerId++}`,n=new ei(i+"_worker",i,e);t.setup(n,e);const s=new ei(i,i+"_worker",e);this._messageHandler=s,this._readyCapability.resolve(),s.send("configure",{verbosity:this.verbosity})}).catch(t=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${t.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),Wt.#t?.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(t){if(!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");const e=this.#t?.get(t.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new Wt(t)}static get workerSrc(){if(ri.workerSrc)return ri.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get#e(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){return ut(this,"_setupFakeWorkerGlobal",(async()=>this.#e?this.#e:(await import(this.workerSrc)).WorkerMessageHandler)())}}class td{#t=new Map;#e=new Map;#i=new Map;#s=new Map;#a=null;constructor(t,e,i,n,s){this.messageHandler=t,this.loadingTask=e,this.commonObjs=new Ya,this.fontLoader=new Qc({ownerDocument:n.ownerDocument,styleElement:n.styleElement}),this.loadingParams=n.loadingParams,this._params=n,this.canvasFactory=s.canvasFactory,this.filterFactory=s.filterFactory,this.cMapReaderFactory=s.cMapReaderFactory,this.standardFontDataFactory=s.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}#n(t,e=null){const i=this.#t.get(t);if(i)return i;const n=this.messageHandler.sendWithPromise(t,e);return this.#t.set(t,n),n}get annotationStorage(){return ut(this,"annotationStorage",new os)}getRenderingIntent(t,e=de.ENABLE,i=null,n=!1){let s=Vt.DISPLAY,a=On;switch(t){case"any":s=Vt.ANY;break;case"display":break;case"print":s=Vt.PRINT;break;default:ct(`getRenderingIntent - invalid intent: ${t}`)}switch(e){case de.DISABLE:s+=Vt.ANNOTATIONS_DISABLE;break;case de.ENABLE:break;case de.ENABLE_FORMS:s+=Vt.ANNOTATIONS_FORMS;break;case de.ENABLE_STORAGE:s+=Vt.ANNOTATIONS_STORAGE,a=(s&Vt.PRINT&&i instanceof Na?i:this.annotationStorage).serializable;break;default:ct(`getRenderingIntent - invalid annotationMode: ${e}`)}return n&&(s+=Vt.OPLIST),{renderingIntent:s,cacheKey:`${s}_${a.hash}`,annotationStorageSerializable:a}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#a?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const i of this.#e.values())t.push(i._destroy());this.#e.clear(),this.#i.clear(),this.#s.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),Oi.cleanup(),this._networkStream?.cancelAllRequests(new Ce("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(i,n)=>{St(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=s=>{this._lastProgress={loaded:s.loaded,total:s.total}},n.onPull=()=>{this._fullReader.read().then(function({value:s,done:a}){if(a){n.close();return}St(s instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),n.enqueue(new Uint8Array(s),1,[s])}).catch(s=>{n.error(s)})},n.onCancel=s=>{this._fullReader.cancel(s),n.ready.catch(a=>{if(!this.destroyed)throw a})}}),t.on("ReaderHeadersReady",i=>{const n=Promise.withResolvers(),s=this._fullReader;return s.headersReady.then(()=>{(!s.isStreamingSupported||!s.isRangeSupported)&&(this._lastProgress&&e.onProgress?.(this._lastProgress),s.onProgress=a=>{e.onProgress?.({loaded:a.loaded,total:a.total})}),n.resolve({isStreamingSupported:s.isStreamingSupported,isRangeSupported:s.isRangeSupported,contentLength:s.contentLength})},n.reject),n.promise}),t.on("GetRangeReader",(i,n)=>{St(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const s=this._networkStream.getRangeReader(i.begin,i.end);if(!s){n.close();return}n.onPull=()=>{s.read().then(function({value:a,done:o}){if(o){n.close();return}St(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),n.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{n.error(a)})},n.onCancel=a=>{s.cancel(a),n.ready.catch(o=>{if(!this.destroyed)throw o})}}),t.on("GetDoc",({pdfInfo:i})=>{this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,e._capability.resolve(new Zh(i,this))}),t.on("DocException",function(i){let n;switch(i.name){case"PasswordException":n=new In(i.message,i.code);break;case"InvalidPDFException":n=new Ra(i.message);break;case"MissingPDFException":n=new Te(i.message);break;case"UnexpectedResponseException":n=new qi(i.message,i.status);break;case"UnknownErrorException":n=new Mn(i.message,i.details);break;default:gt("DocException - expected a valid Error.")}e._capability.reject(n)}),t.on("PasswordRequest",i=>{if(this.#a=Promise.withResolvers(),e.onPassword){const n=s=>{s instanceof Error?this.#a.reject(s):this.#a.resolve({password:s})};try{e.onPassword(n,i.code)}catch(s){this.#a.reject(s)}}else this.#a.reject(new In(i.message,i.code));return this.#a.promise}),t.on("DataLoaded",i=>{e.onProgress?.({loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),t.on("StartRenderPage",i=>{if(this.destroyed)return;this.#e.get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),t.on("commonobj",([i,n,s])=>{if(this.destroyed||this.commonObjs.has(i))return null;switch(n){case"Font":const{disableFontFace:a,fontExtraProperties:o,pdfBug:l}=this._params;if("error"in s){const u=s.error;ct(`Error during font loading: ${u}`),this.commonObjs.resolve(i,u);break}const c=l&&globalThis.FontInspector?.enabled?(u,p)=>globalThis.FontInspector.fontAdded(u,p):null,h=new Jc(s,{disableFontFace:a,inspectFont:c});this.fontLoader.bind(h).catch(()=>t.sendWithPromise("FontFallback",{id:i})).finally(()=>{!o&&h.data&&(h.data=null),this.commonObjs.resolve(i,h)});break;case"CopyLocalImage":const{imageRef:d}=s;St(d,"The imageRef must be defined.");for(const u of this.#e.values())for(const[,p]of u.objs)if(p?.ref===d)return p.dataLen?(this.commonObjs.resolve(i,structuredClone(p)),p.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(i,s);break;default:throw new Error(`Got unknown common object type ${n}`)}return null}),t.on("obj",([i,n,s,a])=>{if(this.destroyed)return;const o=this.#e.get(n);if(!o.objs.has(i)){if(o._intentStates.size===0){a?.bitmap?.close();return}switch(s){case"Image":o.objs.resolve(i,a),a?.dataLen>Tc&&(o._maybeCleanupAfterRender=!0);break;case"Pattern":o.objs.resolve(i,a);break;default:throw new Error(`Got unknown object type ${s}`)}}}),t.on("DocProgress",i=>{this.destroyed||e.onProgress?.({loaded:i.loaded,total:i.total})}),t.on("FetchBuiltInCMap",i=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(i):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),t.on("FetchStandardFontData",i=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(i):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&ct("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,i=this.#i.get(e);if(i)return i;const n=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(s=>{if(this.destroyed)throw new Error("Transport destroyed");s.refStr&&this.#s.set(s.refStr,t);const a=new Qh(e,s,this,this._params.pdfBug);return this.#e.set(e,a),a});return this.#i.set(e,n),n}getPageIndex(t){return yr(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return this.#n("GetFieldObjects")}hasJSActions(){return this.#n("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#n("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#n("GetOptionalContentConfig").then(e=>new yh(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=this.#t.get(t);if(e)return e;const i=this.messageHandler.sendWithPromise(t,null).then(n=>({info:n[0],metadata:n[1]?new bh(n[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#t.set(t,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of this.#e.values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0),Oi.cleanup()}}cachedPageNumber(t){if(!yr(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return this.#s.get(e)??null}}const _i=Symbol("INITIAL_DATA");class Ya{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:_i}}get(t,e=null){if(e){const n=this.#e(t);return n.promise.then(()=>e(n.data)),null}const i=this.#t[t];if(!i||i.data===_i)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return i.data}has(t){const e=this.#t[t];return!!e&&e.data!==_i}resolve(t,e=null){const i=this.#e(t);i.data=e,i.resolve()}clear(){for(const t in this.#t){const{data:e}=this.#t[t];e?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:e}=this.#t[t];e!==_i&&(yield[t,e])}}}class ed{#t=null;constructor(t){this.#t=t,this.onContinue=null}get promise(){return this.#t.capability.promise}cancel(t=0){this.#t.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#t.operatorList;if(!t)return!1;const{annotationCanvasMap:e}=this.#t;return t.form||t.canvas&&e?.size>0}}class De{static#t=new WeakSet;constructor({callback:t,params:e,objs:i,commonObjs:n,annotationCanvasMap:s,operatorList:a,pageIndex:o,canvasFactory:l,filterFactory:c,useRequestAnimationFrame:h=!1,pdfBug:d=!1,pageColors:u=null}){this.callback=t,this.params=e,this.objs=i,this.commonObjs=n,this.annotationCanvasMap=s,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=l,this.filterFactory=c,this._pdfBug=d,this.pageColors=u,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=h===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new ed(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){if(this.cancelled)return;if(this._canvas){if(De.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");De.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:i,viewport:n,transform:s,background:a}=this.params;this.gfx=new Ne(i,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:s,viewport:n,transparency:t,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,e=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),De.#t.delete(this._canvas),this.callback(t||new ts(`Rendering cancelled, page ${this._pageIndex+1}`,e))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),De.#t.delete(this._canvas),this.callback())))}}const id="4.3.136",nd="0cec64437";function _r(r){return Math.floor(Math.max(0,Math.min(1,r))*255).toString(16).padStart(2,"0")}function Je(r){return Math.max(0,Math.min(255,255*r))}class Ar{static CMYK_G([t,e,i,n]){return["G",1-Math.min(1,.3*t+.59*i+.11*e+n)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=Je(t),[t,t,t]}static G_HTML([t]){const e=_r(t);return`#${e}${e}${e}`}static RGB_G([t,e,i]){return["G",.3*t+.59*e+.11*i]}static RGB_rgb(t){return t.map(Je)}static RGB_HTML(t){return`#${t.map(_r).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,i,n]){return["RGB",1-Math.min(1,t+n),1-Math.min(1,i+n),1-Math.min(1,e+n)]}static CMYK_rgb([t,e,i,n]){return[Je(1-Math.min(1,t+n)),Je(1-Math.min(1,i+n)),Je(1-Math.min(1,e+n))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,i]){const n=1-t,s=1-e,a=1-i,o=Math.min(n,s,a);return["CMYK",n,s,a,o]}}class qa{static setupStorage(t,e,i,n,s){const a=n.getValue(e,{value:null});switch(i.name){case"textarea":if(a.value!==null&&(t.textContent=a.value),s==="print")break;t.addEventListener("input",o=>{n.setValue(e,{value:o.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(a.value===i.attributes.xfaOn?t.setAttribute("checked",!0):a.value===i.attributes.xfaOff&&t.removeAttribute("checked"),s==="print")break;t.addEventListener("change",o=>{n.setValue(e,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&t.setAttribute("value",a.value),s==="print")break;t.addEventListener("input",o=>{n.setValue(e,{value:o.target.value})})}break;case"select":if(a.value!==null){t.setAttribute("value",a.value);for(const o of i.children)o.attributes.value===a.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}t.addEventListener("input",o=>{const l=o.target.options,c=l.selectedIndex===-1?"":l[l.selectedIndex].value;n.setValue(e,{value:c})});break}}static setAttributes({html:t,element:e,storage:i=null,intent:n,linkService:s}){const{attributes:a}=e,o=t instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${n}`);for(const[l,c]of Object.entries(a))if(c!=null)switch(l){case"class":c.length&&t.setAttribute(l,c.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",c);break;case"style":Object.assign(t.style,c);break;case"textContent":t.textContent=c;break;default:(!o||l!=="href"&&l!=="newWindow")&&t.setAttribute(l,c)}o&&s.addLinkAttributes(t,a.href,a.newWindow),i&&a.dataId&&this.setupStorage(t,a.dataId,e,i)}static render(t){const e=t.annotationStorage,i=t.linkService,n=t.xfaHtml,s=t.intent||"display",a=document.createElement(n.name);n.attributes&&this.setAttributes({html:a,element:n,intent:s,linkService:i});const o=s!=="richText",l=t.div;if(l.append(a),t.viewport){const d=`matrix(${t.viewport.transform.join(",")})`;l.style.transform=d}o&&l.setAttribute("class","xfaLayer xfaFont");const c=[];if(n.children.length===0){if(n.value){const d=document.createTextNode(n.value);a.append(d),o&&ai.shouldBuildText(n.name)&&c.push(d)}return{textDivs:c}}const h=[[n,-1,a]];for(;h.length>0;){const[d,u,p]=h.at(-1);if(u+1===d.children.length){h.pop();continue}const f=d.children[++h.at(-1)[1]];if(f===null)continue;const{name:m}=f;if(m==="#text"){const g=document.createTextNode(f.value);c.push(g),p.append(g);continue}const b=f?.attributes?.xmlns?document.createElementNS(f.attributes.xmlns,m):document.createElement(m);if(p.append(b),f.attributes&&this.setAttributes({html:b,element:f,storage:e,intent:s,linkService:i}),f.children?.length>0)h.push([f,-1,b]);else if(f.value){const g=document.createTextNode(f.value);o&&ai.shouldBuildText(m)&&c.push(g),b.append(g)}}for(const d of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))d.setAttribute("readOnly",!0);return{textDivs:c}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const di=1e3,sd=9,xe=new WeakSet;function oe(r){return{width:r[2]-r[0],height:r[3]-r[1]}}class rd{static create(t){switch(t.data.annotationType){case wt.LINK:return new Xa(t);case wt.TEXT:return new ad(t);case wt.WIDGET:switch(t.data.fieldType){case"Tx":return new od(t);case"Btn":return t.data.radioButton?new Ka(t):t.data.checkBox?new cd(t):new hd(t);case"Ch":return new dd(t);case"Sig":return new ld(t)}return new Pe(t);case wt.POPUP:return new Bn(t);case wt.FREETEXT:return new Za(t);case wt.LINE:return new fd(t);case wt.SQUARE:return new pd(t);case wt.CIRCLE:return new gd(t);case wt.POLYLINE:return new Qa(t);case wt.CARET:return new bd(t);case wt.INK:return new Ja(t);case wt.POLYGON:return new md(t);case wt.HIGHLIGHT:return new vd(t);case wt.UNDERLINE:return new yd(t);case wt.SQUIGGLY:return new _d(t);case wt.STRIKEOUT:return new Ad(t);case wt.STAMP:return new to(t);case wt.FILEATTACHMENT:return new Ed(t);default:return new yt(t)}}}class yt{#t=null;#e=!1;#i=null;constructor(t,{isRenderable:e=!1,ignoreBorder:i=!1,createQuadrilaterals:n=!1}={}){this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(i)),n&&this._createQuadrilaterals()}static _hasPopupData({titleObj:t,contentsObj:e,richText:i}){return!!(t?.str||e?.str||i?.str)}get hasPopupData(){return yt._hasPopupData(this.data)}updateEdited(t){if(!this.container)return;this.#t||={rect:this.data.rect.slice(0)};const{rect:e}=t;e&&this.#s(e),this.#i?.popup.updateEdited(t)}resetEdited(){this.#t&&(this.#s(this.#t.rect),this.#i?.popup.resetEdited(),this.#t=null)}#s(t){const{container:{style:e},data:{rect:i,rotation:n},parent:{viewport:{rawDims:{pageWidth:s,pageHeight:a,pageX:o,pageY:l}}}}=this;i?.splice(0,4,...t);const{width:c,height:h}=oe(t);e.left=`${100*(t[0]-o)/s}%`,e.top=`${100*(a-t[3]+l)/a}%`,n===0?(e.width=`${100*c/s}%`,e.height=`${100*h/a}%`):this.setRotation(n)}_createContainer(t){const{data:e,parent:{page:i,viewport:n}}=this,s=document.createElement("section");s.setAttribute("data-annotation-id",e.id),this instanceof Pe||(s.tabIndex=di);const{style:a}=s;if(a.zIndex=this.parent.zIndex++,e.popupRef&&s.setAttribute("aria-haspopup","dialog"),e.alternativeText&&(s.title=e.alternativeText),e.noRotate&&s.classList.add("norotate"),!e.rect||this instanceof Bn){const{rotation:m}=e;return!e.hasOwnCanvas&&m!==0&&this.setRotation(m,s),s}const{width:o,height:l}=oe(e.rect);if(!t&&e.borderStyle.width>0){a.borderWidth=`${e.borderStyle.width}px`;const m=e.borderStyle.horizontalCornerRadius,b=e.borderStyle.verticalCornerRadius;if(m>0||b>0){const y=`calc(${m}px * var(--scale-factor)) / calc(${b}px * var(--scale-factor))`;a.borderRadius=y}else if(this instanceof Ka){const y=`calc(${o}px * var(--scale-factor)) / calc(${l}px * var(--scale-factor))`;a.borderRadius=y}switch(e.borderStyle.style){case Ze.SOLID:a.borderStyle="solid";break;case Ze.DASHED:a.borderStyle="dashed";break;case Ze.BEVELED:ct("Unimplemented border style: beveled");break;case Ze.INSET:ct("Unimplemented border style: inset");break;case Ze.UNDERLINE:a.borderBottomStyle="solid";break}const g=e.borderColor||null;g?(this.#e=!0,a.borderColor=q.makeHexColor(g[0]|0,g[1]|0,g[2]|0)):a.borderWidth=0}const c=q.normalizeRect([e.rect[0],i.view[3]-e.rect[1]+i.view[1],e.rect[2],i.view[3]-e.rect[3]+i.view[1]]),{pageWidth:h,pageHeight:d,pageX:u,pageY:p}=n.rawDims;a.left=`${100*(c[0]-u)/h}%`,a.top=`${100*(c[1]-p)/d}%`;const{rotation:f}=e;return e.hasOwnCanvas||f===0?(a.width=`${100*o/h}%`,a.height=`${100*l/d}%`):this.setRotation(f,s),s}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:n}=this.parent.viewport.rawDims,{width:s,height:a}=oe(this.data.rect);let o,l;t%180===0?(o=100*s/i,l=100*a/n):(o=100*a/i,l=100*s/n),e.style.width=`${o}%`,e.style.height=`${l}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,i,n)=>{const s=n.detail[e],a=s[0],o=s.slice(1);n.target.style[i]=Ar[`${a}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[i]:Ar[`${a}_rgb`](o)})};return ut(this,"_commonActions",{display:e=>{const{display:i}=e.detail,n=i%2===1;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:n,noPrint:i===1||i===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:i}=e.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const i=e.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(t,e){const i=this._commonActions;for(const n of Object.keys(e.detail))(t[n]||i[n])?.(e)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const i=this._commonActions;for(const[n,s]of Object.entries(e)){const a=i[n];if(a){const o={detail:{[n]:s},target:t};a(o),delete e[n]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,i,n,s]=this.data.rect;if(t.length===1){const[,{x:m,y:b},{x:g,y}]=t[0];if(n===m&&s===b&&e===g&&i===y)return}const{style:a}=this.container;let o;if(this.#e){const{borderColor:m,borderWidth:b}=a;a.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${m}" stroke-width="${b}">`],this.container.classList.add("hasBorder")}const l=n-e,c=s-i,{svgFactory:h}=this,d=h.createElement("svg");d.classList.add("quadrilateralsContainer"),d.setAttribute("width",0),d.setAttribute("height",0);const u=h.createElement("defs");d.append(u);const p=h.createElement("clipPath"),f=`clippath_${this.data.id}`;p.setAttribute("id",f),p.setAttribute("clipPathUnits","objectBoundingBox"),u.append(p);for(const[,{x:m,y:b},{x:g,y}]of t){const x=h.createElement("rect"),w=(g-e)/l,v=(s-b)/c,R=(m-g)/l,I=(b-y)/c;x.setAttribute("x",w),x.setAttribute("y",v),x.setAttribute("width",R),x.setAttribute("height",I),p.append(x),o?.push(`<rect vector-effect="non-scaling-stroke" x="${w}" y="${v}" width="${R}" height="${I}"/>`)}this.#e&&(o.push("</g></svg>')"),a.backgroundImage=o.join("")),this.container.append(d),this.container.style.clipPath=`url(#${f})`}_createPopup(){const{container:t,data:e}=this;t.setAttribute("aria-haspopup","dialog");const i=this.#i=new Bn({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]});this.parent.div.append(i.render())}render(){gt("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const i=[];if(this._fieldObjects){const n=this._fieldObjects[t];if(n)for(const{page:s,id:a,exportValues:o}of n){if(s===-1||a===e)continue;const l=typeof o=="string"?o:null,c=document.querySelector(`[data-element-id="${a}"]`);if(c&&!xe.has(c)){ct(`_getElementsByName - element not allowed: ${a}`);continue}i.push({id:a,exportValue:l,domElement:c})}return i}for(const n of document.getElementsByName(t)){const{exportValue:s}=n,a=n.getAttribute("data-element-id");a!==e&&xe.has(n)&&i.push({id:a,exportValue:s,domElement:n})}return i}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}get _isEditable(){return!1}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e})})}}class Xa extends yt{constructor(t,e=null){super(t,{isRenderable:!0,ignoreBorder:!!e?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:e}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let n=!1;return t.url?(e.addLinkAttributes(i,t.url,t.newWindow),n=!0):t.action?(this._bindNamedAction(i,t.action),n=!0):t.attachment?(this.#e(i,t.attachment,t.attachmentDest),n=!0):t.setOCGState?(this.#i(i,t.setOCGState),n=!0):t.dest?(this._bindLink(i,t.dest),n=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),n=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),n=!0):this.isTooltipOnly&&!n&&(this._bindLink(i,""),n=!0)),this.container.classList.add("linkAnnotation"),n&&this.container.append(i),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,e){t.href=this.linkService.getDestinationHash(e),t.onclick=()=>(e&&this.linkService.goToDestination(e),!1),(e||e==="")&&this.#t()}_bindNamedAction(t,e){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(e),!1),this.#t()}#e(t,e,i=null){t.href=this.linkService.getAnchorUrl(""),e.description&&(t.title=e.description),t.onclick=()=>(this.downloadManager?.openOrDownloadData(e.content,e.filename,i),!1),this.#t()}#i(t,e){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(e),!1),this.#t()}_bindJSAction(t,e){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const n of Object.keys(e.actions)){const s=i.get(n);s&&(t[s]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e.id,name:n}}),!1))}t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,e){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){ct('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{i?.();const{fields:n,refs:s,include:a}=e,o=[];if(n.length!==0||s.length!==0){const h=new Set(s);for(const d of n){const u=this._fieldObjects[d]||[];for(const{id:p}of u)h.add(p)}for(const d of Object.values(this._fieldObjects))for(const u of d)h.has(u.id)===a&&o.push(u)}else for(const h of Object.values(this._fieldObjects))o.push(...h);const l=this.annotationStorage,c=[];for(const h of o){const{id:d}=h;switch(c.push(d),h.type){case"text":{const p=h.defaultValue||"";l.setValue(d,{value:p});break}case"checkbox":case"radiobutton":{const p=h.defaultValue===h.exportValues;l.setValue(d,{value:p});break}case"combobox":case"listbox":{const p=h.defaultValue||"";l.setValue(d,{value:p});break}default:continue}const u=document.querySelector(`[data-element-id="${d}"]`);if(u){if(!xe.has(u)){ct(`_bindResetFormAction - element not allowed: ${d}`);continue}}else continue;u.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:c,name:"ResetForm"}}),!1}}}class ad extends yt{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class Pe extends yt{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return Bt.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,i,n,s){i.includes("mouse")?t.addEventListener(i,a=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:n,value:s(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):t.addEventListener(i,a=>{if(i==="blur"){if(!e.focused||!a.relatedTarget)return;e.focused=!1}else if(i==="focus"){if(e.focused)return;e.focused=!0}s&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:n,value:s(a)}})})}_setEventListeners(t,e,i,n){for(const[s,a]of i)(a==="Action"||this.data.actions?.[a])&&((a==="Focus"||a==="Blur")&&(e||={focused:!1}),this._setEventListener(t,e,s,a,n),a==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,e,"blur","Blur",null):a==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":q.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,n=this.data.defaultAppearanceData.fontSize||sd,s=t.style;let a;const o=2,l=c=>Math.round(10*c)/10;if(this.data.multiLine){const c=Math.abs(this.data.rect[3]-this.data.rect[1]-o),h=Math.round(c/(gn*n))||1,d=c/h;a=Math.min(n,l(d/gn))}else{const c=Math.abs(this.data.rect[3]-this.data.rect[1]-o);a=Math.min(n,l(c/gn))}s.fontSize=`calc(${a}px * var(--scale-factor))`,s.color=q.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(s.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class od extends Pe{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,i,n){const s=this.annotationStorage;for(const a of this._getElementsByName(t.name,t.id))a.domElement&&(a.domElement[e]=i),s.setValue(a.id,{[n]:i})}render(){const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const n=t.getValue(e,{value:this.data.fieldValue});let s=n.value||"";const a=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;a&&s.length>a&&(s=s.slice(0,a));let o=n.formattedValue||this.data.textContent?.join(`
`)||null;o&&this.data.comb&&(o=o.replaceAll(/\s+/g,""));const l={userValue:s,formattedValue:o,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=o??s,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type="text",i.setAttribute("value",o??s),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),xe.add(i),i.setAttribute("data-element-id",e),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=di,this._setRequired(i,this.data.required),a&&(i.maxLength=a),i.addEventListener("input",h=>{t.setValue(e,{value:h.target.value}),this.setPropertyOnSiblings(i,"value",h.target.value,"value"),l.formattedValue=null}),i.addEventListener("resetform",h=>{const d=this.data.defaultFieldValue??"";i.value=l.userValue=d,l.formattedValue=null});let c=h=>{const{formattedValue:d}=l;d!=null&&(h.target.value=d),h.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",d=>{if(l.focused)return;const{target:u}=d;l.userValue&&(u.value=l.userValue),l.lastCommittedValue=u.value,l.commitKey=1,this.data.actions?.Focus||(l.focused=!0)}),i.addEventListener("updatefromsandbox",d=>{this.showElementAndHideCanvas(d.target);const u={value(p){l.userValue=p.detail.value??"",t.setValue(e,{value:l.userValue.toString()}),p.target.value=l.userValue},formattedValue(p){const{formattedValue:f}=p.detail;l.formattedValue=f,f!=null&&p.target!==document.activeElement&&(p.target.value=f),t.setValue(e,{formattedValue:f})},selRange(p){p.target.setSelectionRange(...p.detail.selRange)},charLimit:p=>{const{charLimit:f}=p.detail,{target:m}=p;if(f===0){m.removeAttribute("maxLength");return}m.setAttribute("maxLength",f);let b=l.userValue;!b||b.length<=f||(b=b.slice(0,f),m.value=l.userValue=b,t.setValue(e,{value:b}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:b,willCommit:!0,commitKey:1,selStart:m.selectionStart,selEnd:m.selectionEnd}}))}};this._dispatchEventFromSandbox(u,d)}),i.addEventListener("keydown",d=>{l.commitKey=1;let u=-1;if(d.key==="Escape"?u=0:d.key==="Enter"&&!this.data.multiLine?u=2:d.key==="Tab"&&(l.commitKey=3),u===-1)return;const{value:p}=d.target;l.lastCommittedValue!==p&&(l.lastCommittedValue=p,l.userValue=p,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:p,willCommit:!0,commitKey:u,selStart:d.target.selectionStart,selEnd:d.target.selectionEnd}}))});const h=c;c=null,i.addEventListener("blur",d=>{if(!l.focused||!d.relatedTarget)return;this.data.actions?.Blur||(l.focused=!1);const{value:u}=d.target;l.userValue=u,l.lastCommittedValue!==u&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:u,willCommit:!0,commitKey:l.commitKey,selStart:d.target.selectionStart,selEnd:d.target.selectionEnd}}),h(d)}),this.data.actions?.Keystroke&&i.addEventListener("beforeinput",d=>{l.lastCommittedValue=null;const{data:u,target:p}=d,{value:f,selectionStart:m,selectionEnd:b}=p;let g=m,y=b;switch(d.inputType){case"deleteWordBackward":{const x=f.substring(0,m).match(/\w*[^\w]*$/);x&&(g-=x[0].length);break}case"deleteWordForward":{const x=f.substring(m).match(/^[^\w]*\w*/);x&&(y+=x[0].length);break}case"deleteContentBackward":m===b&&(g-=1);break;case"deleteContentForward":m===b&&(y+=1);break}d.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:f,change:u||"",willCommit:!1,selStart:g,selEnd:y}})}),this._setEventListeners(i,l,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],d=>d.target.value)}if(c&&i.addEventListener("blur",c),this.data.comb){const d=(this.data.rect[2]-this.data.rect[0])/a;i.classList.add("comb"),i.style.letterSpacing=`calc(${d}px * var(--scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class ld extends Pe{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class cd extends Pe{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,i=e.id;let n=t.getValue(i,{value:e.exportValue===e.fieldValue}).value;typeof n=="string"&&(n=n!=="Off",t.setValue(i,{value:n})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const s=document.createElement("input");return xe.add(s),s.setAttribute("data-element-id",i),s.disabled=e.readOnly,this._setRequired(s,this.data.required),s.type="checkbox",s.name=e.fieldName,n&&s.setAttribute("checked",!0),s.setAttribute("exportValue",e.exportValue),s.tabIndex=di,s.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const c of this._getElementsByName(o,i)){const h=l&&c.exportValue===e.exportValue;c.domElement&&(c.domElement.checked=h),t.setValue(c.id,{value:h})}t.setValue(i,{value:l})}),s.addEventListener("resetform",a=>{const o=e.defaultFieldValue||"Off";a.target.checked=o===e.exportValue}),this.enableScripting&&this.hasJSActions&&(s.addEventListener("updatefromsandbox",a=>{const o={value(l){l.target.checked=l.detail.value!=="Off",t.setValue(i,{value:l.target.checked})}};this._dispatchEventFromSandbox(o,a)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class Ka extends Pe{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,i=e.id;let n=t.getValue(i,{value:e.fieldValue===e.buttonValue}).value;if(typeof n=="string"&&(n=n!==e.buttonValue,t.setValue(i,{value:n})),n)for(const a of this._getElementsByName(e.fieldName,i))t.setValue(a.id,{value:!1});const s=document.createElement("input");if(xe.add(s),s.setAttribute("data-element-id",i),s.disabled=e.readOnly,this._setRequired(s,this.data.required),s.type="radio",s.name=e.fieldName,n&&s.setAttribute("checked",!0),s.tabIndex=di,s.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const c of this._getElementsByName(o,i))t.setValue(c.id,{value:!1});t.setValue(i,{value:l})}),s.addEventListener("resetform",a=>{const o=e.defaultFieldValue;a.target.checked=o!=null&&o===e.buttonValue}),this.enableScripting&&this.hasJSActions){const a=e.buttonValue;s.addEventListener("updatefromsandbox",o=>{const l={value:c=>{const h=a===c.detail.value;for(const d of this._getElementsByName(c.target.name)){const u=h&&d.id===i;d.domElement&&(d.domElement.checked=u),t.setValue(d.id,{value:u})}}};this._dispatchEventFromSandbox(l,o)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class hd extends Xa{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),t}}class dd extends Pe{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,i=t.getValue(e,{value:this.data.fieldValue}),n=document.createElement("select");xe.add(n),n.setAttribute("data-element-id",e),n.disabled=this.data.readOnly,this._setRequired(n,this.data.required),n.name=this.data.fieldName,n.tabIndex=di;let s=this.data.combo&&this.data.options.length>0;this.data.combo||(n.size=this.data.options.length,this.data.multiSelect&&(n.multiple=!0)),n.addEventListener("resetform",h=>{const d=this.data.defaultFieldValue;for(const u of n.options)u.selected=u.value===d});for(const h of this.data.options){const d=document.createElement("option");d.textContent=h.displayValue,d.value=h.exportValue,i.value.includes(h.exportValue)&&(d.setAttribute("selected",!0),s=!1),n.append(d)}let a=null;if(s){const h=document.createElement("option");h.value=" ",h.setAttribute("hidden",!0),h.setAttribute("selected",!0),n.prepend(h),a=()=>{h.remove(),n.removeEventListener("input",a),a=null},n.addEventListener("input",a)}const o=h=>{const d=h?"value":"textContent",{options:u,multiple:p}=n;return p?Array.prototype.filter.call(u,f=>f.selected).map(f=>f[d]):u.selectedIndex===-1?null:u[u.selectedIndex][d]};let l=o(!1);const c=h=>{const d=h.target.options;return Array.prototype.map.call(d,u=>({displayValue:u.textContent,exportValue:u.value}))};return this.enableScripting&&this.hasJSActions?(n.addEventListener("updatefromsandbox",h=>{const d={value(u){a?.();const p=u.detail.value,f=new Set(Array.isArray(p)?p:[p]);for(const m of n.options)m.selected=f.has(m.value);t.setValue(e,{value:o(!0)}),l=o(!1)},multipleSelection(u){n.multiple=!0},remove(u){const p=n.options,f=u.detail.remove;p[f].selected=!1,n.remove(f),p.length>0&&Array.prototype.findIndex.call(p,b=>b.selected)===-1&&(p[0].selected=!0),t.setValue(e,{value:o(!0),items:c(u)}),l=o(!1)},clear(u){for(;n.length!==0;)n.remove(0);t.setValue(e,{value:null,items:[]}),l=o(!1)},insert(u){const{index:p,displayValue:f,exportValue:m}=u.detail.insert,b=n.children[p],g=document.createElement("option");g.textContent=f,g.value=m,b?b.before(g):n.append(g),t.setValue(e,{value:o(!0),items:c(u)}),l=o(!1)},items(u){const{items:p}=u.detail;for(;n.length!==0;)n.remove(0);for(const f of p){const{displayValue:m,exportValue:b}=f,g=document.createElement("option");g.textContent=m,g.value=b,n.append(g)}n.options.length>0&&(n.options[0].selected=!0),t.setValue(e,{value:o(!0),items:c(u)}),l=o(!1)},indices(u){const p=new Set(u.detail.indices);for(const f of u.target.options)f.selected=p.has(f.index);t.setValue(e,{value:o(!0)}),l=o(!1)},editable(u){u.target.disabled=!u.detail.editable}};this._dispatchEventFromSandbox(d,h)}),n.addEventListener("input",h=>{const d=o(!0),u=o(!1);t.setValue(e,{value:d}),h.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:l,change:u,changeEx:d,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(n,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],h=>h.target.value)):n.addEventListener("input",function(h){t.setValue(e,{value:o(!0)})}),this.data.combo&&this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class Bn extends yt{constructor(t){const{data:e,elements:i}=t;super(t,{isRenderable:yt._hasPopupData(e)}),this.elements=i,this.popup=null}render(){this.container.classList.add("popupAnnotation");const t=this.popup=new ud({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),e=[];for(const i of this.elements)i.popup=t,e.push(i.data.id),i.addHighlightArea();return this.container.setAttribute("aria-controls",e.map(i=>`${ka}${i}`).join(",")),this.container}}class ud{#t=this.#T.bind(this);#e=this.#w.bind(this);#i=this.#E.bind(this);#s=this.#b.bind(this);#a=null;#n=null;#r=null;#c=null;#l=null;#d=null;#f=null;#h=!1;#o=null;#p=null;#g=null;#u=null;#v=null;#m=null;#y=!1;constructor({container:t,color:e,elements:i,titleObj:n,modificationDate:s,contentsObj:a,richText:o,parent:l,rect:c,parentRect:h,open:d}){this.#n=t,this.#v=n,this.#r=a,this.#u=o,this.#d=l,this.#a=e,this.#g=c,this.#f=h,this.#l=i,this.#c=Da.toDateObject(s),this.trigger=i.flatMap(u=>u.getElementsToTriggerPopup());for(const u of this.trigger)u.addEventListener("click",this.#s),u.addEventListener("mouseenter",this.#i),u.addEventListener("mouseleave",this.#e),u.classList.add("popupTriggerArea");for(const u of i)u.container?.addEventListener("keydown",this.#t);this.#n.hidden=!0,d&&this.#b()}render(){if(this.#o)return;const t=this.#o=document.createElement("div");if(t.className="popup",this.#a){const s=t.style.outlineColor=q.makeHexColor(...this.#a);CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?t.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`:t.style.backgroundColor=q.makeHexColor(...this.#a.map(o=>Math.floor(.7*(255-o)+o)))}const e=document.createElement("span");e.className="header";const i=document.createElement("h1");if(e.append(i),{dir:i.dir,str:i.textContent}=this.#v,t.append(e),this.#c){const s=document.createElement("span");s.classList.add("popupDate"),s.setAttribute("data-l10n-id","pdfjs-annotation-date-string"),s.setAttribute("data-l10n-args",JSON.stringify({date:this.#c.toLocaleDateString(),time:this.#c.toLocaleTimeString()})),e.append(s)}const n=this.#A;if(n)qa.render({xfaHtml:n,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const s=this._formatContents(this.#r);t.append(s)}this.#n.append(t)}get#A(){const t=this.#u,e=this.#r;return t?.str&&(!e?.str||e.str===t.str)&&this.#u.html||null}get#x(){return this.#A?.attributes?.style?.fontSize||0}get#S(){return this.#A?.attributes?.style?.color||null}#P(t){const e=[],i={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},n={style:{color:this.#S,fontSize:this.#x?`calc(${this.#x}px * var(--scale-factor))`:""}};for(const s of t.split(`
`))e.push({name:"span",value:s,attributes:n});return i}_formatContents({str:t,dir:e}){const i=document.createElement("p");i.classList.add("popupContent"),i.dir=e;const n=t.split(/(?:\r\n?|\n)/);for(let s=0,a=n.length;s<a;++s){const o=n[s];i.append(document.createTextNode(o)),s<a-1&&i.append(document.createElement("br"))}return i}#T(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#h)&&this.#b()}updateEdited({rect:t,popupContent:e}){this.#m||={contentsObj:this.#r,richText:this.#u},t&&(this.#p=null),e&&(this.#u=this.#P(e),this.#r=null),this.#o?.remove(),this.#o=null}resetEdited(){this.#m&&({contentsObj:this.#r,richText:this.#u}=this.#m,this.#m=null,this.#o?.remove(),this.#o=null,this.#p=null)}#_(){if(this.#p!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:i,pageX:n,pageY:s}}}=this.#d;let a=!!this.#f,o=a?this.#f:this.#g;for(const f of this.#l)if(!o||q.intersect(f.data.rect,o)!==null){o=f.data.rect,a=!0;break}const l=q.normalizeRect([o[0],t[3]-o[1]+t[1],o[2],t[3]-o[3]+t[1]]),h=a?o[2]-o[0]+5:0,d=l[0]+h,u=l[1];this.#p=[100*(d-n)/e,100*(u-s)/i];const{style:p}=this.#n;p.left=`${this.#p[0]}%`,p.top=`${this.#p[1]}%`}#b(){this.#h=!this.#h,this.#h?(this.#E(),this.#n.addEventListener("click",this.#s),this.#n.addEventListener("keydown",this.#t)):(this.#w(),this.#n.removeEventListener("click",this.#s),this.#n.removeEventListener("keydown",this.#t))}#E(){this.#o||this.render(),this.isVisible?this.#h&&this.#n.classList.add("focused"):(this.#_(),this.#n.hidden=!1,this.#n.style.zIndex=parseInt(this.#n.style.zIndex)+1e3)}#w(){this.#n.classList.remove("focused"),!(this.#h||!this.isVisible)&&(this.#n.hidden=!0,this.#n.style.zIndex=parseInt(this.#n.style.zIndex)-1e3)}forceHide(){this.#y=this.isVisible,this.#y&&(this.#n.hidden=!0)}maybeShow(){this.#y&&(this.#o||this.#E(),this.#y=!1,this.#n.hidden=!1)}get isVisible(){return this.#n.hidden===!1}}class Za extends yt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=dt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const i=document.createElement("span");i.textContent=e,t.append(i)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}get _isEditable(){return this.data.hasOwnCanvas}}class fd extends yt{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const t=this.data,{width:e,height:i}=oe(t.rect),n=this.svgFactory.create(e,i,!0),s=this.#t=this.svgFactory.createElement("svg:line");return s.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),s.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),s.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),s.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),s.setAttribute("stroke-width",t.borderStyle.width||1),s.setAttribute("stroke","transparent"),s.setAttribute("fill","transparent"),n.append(s),this.container.append(n),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class pd extends yt{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const t=this.data,{width:e,height:i}=oe(t.rect),n=this.svgFactory.create(e,i,!0),s=t.borderStyle.width,a=this.#t=this.svgFactory.createElement("svg:rect");return a.setAttribute("x",s/2),a.setAttribute("y",s/2),a.setAttribute("width",e-s),a.setAttribute("height",i-s),a.setAttribute("stroke-width",s||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),n.append(a),this.container.append(n),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class gd extends yt{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const t=this.data,{width:e,height:i}=oe(t.rect),n=this.svgFactory.create(e,i,!0),s=t.borderStyle.width,a=this.#t=this.svgFactory.createElement("svg:ellipse");return a.setAttribute("cx",e/2),a.setAttribute("cy",i/2),a.setAttribute("rx",e/2-s/2),a.setAttribute("ry",i/2-s/2),a.setAttribute("stroke-width",s||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),n.append(a),this.container.append(n),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Qa extends yt{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const t=this.data,{width:e,height:i}=oe(t.rect),n=this.svgFactory.create(e,i,!0);let s=[];for(const o of t.vertices){const l=o.x-t.rect[0],c=t.rect[3]-o.y;s.push(l+","+c)}s=s.join(" ");const a=this.#t=this.svgFactory.createElement(this.svgElementName);return a.setAttribute("points",s),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),n.append(a),this.container.append(n),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class md extends Qa{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class bd extends yt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Ja extends yt{#t=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=dt.INK}render(){this.container.classList.add(this.containerClassName);const t=this.data,{width:e,height:i}=oe(t.rect),n=this.svgFactory.create(e,i,!0);for(const s of t.inkLists){let a=[];for(const l of s){const c=l.x-t.rect[0],h=t.rect[3]-l.y;a.push(`${c},${h}`)}a=a.join(" ");const o=this.svgFactory.createElement(this.svgElementName);this.#t.push(o),o.setAttribute("points",a),o.setAttribute("stroke-width",t.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),!t.popupRef&&this.hasPopupData&&this._createPopup(),n.append(o)}return this.container.append(n),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class vd extends yt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class yd extends yt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class _d extends yt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class Ad extends yt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class to extends yt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Ed extends yt{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:e}=this.data;this.filename=e.filename,this.content=e.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...e})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:e}=this;let i;e.hasAppearance||e.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(e.name)?"paperclip":"pushpin"}.svg`,e.fillAlpha&&e.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(e.fillAlpha*100)}%);`)),i.addEventListener("dblclick",this.#e.bind(this)),this.#t=i;const{isMac:n}=Bt.platform;return t.addEventListener("keydown",s=>{s.key==="Enter"&&(n?s.metaKey:s.ctrlKey)&&this.#e()}),!e.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}let wd=class{#t=null;#e=null;#i=new Map;constructor({div:t,accessibilityManager:e,annotationCanvasMap:i,annotationEditorUIManager:n,page:s,viewport:a}){this.div=t,this.#t=e,this.#e=i,this.page=s,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=n}#s(t,e){const i=t.firstChild||t;i.id=`${ka}${e}`,this.div.append(t),this.#t?.moveElementInDOM(this.div,t,i,!1)}async render(t){const{annotations:e}=t,i=this.div;we(i,this.viewport);const n=new Map,s={data:null,layer:i,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new Jn,annotationStorage:t.annotationStorage||new os,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const a of e){if(a.noHTML)continue;const o=a.annotationType===wt.POPUP;if(o){const h=n.get(a.id);if(!h)continue;s.elements=h}else{const{width:h,height:d}=oe(a.rect);if(h<=0||d<=0)continue}s.data=a;const l=rd.create(s);if(!l.isRenderable)continue;if(!o&&a.popupRef){const h=n.get(a.popupRef);h?h.push(l):n.set(a.popupRef,[l])}const c=l.render();a.hidden&&(c.style.visibility="hidden"),this.#s(c,a.id),l.annotationEditorType>0&&(this.#i.set(l.data.id,l),this._annotationEditorUIManager?.renderAnnotationElement(l))}this.#a()}update({viewport:t}){const e=this.div;this.viewport=t,we(e,{rotation:t.rotation}),this.#a(),e.hidden=!1}#a(){if(!this.#e)return;const t=this.div;for(const[e,i]of this.#e){const n=t.querySelector(`[data-annotation-id="${e}"]`);if(!n)continue;i.className="annotationContent";const{firstChild:s}=n;s?s.nodeName==="CANVAS"?s.replaceWith(i):s.classList.contains("annotationContent")?s.after(i):s.before(i):n.append(i)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#i.values())}getEditableAnnotation(t){return this.#i.get(t)}};const Ai=/\r\n?|\n/g;class xt extends nt{#t=this.editorDivBlur.bind(this);#e=this.editorDivFocus.bind(this);#i=this.editorDivInput.bind(this);#s=this.editorDivKeydown.bind(this);#a=this.editorDivPaste.bind(this);#n;#r="";#c=`${this.id}-editor`;#l;#d=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=xt.prototype,e=s=>s.isEmpty(),i=pe.TRANSLATE_SMALL,n=pe.TRANSLATE_BIG;return ut(this,"_keyboardManager",new ci([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-n,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[n,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-n],checker:e}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,n],checker:e}]]))}static _type="freetext";static _editorType=dt.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.#n=t.color||xt._defaultColor||nt._defaultLineColor,this.#l=t.fontSize||xt._defaultFontSize}static initialize(t,e){nt.initialize(t,e,{strings:["pdfjs-free-text-default-content"]});const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,e){switch(t){case st.FREETEXT_SIZE:xt._defaultFontSize=e;break;case st.FREETEXT_COLOR:xt._defaultColor=e;break}}updateParams(t,e){switch(t){case st.FREETEXT_SIZE:this.#f(e);break;case st.FREETEXT_COLOR:this.#h(e);break}}static get defaultPropertiesToUpdate(){return[[st.FREETEXT_SIZE,xt._defaultFontSize],[st.FREETEXT_COLOR,xt._defaultColor||nt._defaultLineColor]]}get propertiesToUpdate(){return[[st.FREETEXT_SIZE,this.#l],[st.FREETEXT_COLOR,this.#n]]}#f(t){const e=n=>{this.editorDiv.style.fontSize=`calc(${n}px * var(--scale-factor))`,this.translate(0,-(n-this.#l)*this.parentScale),this.#l=n,this.#p()},i=this.#l;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:st.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#h(t){const e=n=>{this.#n=this.editorDiv.style.color=n},i=this.#n;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:st.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,e){this._uiManager.translateSelectedEditors(t,e,!0)}getInitialTranslation(){const t=this.parentScale;return[-xt._internalPadding*t,-(xt._internalPadding+this.#l)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(dt.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",this.#s),this.editorDiv.addEventListener("focus",this.#e),this.editorDiv.addEventListener("blur",this.#t),this.editorDiv.addEventListener("input",this.#i),this.editorDiv.addEventListener("paste",this.#a))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#c),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",this.#s),this.editorDiv.removeEventListener("focus",this.#e),this.editorDiv.removeEventListener("blur",this.#t),this.editorDiv.removeEventListener("input",this.#i),this.editorDiv.removeEventListener("paste",this.#a),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#o(){const t=[];this.editorDiv.normalize();for(const e of this.editorDiv.childNodes)t.push(xt.#g(e));return t.join(`
`)}#p(){const[t,e]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:n,div:s}=this,a=s.style.display,o=s.classList.contains("hidden");s.classList.remove("hidden"),s.style.display="hidden",n.div.append(this.div),i=s.getBoundingClientRect(),s.remove(),s.style.display=a,s.classList.toggle("hidden",o)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/e):(this.width=i.height/t,this.height=i.width/e),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#r,e=this.#r=this.#o().trimEnd();if(t===e)return;const i=n=>{if(this.#r=n,!n){this.remove();return}this.#u(),this._uiManager.rebuild(this),this.#p()};this.addCommands({cmd:()=>{i(e)},undo:()=>{i(t)},mustExec:!1}),this.#p()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(t){this.enterInEditMode()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){xt._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let t,e;this.width&&(t=this.x,e=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#c),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text"),this.enableEditing(),nt._l10nPromise.get("pdfjs-free-text-default-content").then(n=>this.editorDiv?.setAttribute("default-content",n)),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${this.#l}px * var(--scale-factor))`,i.color=this.#n,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),Ii(this,this.div,["dblclick","keydown"]),this.width){const[n,s]=this.parentDimensions;if(this.annotationElementId){const{position:a}=this.#d;let[o,l]=this.getInitialTranslation();[o,l]=this.pageTranslationToScreen(o,l);const[c,h]=this.pageDimensions,[d,u]=this.pageTranslation;let p,f;switch(this.rotation){case 0:p=t+(a[0]-d)/c,f=e+this.height-(a[1]-u)/h;break;case 90:p=t+(a[0]-d)/c,f=e-(a[1]-u)/h,[o,l]=[l,-o];break;case 180:p=t-this.width+(a[0]-d)/c,f=e-(a[1]-u)/h,[o,l]=[-o,-l];break;case 270:p=t+(a[0]-d-this.height*h)/c,f=e+(a[1]-u-this.width*c)/h,[o,l]=[-l,o];break}this.setAt(p*n,f*s,o,l)}else this.setAt(t*n,e*s,this.width*n,this.height*s);this.#u(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#g(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Ai,"")}editorDivPaste(t){const e=t.clipboardData||window.clipboardData,{types:i}=e;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const n=xt.#m(e.getData("text")||"").replaceAll(Ai,`
`);if(!n)return;const s=window.getSelection();if(!s.rangeCount)return;this.editorDiv.normalize(),s.deleteFromDocument();const a=s.getRangeAt(0);if(!n.includes(`
`)){a.insertNode(document.createTextNode(n)),this.editorDiv.normalize(),s.collapseToStart();return}const{startContainer:o,startOffset:l}=a,c=[],h=[];if(o.nodeType===Node.TEXT_NODE){const p=o.parentElement;if(h.push(o.nodeValue.slice(l).replaceAll(Ai,"")),p!==this.editorDiv){let f=c;for(const m of this.editorDiv.childNodes){if(m===p){f=h;continue}f.push(xt.#g(m))}}c.push(o.nodeValue.slice(0,l).replaceAll(Ai,""))}else if(o===this.editorDiv){let p=c,f=0;for(const m of this.editorDiv.childNodes)f++===l&&(p=h),p.push(xt.#g(m))}this.#r=`${c.join(`
`)}${n}${h.join(`
`)}`,this.#u();const d=new Range;let u=c.reduce((p,f)=>p+f.length,0);for(const{firstChild:p}of this.editorDiv.childNodes)if(p.nodeType===Node.TEXT_NODE){const f=p.nodeValue.length;if(u<=f){d.setStart(p,u),d.setEnd(p,u);break}u-=f}s.removeAllRanges(),s.addRange(d)}#u(){if(this.editorDiv.replaceChildren(),!!this.#r)for(const t of this.#r.split(`
`)){const e=document.createElement("div");e.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(e)}}#v(){return this.#r.replaceAll(""," ")}static#m(t){return t.replaceAll(" ","")}get contentDiv(){return this.editorDiv}static deserialize(t,e,i){let n=null;if(t instanceof Za){const{data:{defaultAppearanceData:{fontSize:a,fontColor:o},rect:l,rotation:c,id:h},textContent:d,textPosition:u,parent:{page:{pageNumber:p}}}=t;if(!d||d.length===0)return null;n=t={annotationType:dt.FREETEXT,color:Array.from(o),fontSize:a,value:d.join(`
`),position:u,pageIndex:p-1,rect:l.slice(0),rotation:c,id:h,deleted:!1}}const s=super.deserialize(t,e,i);return s.#l=t.fontSize,s.#n=q.makeHexColor(...t.color),s.#r=xt.#m(t.value),s.annotationElementId=t.id||null,s.#d=n,s}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const e=xt._internalPadding*this.parentScale,i=this.getRect(e,e),n=nt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#n),s={annotationType:dt.FREETEXT,color:n,fontSize:this.#l,value:this.#v(),pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?s:this.annotationElementId&&!this.#y(s)?null:(s.id=this.annotationElementId,s)}#y(t){const{value:e,fontSize:i,color:n,pageIndex:s}=this.#d;return this._hasBeenMoved||t.value!==e||t.fontSize!==i||t.color.some((a,o)=>a!==n[o])||t.pageIndex!==s}renderAnnotationElement(t){const e=super.renderAnnotationElement(t);if(this.deleted)return e;const{style:i}=e;i.fontSize=`calc(${this.#l}px * var(--scale-factor))`,i.color=this.#n,e.replaceChildren();for(const s of this.#r.split(`
`)){const a=document.createElement("div");a.append(s?document.createTextNode(s):document.createElement("br")),e.append(a)}const n=xt._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(n,n),popupContent:this.#r}),e}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class jn{#t;#e=[];#i=[];constructor(t,e=0,i=0,n=!0){let s=1/0,a=-1/0,o=1/0,l=-1/0;const c=10**-4;for(const{x:b,y:g,width:y,height:x}of t){const w=Math.floor((b-e)/c)*c,v=Math.ceil((b+y+e)/c)*c,R=Math.floor((g-e)/c)*c,I=Math.ceil((g+x+e)/c)*c,j=[w,R,I,!0],H=[v,R,I,!1];this.#e.push(j,H),s=Math.min(s,w),a=Math.max(a,v),o=Math.min(o,R),l=Math.max(l,I)}const h=a-s+2*i,d=l-o+2*i,u=s-i,p=o-i,f=this.#e.at(n?-1:-2),m=[f[0],f[2]];for(const b of this.#e){const[g,y,x]=b;b[0]=(g-u)/h,b[1]=(y-p)/d,b[2]=(x-p)/d}this.#t={x:u,y:p,width:h,height:d,lastPoint:m}}getOutlines(){this.#e.sort((e,i)=>e[0]-i[0]||e[1]-i[1]||e[2]-i[2]);const t=[];for(const e of this.#e)e[3]?(t.push(...this.#c(e)),this.#n(e)):(this.#r(e),t.push(...this.#c(e)));return this.#s(t)}#s(t){const e=[],i=new Set;for(const a of t){const[o,l,c]=a;e.push([o,l,a],[o,c,a])}e.sort((a,o)=>a[1]-o[1]||a[0]-o[0]);for(let a=0,o=e.length;a<o;a+=2){const l=e[a][2],c=e[a+1][2];l.push(c),c.push(l),i.add(l),i.add(c)}const n=[];let s;for(;i.size>0;){const a=i.values().next().value;let[o,l,c,h,d]=a;i.delete(a);let u=o,p=l;for(s=[o,c],n.push(s);;){let f;if(i.has(h))f=h;else if(i.has(d))f=d;else break;i.delete(f),[o,l,c,h,d]=f,u!==o&&(s.push(u,p,o,p===l?l:c),u=o),p=p===l?c:l}s.push(u,p)}return new xd(n,this.#t)}#a(t){const e=this.#i;let i=0,n=e.length-1;for(;i<=n;){const s=i+n>>1,a=e[s][0];if(a===t)return s;a<t?i=s+1:n=s-1}return n+1}#n([,t,e]){const i=this.#a(t);this.#i.splice(i,0,[t,e])}#r([,t,e]){const i=this.#a(t);for(let n=i;n<this.#i.length;n++){const[s,a]=this.#i[n];if(s!==t)break;if(s===t&&a===e){this.#i.splice(n,1);return}}for(let n=i-1;n>=0;n--){const[s,a]=this.#i[n];if(s!==t)break;if(s===t&&a===e){this.#i.splice(n,1);return}}}#c(t){const[e,i,n]=t,s=[[e,i,n]],a=this.#a(n);for(let o=0;o<a;o++){const[l,c]=this.#i[o];for(let h=0,d=s.length;h<d;h++){const[,u,p]=s[h];if(!(c<=u||p<=l)){if(u>=l){if(p>c)s[h][1]=c;else{if(d===1)return[];s.splice(h,1),h--,d--}continue}s[h][2]=l,p>c&&s.push([e,c,p])}}}return s}}class eo{toSVGPath(){throw new Error("Abstract method `toSVGPath` must be implemented.")}get box(){throw new Error("Abstract getter `box` must be implemented.")}serialize(t,e){throw new Error("Abstract method `serialize` must be implemented.")}get free(){return this instanceof Hn}}class xd extends eo{#t;#e;constructor(t,e){super(),this.#e=t,this.#t=e}toSVGPath(){const t=[];for(const e of this.#e){let[i,n]=e;t.push(`M${i} ${n}`);for(let s=2;s<e.length;s+=2){const a=e[s],o=e[s+1];a===i?(t.push(`V${o}`),n=o):o===n&&(t.push(`H${a}`),i=a)}t.push("Z")}return t.join(" ")}serialize([t,e,i,n],s){const a=[],o=i-t,l=n-e;for(const c of this.#e){const h=new Array(c.length);for(let d=0;d<c.length;d+=2)h[d]=t+c[d]*o,h[d+1]=n-c[d+1]*l;a.push(h)}return a}get box(){return this.#t}}class _e{#t;#e=[];#i;#s;#a=[];#n=new Float64Array(18);#r;#c;#l;#d;#f;#h;#o=[];static#p=8;static#g=2;static#u=_e.#p+_e.#g;constructor({x:t,y:e},i,n,s,a,o=0){this.#t=i,this.#h=s*n,this.#s=a,this.#n.set([NaN,NaN,NaN,NaN,t,e],6),this.#i=o,this.#d=_e.#p*n,this.#l=_e.#u*n,this.#f=n,this.#o.push(t,e)}get free(){return!0}isEmpty(){return isNaN(this.#n[8])}#v(){const t=this.#n.subarray(4,6),e=this.#n.subarray(16,18),[i,n,s,a]=this.#t;return[(this.#r+(t[0]-e[0])/2-i)/s,(this.#c+(t[1]-e[1])/2-n)/a,(this.#r+(e[0]-t[0])/2-i)/s,(this.#c+(e[1]-t[1])/2-n)/a]}add({x:t,y:e}){this.#r=t,this.#c=e;const[i,n,s,a]=this.#t;let[o,l,c,h]=this.#n.subarray(8,12);const d=t-c,u=e-h,p=Math.hypot(d,u);if(p<this.#l)return!1;const f=p-this.#d,m=f/p,b=m*d,g=m*u;let y=o,x=l;o=c,l=h,c+=b,h+=g,this.#o?.push(t,e);const w=-g/f,v=b/f,R=w*this.#h,I=v*this.#h;return this.#n.set(this.#n.subarray(2,8),0),this.#n.set([c+R,h+I],4),this.#n.set(this.#n.subarray(14,18),12),this.#n.set([c-R,h-I],16),isNaN(this.#n[6])?(this.#a.length===0&&(this.#n.set([o+R,l+I],2),this.#a.push(NaN,NaN,NaN,NaN,(o+R-i)/s,(l+I-n)/a),this.#n.set([o-R,l-I],14),this.#e.push(NaN,NaN,NaN,NaN,(o-R-i)/s,(l-I-n)/a)),this.#n.set([y,x,o,l,c,h],6),!this.isEmpty()):(this.#n.set([y,x,o,l,c,h],6),Math.abs(Math.atan2(x-l,y-o)-Math.atan2(g,b))<Math.PI/2?([o,l,c,h]=this.#n.subarray(2,6),this.#a.push(NaN,NaN,NaN,NaN,((o+c)/2-i)/s,((l+h)/2-n)/a),[o,l,y,x]=this.#n.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((y+o)/2-i)/s,((x+l)/2-n)/a),!0):([y,x,o,l,c,h]=this.#n.subarray(0,6),this.#a.push(((y+5*o)/6-i)/s,((x+5*l)/6-n)/a,((5*o+c)/6-i)/s,((5*l+h)/6-n)/a,((o+c)/2-i)/s,((l+h)/2-n)/a),[c,h,o,l,y,x]=this.#n.subarray(12,18),this.#e.push(((y+5*o)/6-i)/s,((x+5*l)/6-n)/a,((5*o+c)/6-i)/s,((5*l+h)/6-n)/a,((o+c)/2-i)/s,((l+h)/2-n)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#a,e=this.#e,i=this.#n.subarray(4,6),n=this.#n.subarray(16,18),[s,a,o,l]=this.#t,[c,h,d,u]=this.#v();if(isNaN(this.#n[6])&&!this.isEmpty())return`M${(this.#n[2]-s)/o} ${(this.#n[3]-a)/l} L${(this.#n[4]-s)/o} ${(this.#n[5]-a)/l} L${c} ${h} L${d} ${u} L${(this.#n[16]-s)/o} ${(this.#n[17]-a)/l} L${(this.#n[14]-s)/o} ${(this.#n[15]-a)/l} Z`;const p=[];p.push(`M${t[4]} ${t[5]}`);for(let f=6;f<t.length;f+=6)isNaN(t[f])?p.push(`L${t[f+4]} ${t[f+5]}`):p.push(`C${t[f]} ${t[f+1]} ${t[f+2]} ${t[f+3]} ${t[f+4]} ${t[f+5]}`);p.push(`L${(i[0]-s)/o} ${(i[1]-a)/l} L${c} ${h} L${d} ${u} L${(n[0]-s)/o} ${(n[1]-a)/l}`);for(let f=e.length-6;f>=6;f-=6)isNaN(e[f])?p.push(`L${e[f+4]} ${e[f+5]}`):p.push(`C${e[f]} ${e[f+1]} ${e[f+2]} ${e[f+3]} ${e[f+4]} ${e[f+5]}`);return p.push(`L${e[4]} ${e[5]} Z`),p.join(" ")}getOutlines(){const t=this.#a,e=this.#e,i=this.#n,n=i.subarray(4,6),s=i.subarray(16,18),[a,o,l,c]=this.#t,h=new Float64Array((this.#o?.length??0)+2);for(let g=0,y=h.length-2;g<y;g+=2)h[g]=(this.#o[g]-a)/l,h[g+1]=(this.#o[g+1]-o)/c;h[h.length-2]=(this.#r-a)/l,h[h.length-1]=(this.#c-o)/c;const[d,u,p,f]=this.#v();if(isNaN(i[6])&&!this.isEmpty()){const g=new Float64Array(36);return g.set([NaN,NaN,NaN,NaN,(i[2]-a)/l,(i[3]-o)/c,NaN,NaN,NaN,NaN,(i[4]-a)/l,(i[5]-o)/c,NaN,NaN,NaN,NaN,d,u,NaN,NaN,NaN,NaN,p,f,NaN,NaN,NaN,NaN,(i[16]-a)/l,(i[17]-o)/c,NaN,NaN,NaN,NaN,(i[14]-a)/l,(i[15]-o)/c],0),new Hn(g,h,this.#t,this.#f,this.#i,this.#s)}const m=new Float64Array(this.#a.length+24+this.#e.length);let b=t.length;for(let g=0;g<b;g+=2){if(isNaN(t[g])){m[g]=m[g+1]=NaN;continue}m[g]=t[g],m[g+1]=t[g+1]}m.set([NaN,NaN,NaN,NaN,(n[0]-a)/l,(n[1]-o)/c,NaN,NaN,NaN,NaN,d,u,NaN,NaN,NaN,NaN,p,f,NaN,NaN,NaN,NaN,(s[0]-a)/l,(s[1]-o)/c],b),b+=24;for(let g=e.length-6;g>=6;g-=6)for(let y=0;y<6;y+=2){if(isNaN(e[g+y])){m[b]=m[b+1]=NaN,b+=2;continue}m[b]=e[g+y],m[b+1]=e[g+y+1],b+=2}return m.set([NaN,NaN,NaN,NaN,e[4],e[5]],b),new Hn(m,h,this.#t,this.#f,this.#i,this.#s)}}class Hn extends eo{#t;#e=null;#i;#s;#a;#n;#r;constructor(t,e,i,n,s,a){super(),this.#r=t,this.#a=e,this.#t=i,this.#n=n,this.#i=s,this.#s=a,this.#d(a);const{x:o,y:l,width:c,height:h}=this.#e;for(let d=0,u=t.length;d<u;d+=2)t[d]=(t[d]-o)/c,t[d+1]=(t[d+1]-l)/h;for(let d=0,u=e.length;d<u;d+=2)e[d]=(e[d]-o)/c,e[d+1]=(e[d+1]-l)/h}toSVGPath(){const t=[`M${this.#r[4]} ${this.#r[5]}`];for(let e=6,i=this.#r.length;e<i;e+=6){if(isNaN(this.#r[e])){t.push(`L${this.#r[e+4]} ${this.#r[e+5]}`);continue}t.push(`C${this.#r[e]} ${this.#r[e+1]} ${this.#r[e+2]} ${this.#r[e+3]} ${this.#r[e+4]} ${this.#r[e+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,e,i,n],s){const a=i-t,o=n-e;let l,c;switch(s){case 0:l=this.#c(this.#r,t,n,a,-o),c=this.#c(this.#a,t,n,a,-o);break;case 90:l=this.#l(this.#r,t,e,a,o),c=this.#l(this.#a,t,e,a,o);break;case 180:l=this.#c(this.#r,i,e,-a,o),c=this.#c(this.#a,i,e,-a,o);break;case 270:l=this.#l(this.#r,i,n,-a,-o),c=this.#l(this.#a,i,n,-a,-o);break}return{outline:Array.from(l),points:[Array.from(c)]}}#c(t,e,i,n,s){const a=new Float64Array(t.length);for(let o=0,l=t.length;o<l;o+=2)a[o]=e+t[o]*n,a[o+1]=i+t[o+1]*s;return a}#l(t,e,i,n,s){const a=new Float64Array(t.length);for(let o=0,l=t.length;o<l;o+=2)a[o]=e+t[o+1]*n,a[o+1]=i+t[o]*s;return a}#d(t){const e=this.#r;let i=e[4],n=e[5],s=i,a=n,o=i,l=n,c=i,h=n;const d=t?Math.max:Math.min;for(let b=6,g=e.length;b<g;b+=6){if(isNaN(e[b]))s=Math.min(s,e[b+4]),a=Math.min(a,e[b+5]),o=Math.max(o,e[b+4]),l=Math.max(l,e[b+5]),h<e[b+5]?(c=e[b+4],h=e[b+5]):h===e[b+5]&&(c=d(c,e[b+4]));else{const y=q.bezierBoundingBox(i,n,...e.slice(b,b+6));s=Math.min(s,y[0]),a=Math.min(a,y[1]),o=Math.max(o,y[2]),l=Math.max(l,y[3]),h<y[3]?(c=y[2],h=y[3]):h===y[3]&&(c=d(c,y[2]))}i=e[b+4],n=e[b+5]}const u=s-this.#i,p=a-this.#i,f=o-s+2*this.#i,m=l-a+2*this.#i;this.#e={x:u,y:p,width:f,height:m,lastPoint:[c,h]}}get box(){return this.#e}getNewOutline(t,e){const{x:i,y:n,width:s,height:a}=this.#e,[o,l,c,h]=this.#t,d=s*c,u=a*h,p=i*c+o,f=n*h+l,m=new _e({x:this.#a[0]*d+p,y:this.#a[1]*u+f},this.#t,this.#n,t,this.#s,e??this.#i);for(let b=2;b<this.#a.length;b+=2)m.add({x:this.#a[b]*d+p,y:this.#a[b+1]*u+f});return m.getOutlines()}}class Zt{#t=this.#g.bind(this);#e=this.#v.bind(this);#i=null;#s=null;#a;#n=null;#r=!1;#c=!1;#l=null;#d;#f=null;#h;static get _keyboardManager(){return ut(this,"_keyboardManager",new ci([[["Escape","mac+Escape"],Zt.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Zt.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Zt.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Zt.prototype._moveToPrevious],[["Home","mac+Home"],Zt.prototype._moveToBeginning],[["End","mac+End"],Zt.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:e=null}){t?(this.#c=!1,this.#h=st.HIGHLIGHT_COLOR,this.#l=t):(this.#c=!0,this.#h=st.HIGHLIGHT_DEFAULT_COLOR),this.#f=t?._uiManager||e,this.#d=this.#f._eventBus,this.#a=t?.color||this.#f?.highlightColors.values().next().value||"#FFFF98"}renderButton(){const t=this.#i=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.setAttribute("aria-haspopup",!0),t.addEventListener("click",this.#u.bind(this)),t.addEventListener("keydown",this.#t);const e=this.#s=document.createElement("span");return e.className="swatch",e.setAttribute("aria-hidden",!0),e.style.backgroundColor=this.#a,t.append(e),t}renderMainDropdown(){const t=this.#n=this.#o();return t.setAttribute("aria-orientation","horizontal"),t.setAttribute("aria-labelledby","highlightColorPickerLabel"),t}#o(){const t=document.createElement("div");t.addEventListener("contextmenu",jt),t.className="dropdown",t.role="listbox",t.setAttribute("aria-multiselectable",!1),t.setAttribute("aria-orientation","vertical"),t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[e,i]of this.#f.highlightColors){const n=document.createElement("button");n.tabIndex="0",n.role="option",n.setAttribute("data-color",i),n.title=e,n.setAttribute("data-l10n-id",`pdfjs-editor-colorpicker-${e}`);const s=document.createElement("span");n.append(s),s.className="swatch",s.style.backgroundColor=i,n.setAttribute("aria-selected",i===this.#a),n.addEventListener("click",this.#p.bind(this,i)),t.append(n)}return t.addEventListener("keydown",this.#t),t}#p(t,e){e.stopPropagation(),this.#d.dispatch("switchannotationeditorparams",{source:this,type:this.#h,value:t})}_colorSelectFromKeyboard(t){if(t.target===this.#i){this.#u(t);return}const e=t.target.getAttribute("data-color");e&&this.#p(e,t)}_moveToNext(t){if(!this.#m){this.#u(t);return}if(t.target===this.#i){this.#n.firstChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#n?.firstChild||t.target===this.#i){this.#m&&this._hideDropdownFromKeyboard();return}this.#m||this.#u(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#m){this.#u(t);return}this.#n.firstChild?.focus()}_moveToEnd(t){if(!this.#m){this.#u(t);return}this.#n.lastChild?.focus()}#g(t){Zt._keyboardManager.exec(this,t)}#u(t){if(this.#m){this.hideDropdown();return}if(this.#r=t.detail===0,window.addEventListener("pointerdown",this.#e),this.#n){this.#n.classList.remove("hidden");return}const e=this.#n=this.#o();this.#i.append(e)}#v(t){this.#n?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#n?.classList.add("hidden"),window.removeEventListener("pointerdown",this.#e)}get#m(){return this.#n&&!this.#n.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#c){if(!this.#m){this.#l?.unselect();return}this.hideDropdown(),this.#i.focus({preventScroll:!0,focusVisible:this.#r})}}updateColor(t){if(this.#s&&(this.#s.style.backgroundColor=t),!this.#n)return;const e=this.#f.highlightColors.values();for(const i of this.#n.children)i.setAttribute("aria-selected",e.next().value===t)}destroy(){this.#i?.remove(),this.#i=null,this.#s=null,this.#n?.remove(),this.#n=null}}class At extends nt{#t=null;#e=0;#i;#s=null;#a=null;#n=null;#r=null;#c=0;#l=null;#d=null;#f=null;#h=!1;#o=this.#w.bind(this);#p=null;#g;#u=null;#v="";#m;#y="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _l10nPromise;static _type="highlight";static _editorType=dt.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=At.prototype;return ut(this,"_keyboardManager",new ci([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||At._defaultColor,this.#m=t.thickness||At._defaultThickness,this.#g=t.opacity||At._defaultOpacity,this.#i=t.boxes||null,this.#y=t.methodOfCreation||"",this.#v=t.text||"",this._isDraggable=!1,t.highlightId>-1?(this.#h=!0,this.#x(t),this.#b()):(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#r=t.focusNode,this.#c=t.focusOffset,this.#A(),this.#b(),this.rotate(this.rotation))}get telemetryInitialData(){return{action:"added",type:this.#h?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:this.#m,methodOfCreation:this.#y}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#A(){const t=new jn(this.#i,.001);this.#d=t.getOutlines(),{x:this.x,y:this.y,width:this.width,height:this.height}=this.#d.box;const e=new jn(this.#i,.0025,.001,this._uiManager.direction==="ltr");this.#n=e.getOutlines();const{lastPoint:i}=this.#n.box;this.#p=[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height]}#x({highlightOutlines:t,highlightId:e,clipPathId:i}){this.#d=t;const n=1.5;if(this.#n=t.getNewOutline(this.#m/2+n,.0025),e>=0)this.#f=e,this.#s=i,this.parent.drawLayer.finalizeLine(e,t),this.#u=this.parent.drawLayer.highlightOutline(this.#n);else if(this.parent){const h=this.parent.viewport.rotation;this.parent.drawLayer.updateLine(this.#f,t),this.parent.drawLayer.updateBox(this.#f,At.#E(this.#d.box,(h-this.rotation+360)%360)),this.parent.drawLayer.updateLine(this.#u,this.#n),this.parent.drawLayer.updateBox(this.#u,At.#E(this.#n.box,h))}const{x:s,y:a,width:o,height:l}=t.box;switch(this.rotation){case 0:this.x=s,this.y=a,this.width=o,this.height=l;break;case 90:{const[h,d]=this.parentDimensions;this.x=a,this.y=1-s,this.width=o*d/h,this.height=l*h/d;break}case 180:this.x=1-s,this.y=1-a,this.width=o,this.height=l;break;case 270:{const[h,d]=this.parentDimensions;this.x=1-a,this.y=s,this.width=o*d/h,this.height=l*h/d;break}}const{lastPoint:c}=this.#n.box;this.#p=[(c[0]-s)/o,(c[1]-a)/l]}static initialize(t,e){nt.initialize(t,e),At._defaultColor||=e.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,e){switch(t){case st.HIGHLIGHT_DEFAULT_COLOR:At._defaultColor=e;break;case st.HIGHLIGHT_THICKNESS:At._defaultThickness=e;break}}translateInPage(t,e){}get toolbarPosition(){return this.#p}updateParams(t,e){switch(t){case st.HIGHLIGHT_COLOR:this.#S(e);break;case st.HIGHLIGHT_THICKNESS:this.#P(e);break}}static get defaultPropertiesToUpdate(){return[[st.HIGHLIGHT_DEFAULT_COLOR,At._defaultColor],[st.HIGHLIGHT_THICKNESS,At._defaultThickness]]}get propertiesToUpdate(){return[[st.HIGHLIGHT_COLOR,this.color||At._defaultColor],[st.HIGHLIGHT_THICKNESS,this.#m||At._defaultThickness],[st.HIGHLIGHT_FREE,this.#h]]}#S(t){const e=n=>{this.color=n,this.parent?.drawLayer.changeColor(this.#f,n),this.#a?.updateColor(n)},i=this.color;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:st.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)}#P(t){const e=this.#m,i=n=>{this.#m=n,this.#T(n)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:st.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(this.#a=new Zt({editor:this}),t.addColorPicker(this.#a)),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#R())}getBaseTranslation(){return[0,0]}getRect(t,e){return super.getRect(t,e,this.#R())}onceAdded(){this.parent.addUndoableEditor(this),this.div.focus()}remove(){this.#_(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#b(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?this.#_():t&&(this.#b(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),e&&this.select()}#T(t){if(!this.#h)return;this.#x({highlightOutlines:this.#d.getNewOutline(t/2)}),this.fixAndSetPosition();const[e,i]=this.parentDimensions;this.setDims(this.width*e,this.height*i)}#_(){this.#f===null||!this.parent||(this.parent.drawLayer.remove(this.#f),this.#f=null,this.parent.drawLayer.remove(this.#u),this.#u=null)}#b(t=this.parent){this.#f===null&&({id:this.#f,clipPathId:this.#s}=t.drawLayer.highlight(this.#d,this.color,this.#g),this.#u=t.drawLayer.highlightOutline(this.#n),this.#l&&(this.#l.style.clipPath=this.#s))}static#E({x:t,y:e,width:i,height:n},s){switch(s){case 90:return{x:1-e-n,y:t,width:n,height:i};case 180:return{x:1-t-i,y:1-e-n,width:i,height:n};case 270:return{x:e,y:1-t-i,width:n,height:i}}return{x:t,y:e,width:i,height:n}}rotate(t){const{drawLayer:e}=this.parent;let i;this.#h?(t=(t-this.rotation+360)%360,i=At.#E(this.#d.box,t)):i=At.#E(this,t),e.rotate(this.#f,t),e.rotate(this.#u,t),e.updateBox(this.#f,i),e.updateBox(this.#u,At.#E(this.#n.box,t))}render(){if(this.div)return this.div;const t=super.render();this.#v&&(t.setAttribute("aria-label",this.#v),t.setAttribute("role","mark")),this.#h?t.classList.add("free"):this.div.addEventListener("keydown",this.#o);const e=this.#l=document.createElement("div");t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal",e.style.clipPath=this.#s;const[i,n]=this.parentDimensions;return this.setDims(this.width*i,this.height*n),Ii(this,this.#l,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.parent.drawLayer.addClass(this.#u,"hovered")}pointerleave(){this.parent.drawLayer.removeClass(this.#u,"hovered")}#w(t){At._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#L(!0);break;case 1:case 3:this.#L(!1);break}}#L(t){if(!this.#t)return;const e=window.getSelection();t?e.setPosition(this.#t,this.#e):e.setPosition(this.#r,this.#c)}select(){super.select(),this.#u&&(this.parent?.drawLayer.removeClass(this.#u,"hovered"),this.parent?.drawLayer.addClass(this.#u,"selected"))}unselect(){super.unselect(),this.#u&&(this.parent?.drawLayer.removeClass(this.#u,"selected"),this.#h||this.#L(!1))}get _mustFixPosition(){return!this.#h}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.show(this.#f,t),this.parent.drawLayer.show(this.#u,t))}#R(){return this.#h?this.rotation:0}#M(){if(this.#h)return null;const[t,e]=this.pageDimensions,i=this.#i,n=new Array(i.length*8);let s=0;for(const{x:a,y:o,width:l,height:c}of i){const h=a*t,d=(1-o-c)*e;n[s]=n[s+4]=h,n[s+1]=n[s+3]=d,n[s+2]=n[s+6]=h+l*t,n[s+5]=n[s+7]=d+c*e,s+=8}return n}#k(t){return this.#d.serialize(t,this.#R())}static startHighlighting(t,e,{target:i,x:n,y:s}){const{x:a,y:o,width:l,height:c}=i.getBoundingClientRect(),h=f=>{this.#O(t,f)},d={capture:!0,passive:!1},u=f=>{f.preventDefault(),f.stopPropagation()},p=f=>{i.removeEventListener("pointermove",h),window.removeEventListener("blur",p),window.removeEventListener("pointerup",p),window.removeEventListener("pointerdown",u,d),window.removeEventListener("contextmenu",jt),this.#I(t,f)};window.addEventListener("blur",p),window.addEventListener("pointerup",p),window.addEventListener("pointerdown",u,d),window.addEventListener("contextmenu",jt),i.addEventListener("pointermove",h),this._freeHighlight=new _e({x:n,y:s},[a,o,l,c],t.scale,this._defaultThickness/2,e,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.highlight(this._freeHighlight,this._defaultColor,this._defaultOpacity,!0)}static#O(t,e){this._freeHighlight.add(e)&&t.drawLayer.updatePath(this._freeHighlightId,this._freeHighlight)}static#I(t,e){this._freeHighlight.isEmpty()?t.drawLayer.removeFreeHighlight(this._freeHighlightId):t.createAndAddNewEditor(e,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static deserialize(t,e,i){const n=super.deserialize(t,e,i),{rect:[s,a,o,l],color:c,quadPoints:h}=t;n.color=q.makeHexColor(...c),n.#g=t.opacity;const[d,u]=n.pageDimensions;n.width=(o-s)/d,n.height=(l-a)/u;const p=n.#i=[];for(let f=0;f<h.length;f+=8)p.push({x:(h[4]-o)/d,y:(l-(1-h[f+5]))/u,width:(h[f+2]-h[f])/d,height:(h[f+5]-h[f+1])/u});return n.#A(),n}serialize(t=!1){if(this.isEmpty()||t)return null;const e=this.getRect(0,0),i=nt._colorManager.convert(this.color);return{annotationType:dt.HIGHLIGHT,color:i,opacity:this.#g,thickness:this.#m,quadPoints:this.#M(),outlines:this.#k(e),pageIndex:this.pageIndex,rect:e,rotation:this.#R(),structTreeParentId:this._structTreeParentId}}static canCreateNewEmptyEditor(){return!1}}class Pt extends nt{#t=0;#e=0;#i=this.canvasPointermove.bind(this);#s=this.canvasPointerleave.bind(this);#a=this.canvasPointerup.bind(this);#n=this.canvasPointerdown.bind(this);#r=null;#c=new Path2D;#l=!1;#d=!1;#f=!1;#h=null;#o=0;#p=0;#g=null;static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=1;static _type="ink";static _editorType=dt.INK;constructor(t){super({...t,name:"inkEditor"}),this.color=t.color||null,this.thickness=t.thickness||null,this.opacity=t.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(t,e){nt.initialize(t,e)}static updateDefaultParams(t,e){switch(t){case st.INK_THICKNESS:Pt._defaultThickness=e;break;case st.INK_COLOR:Pt._defaultColor=e;break;case st.INK_OPACITY:Pt._defaultOpacity=e/100;break}}updateParams(t,e){switch(t){case st.INK_THICKNESS:this.#u(e);break;case st.INK_COLOR:this.#v(e);break;case st.INK_OPACITY:this.#m(e);break}}static get defaultPropertiesToUpdate(){return[[st.INK_THICKNESS,Pt._defaultThickness],[st.INK_COLOR,Pt._defaultColor||nt._defaultLineColor],[st.INK_OPACITY,Math.round(Pt._defaultOpacity*100)]]}get propertiesToUpdate(){return[[st.INK_THICKNESS,this.thickness||Pt._defaultThickness],[st.INK_COLOR,this.color||Pt._defaultColor||nt._defaultLineColor],[st.INK_OPACITY,Math.round(100*(this.opacity??Pt._defaultOpacity))]]}#u(t){const e=n=>{this.thickness=n,this.#F()},i=this.thickness;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:st.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}#v(t){const e=n=>{this.color=n,this.#w()},i=this.color;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:st.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}#m(t){const e=n=>{this.opacity=n,this.#w()};t/=100;const i=this.opacity;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:st.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(this.#R(),this.#M()),this.isAttachedToDOM||(this.parent.add(this),this.#k()),this.#F()))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,this.#r&&(clearTimeout(this.#r),this.#r=null),this.#h.disconnect(),this.#h=null,super.remove())}setParent(t){!this.parent&&t?this._uiManager.removeShouldRescale(this):this.parent&&t===null&&this._uiManager.addShouldRescale(this),super.setParent(t)}onScaleChanging(){const[t,e]=this.parentDimensions,i=this.width*t,n=this.height*e;this.setDimensions(i,n)}enableEditMode(){this.#l||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",this.#n))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",this.#n))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}#y(){const{parentRotation:t,parentDimensions:[e,i]}=this;switch(t){case 90:return[0,i,i,e];case 180:return[e,i,e,i];case 270:return[e,0,i,e];default:return[0,0,e,i]}}#A(){const{ctx:t,color:e,opacity:i,thickness:n,parentScale:s,scaleFactor:a}=this;t.lineWidth=n*s/a,t.lineCap="round",t.lineJoin="round",t.miterLimit=10,t.strokeStyle=`${e}${qc(i)}`}#x(t,e){this.canvas.addEventListener("contextmenu",jt),this.canvas.addEventListener("pointerleave",this.#s),this.canvas.addEventListener("pointermove",this.#i),this.canvas.addEventListener("pointerup",this.#a),this.canvas.removeEventListener("pointerdown",this.#n),this.isEditing=!0,this.#f||(this.#f=!0,this.#k(),this.thickness||=Pt._defaultThickness,this.color||=Pt._defaultColor||nt._defaultLineColor,this.opacity??=Pt._defaultOpacity),this.currentPath.push([t,e]),this.#d=!1,this.#A(),this.#g=()=>{this.#_(),this.#g&&window.requestAnimationFrame(this.#g)},window.requestAnimationFrame(this.#g)}#S(t,e){const[i,n]=this.currentPath.at(-1);if(this.currentPath.length>1&&t===i&&e===n)return;const s=this.currentPath;let a=this.#c;if(s.push([t,e]),this.#d=!0,s.length<=2){a.moveTo(...s[0]),a.lineTo(t,e);return}s.length===3&&(this.#c=a=new Path2D,a.moveTo(...s[0])),this.#b(a,...s.at(-3),...s.at(-2),t,e)}#P(){if(this.currentPath.length===0)return;const t=this.currentPath.at(-1);this.#c.lineTo(...t)}#T(t,e){this.#g=null,t=Math.min(Math.max(t,0),this.canvas.width),e=Math.min(Math.max(e,0),this.canvas.height),this.#S(t,e),this.#P();let i;if(this.currentPath.length!==1)i=this.#E();else{const l=[t,e];i=[[l,l.slice(),l.slice(),l]]}const n=this.#c,s=this.currentPath;this.currentPath=[],this.#c=new Path2D;const a=()=>{this.allRawPaths.push(s),this.paths.push(i),this.bezierPath2D.push(n),this._uiManager.rebuild(this)},o=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(this.#R(),this.#M()),this.#F())};this.addCommands({cmd:a,undo:o,mustExec:!0})}#_(){if(!this.#d)return;this.#d=!1;const t=Math.ceil(this.thickness*this.parentScale),e=this.currentPath.slice(-3),i=e.map(a=>a[0]),n=e.map(a=>a[1]);Math.min(...i)-t,Math.max(...i)+t,Math.min(...n)-t,Math.max(...n)+t;const{ctx:s}=this;s.save(),s.clearRect(0,0,this.canvas.width,this.canvas.height);for(const a of this.bezierPath2D)s.stroke(a);s.stroke(this.#c),s.restore()}#b(t,e,i,n,s,a,o){const l=(e+n)/2,c=(i+s)/2,h=(n+a)/2,d=(s+o)/2;t.bezierCurveTo(l+2*(n-l)/3,c+2*(s-c)/3,h+2*(n-h)/3,d+2*(s-d)/3,h,d)}#E(){const t=this.currentPath;if(t.length<=2)return[[t[0],t[0],t.at(-1),t.at(-1)]];const e=[];let i,[n,s]=t[0];for(i=1;i<t.length-2;i++){const[u,p]=t[i],[f,m]=t[i+1],b=(u+f)/2,g=(p+m)/2,y=[n+2*(u-n)/3,s+2*(p-s)/3],x=[b+2*(u-b)/3,g+2*(p-g)/3];e.push([[n,s],y,x,[b,g]]),[n,s]=[b,g]}const[a,o]=t[i],[l,c]=t[i+1],h=[n+2*(a-n)/3,s+2*(o-s)/3],d=[l+2*(a-l)/3,c+2*(o-c)/3];return e.push([[n,s],h,d,[l,c]]),e}#w(){if(this.isEmpty()){this.#I();return}this.#A();const{canvas:t,ctx:e}=this;e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,t.width,t.height),this.#I();for(const i of this.bezierPath2D)e.stroke(i)}commit(){this.#l||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),this.#l=!0,this.div.classList.add("disabled"),this.#F(!0),this.select(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),this.enableEditMode())}canvasPointerdown(t){t.button!==0||!this.isInEditMode()||this.#l||(this.setInForeground(),t.preventDefault(),this.div.contains(document.activeElement)||this.div.focus({preventScroll:!0}),this.#x(t.offsetX,t.offsetY))}canvasPointermove(t){t.preventDefault(),this.#S(t.offsetX,t.offsetY)}canvasPointerup(t){t.preventDefault(),this.#L(t)}canvasPointerleave(t){this.#L(t)}#L(t){this.canvas.removeEventListener("pointerleave",this.#s),this.canvas.removeEventListener("pointermove",this.#i),this.canvas.removeEventListener("pointerup",this.#a),this.canvas.addEventListener("pointerdown",this.#n),this.#r&&clearTimeout(this.#r),this.#r=setTimeout(()=>{this.#r=null,this.canvas.removeEventListener("contextmenu",jt)},10),this.#T(t.offsetX,t.offsetY),this.addToAnnotationStorage(),this.setInBackground()}#R(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",this.canvas.setAttribute("data-l10n-id","pdfjs-ink-canvas"),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}#M(){this.#h=new ResizeObserver(t=>{const e=t[0].contentRect;e.width&&e.height&&this.setDimensions(e.width,e.height)}),this.#h.observe(this.div)}get isResizable(){return!this.isEmpty()&&this.#l}render(){if(this.div)return this.div;let t,e;this.width&&(t=this.x,e=this.y),super.render(),this.div.setAttribute("data-l10n-id","pdfjs-ink");const[i,n,s,a]=this.#y();if(this.setAt(i,n,0,0),this.setDims(s,a),this.#R(),this.width){const[o,l]=this.parentDimensions;this.setAspectRatio(this.width*o,this.height*l),this.setAt(t*o,e*l,this.width*o,this.height*l),this.#f=!0,this.#k(),this.setDims(this.width*o,this.height*l),this.#w(),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return this.#M(),this.div}#k(){if(!this.#f)return;const[t,e]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*t),this.canvas.height=Math.ceil(this.height*e),this.#I()}setDimensions(t,e){const i=Math.round(t),n=Math.round(e);if(this.#o===i&&this.#p===n)return;this.#o=i,this.#p=n,this.canvas.style.visibility="hidden";const[s,a]=this.parentDimensions;this.width=t/s,this.height=e/a,this.fixAndSetPosition(),this.#l&&this.#O(t,e),this.#k(),this.#w(),this.canvas.style.visibility="visible",this.fixDims()}#O(t,e){const i=this.#j(),n=(t-i)/this.#e,s=(e-i)/this.#t;this.scaleFactor=Math.min(n,s)}#I(){const t=this.#j()/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+t,this.translationY*this.scaleFactor+t)}static#D(t){const e=new Path2D;for(let i=0,n=t.length;i<n;i++){const[s,a,o,l]=t[i];i===0&&e.moveTo(...s),e.bezierCurveTo(a[0],a[1],o[0],o[1],l[0],l[1])}return e}static#U(t,e,i){const[n,s,a,o]=e;switch(i){case 0:for(let l=0,c=t.length;l<c;l+=2)t[l]+=n,t[l+1]=o-t[l+1];break;case 90:for(let l=0,c=t.length;l<c;l+=2){const h=t[l];t[l]=t[l+1]+n,t[l+1]=h+s}break;case 180:for(let l=0,c=t.length;l<c;l+=2)t[l]=a-t[l],t[l+1]+=s;break;case 270:for(let l=0,c=t.length;l<c;l+=2){const h=t[l];t[l]=a-t[l+1],t[l+1]=o-h}break;default:throw new Error("Invalid rotation")}return t}static#G(t,e,i){const[n,s,a,o]=e;switch(i){case 0:for(let l=0,c=t.length;l<c;l+=2)t[l]-=n,t[l+1]=o-t[l+1];break;case 90:for(let l=0,c=t.length;l<c;l+=2){const h=t[l];t[l]=t[l+1]-s,t[l+1]=h-n}break;case 180:for(let l=0,c=t.length;l<c;l+=2)t[l]=a-t[l],t[l+1]-=s;break;case 270:for(let l=0,c=t.length;l<c;l+=2){const h=t[l];t[l]=o-t[l+1],t[l+1]=a-h}break;default:throw new Error("Invalid rotation")}return t}#V(t,e,i,n){const s=[],a=this.thickness/2,o=t*e+a,l=t*i+a;for(const c of this.paths){const h=[],d=[];for(let u=0,p=c.length;u<p;u++){const[f,m,b,g]=c[u];if(f[0]===g[0]&&f[1]===g[1]&&p===1){const z=t*f[0]+o,D=t*f[1]+l;h.push(z,D),d.push(z,D);break}const y=t*f[0]+o,x=t*f[1]+l,w=t*m[0]+o,v=t*m[1]+l,R=t*b[0]+o,I=t*b[1]+l,j=t*g[0]+o,H=t*g[1]+l;u===0&&(h.push(y,x),d.push(y,x)),h.push(w,v,R,I,j,H),d.push(w,v),u===p-1&&d.push(j,H)}s.push({bezier:Pt.#U(h,n,this.rotation),points:Pt.#U(d,n,this.rotation)})}return s}#$(){let t=1/0,e=-1/0,i=1/0,n=-1/0;for(const s of this.paths)for(const[a,o,l,c]of s){const h=q.bezierBoundingBox(...a,...o,...l,...c);t=Math.min(t,h[0]),i=Math.min(i,h[1]),e=Math.max(e,h[2]),n=Math.max(n,h[3])}return[t,i,e,n]}#j(){return this.#l?Math.ceil(this.thickness*this.parentScale):0}#F(t=!1){if(this.isEmpty())return;if(!this.#l){this.#w();return}const e=this.#$(),i=this.#j();this.#e=Math.max(nt.MIN_SIZE,e[2]-e[0]),this.#t=Math.max(nt.MIN_SIZE,e[3]-e[1]);const n=Math.ceil(i+this.#e*this.scaleFactor),s=Math.ceil(i+this.#t*this.scaleFactor),[a,o]=this.parentDimensions;this.width=n/a,this.height=s/o,this.setAspectRatio(n,s);const l=this.translationX,c=this.translationY;this.translationX=-e[0],this.translationY=-e[1],this.#k(),this.#w(),this.#o=n,this.#p=s,this.setDims(n,s);const h=t?i/this.scaleFactor/2:0;this.translate(l-this.translationX-h,c-this.translationY-h)}static deserialize(t,e,i){if(t instanceof Ja)return null;const n=super.deserialize(t,e,i);n.thickness=t.thickness,n.color=q.makeHexColor(...t.color),n.opacity=t.opacity;const[s,a]=n.pageDimensions,o=n.width*s,l=n.height*a,c=n.parentScale,h=t.thickness/2;n.#l=!0,n.#o=Math.round(o),n.#p=Math.round(l);const{paths:d,rect:u,rotation:p}=t;for(let{bezier:m}of d){m=Pt.#G(m,u,p);const b=[];n.paths.push(b);let g=c*(m[0]-h),y=c*(m[1]-h);for(let w=2,v=m.length;w<v;w+=6){const R=c*(m[w]-h),I=c*(m[w+1]-h),j=c*(m[w+2]-h),H=c*(m[w+3]-h),z=c*(m[w+4]-h),D=c*(m[w+5]-h);b.push([[g,y],[R,I],[j,H],[z,D]]),g=z,y=D}const x=this.#D(b);n.bezierPath2D.push(x)}const f=n.#$();return n.#e=Math.max(nt.MIN_SIZE,f[2]-f[0]),n.#t=Math.max(nt.MIN_SIZE,f[3]-f[1]),n.#O(o,l),n}serialize(){if(this.isEmpty())return null;const t=this.getRect(0,0),e=nt._colorManager.convert(this.ctx.strokeStyle);return{annotationType:dt.INK,color:e,thickness:this.thickness,opacity:this.opacity,paths:this.#V(this.scaleFactor/this.parentScale,this.translationX,this.translationY,t),pageIndex:this.pageIndex,rect:t,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}}class us extends nt{#t=null;#e=null;#i=null;#s=null;#a=null;#n="";#r=null;#c=null;#l=null;#d=!1;#f=!1;static _type="stamp";static _editorType=dt.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#s=t.bitmapUrl,this.#a=t.bitmapFile}static initialize(t,e){nt.initialize(t,e)}static get supportedTypes(){return ut(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(e=>`image/${e}`))}static get supportedTypesStr(){return ut(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(t){return this.supportedTypes.includes(t)}static paste(t,e){e.pasteEditor(dt.STAMP,{bitmapFile:t.getAsFile()})}#h(t,e=!1){if(!t){this.remove();return}this.#t=t.bitmap,e||(this.#e=t.id,this.#d=t.isSvg),t.file&&(this.#n=t.file.name),this.#g()}#o(){this.#i=null,this._uiManager.enableWaiting(!1),this.#r&&this.div.focus()}#p(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(e=>this.#h(e,!0)).finally(()=>this.#o());return}if(this.#s){const e=this.#s;this.#s=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromUrl(e).then(i=>this.#h(i)).finally(()=>this.#o());return}if(this.#a){const e=this.#a;this.#a=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromFile(e).then(i=>this.#h(i)).finally(()=>this.#o());return}const t=document.createElement("input");t.type="file",t.accept=us.supportedTypesStr,this.#i=new Promise(e=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const i=await this._uiManager.imageManager.getFromFile(t.files[0]);this.#h(i)}e()}),t.addEventListener("cancel",()=>{this.remove(),e()})}).finally(()=>this.#o()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#r?.remove(),this.#r=null,this.#c?.disconnect(),this.#c=null,this.#l&&(clearTimeout(this.#l),this.#l=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#p();return}super.rebuild(),this.div!==null&&(this.#e&&this.#r===null&&this.#p(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(this.#i||this.#t||this.#s||this.#a||this.#e)}get isResizable(){return!0}render(){if(this.div)return this.div;let t,e;if(this.width&&(t=this.x,e=this.y),super.render(),this.div.hidden=!0,this.addAltTextButton(),this.#t?this.#g():this.#p(),this.width){const[i,n]=this.parentDimensions;this.setAt(t*i,e*n,this.width*i,this.height*n)}return this.div}#g(){const{div:t}=this;let{width:e,height:i}=this.#t;const[n,s]=this.pageDimensions,a=.75;if(this.width)e=this.width*n,i=this.height*s;else if(e>a*n||i>a*s){const h=Math.min(a*n/e,a*s/i);e*=h,i*=h}const[o,l]=this.parentDimensions;this.setDims(e*o/n,i*l/s),this._uiManager.enableWaiting(!1);const c=this.#r=document.createElement("canvas");t.append(c),t.hidden=!1,this.#m(e,i),this.#A(),this.#f||(this.parent.addUndoableEditor(this),this.#f=!0),this._reportTelemetry({action:"inserted_image"}),this.#n&&c.setAttribute("aria-label",this.#n)}#u(t,e){const[i,n]=this.parentDimensions;this.width=t/i,this.height=e/n,this.setDims(t,e),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,this.#l!==null&&clearTimeout(this.#l);const s=200;this.#l=setTimeout(()=>{this.#l=null,this.#m(t,e)},s)}#v(t,e){const{width:i,height:n}=this.#t;let s=i,a=n,o=this.#t;for(;s>2*t||a>2*e;){const l=s,c=a;s>2*t&&(s=s>=16384?Math.floor(s/2)-1:Math.ceil(s/2)),a>2*e&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2));const h=new OffscreenCanvas(s,a);h.getContext("2d").drawImage(o,0,0,l,c,0,0,s,a),o=h.transferToImageBitmap()}return o}#m(t,e){t=Math.ceil(t),e=Math.ceil(e);const i=this.#r;if(!i||i.width===t&&i.height===e)return;i.width=t,i.height=e;const n=this.#d?this.#t:this.#v(t,e);if(this._uiManager.hasMLManager&&!this.hasAltText()){const o=new OffscreenCanvas(t,e).getContext("2d");o.drawImage(n,0,0,n.width,n.height,0,0,t,e),this._uiManager.mlGuess({service:"image-to-text",request:{data:o.getImageData(0,0,t,e).data,width:t,height:e,channels:4}}).then(l=>{const c=l?.output||"";this.parent&&c&&!this.hasAltText()&&(this.altTextData={altText:c,decorative:!1})})}const s=i.getContext("2d");s.filter=this._uiManager.hcmFilter,s.drawImage(n,0,0,n.width,n.height,0,0,t,e)}getImageForAltText(){return this.#r}#y(t){if(t){if(this.#d){const n=this._uiManager.imageManager.getSvgUrl(this.#e);if(n)return n}const e=document.createElement("canvas");return{width:e.width,height:e.height}=this.#t,e.getContext("2d").drawImage(this.#t,0,0),e.toDataURL()}if(this.#d){const[e,i]=this.pageDimensions,n=Math.round(this.width*e*ze.PDF_TO_CSS_UNITS),s=Math.round(this.height*i*ze.PDF_TO_CSS_UNITS),a=new OffscreenCanvas(n,s);return a.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,n,s),a.transferToImageBitmap()}return structuredClone(this.#t)}#A(){this.#c=new ResizeObserver(t=>{const e=t[0].contentRect;e.width&&e.height&&this.#u(e.width,e.height)}),this.#c.observe(this.div)}static deserialize(t,e,i){if(t instanceof to)return null;const n=super.deserialize(t,e,i),{rect:s,bitmapUrl:a,bitmapId:o,isSvg:l,accessibilityData:c}=t;o&&i.imageManager.isValidId(o)?n.#e=o:n.#s=a,n.#d=l;const[h,d]=n.pageDimensions;return n.width=(s[2]-s[0])/h,n.height=(s[3]-s[1])/d,c&&(n.altTextData=c),n}serialize(t=!1,e=null){if(this.isEmpty())return null;const i={annotationType:dt.STAMP,bitmapId:this.#e,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#d,structTreeParentId:this._structTreeParentId};if(t)return i.bitmapUrl=this.#y(!0),i.accessibilityData=this.altTextData,i;const{decorative:n,altText:s}=this.altTextData;if(!n&&s&&(i.accessibilityData={type:"Figure",alt:s}),e===null)return i;e.stamps||=new Map;const a=this.#d?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!e.stamps.has(this.#e))e.stamps.set(this.#e,{area:a,serialized:i}),i.bitmap=this.#y(!1);else if(this.#d){const o=e.stamps.get(this.#e);a>o.area&&(o.area=a,o.serialized.bitmap.close(),o.serialized.bitmap=this.#y(!1))}return i}}class se{#t;#e=!1;#i=null;#s=null;#a=null;#n=null;#r=null;#c=new Map;#l=!1;#d=!1;#f=!1;#h=null;#o;static _initialized=!1;static#p=new Map([xt,Pt,us,At].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:e,div:i,accessibilityManager:n,annotationLayer:s,drawLayer:a,textLayer:o,viewport:l,l10n:c}){const h=[...se.#p.values()];if(!se._initialized){se._initialized=!0;for(const d of h)d.initialize(c,t)}t.registerEditorTypes(h),this.#o=t,this.pageIndex=e,this.div=i,this.#t=n,this.#i=s,this.viewport=l,this.#h=o,this.drawLayer=a,this.#o.addLayer(this)}get isEmpty(){return this.#c.size===0}get isInvisible(){return this.isEmpty&&this.#o.getMode()===dt.NONE}updateToolbar(t){this.#o.updateToolbar(t)}updateMode(t=this.#o.getMode()){switch(this.#y(),t){case dt.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case dt.INK:this.addInkEditorIfNeeded(!1),this.disableTextSelection(),this.togglePointerEvents(!0),this.disableClick();break;case dt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const i of se.#p.values())e.toggle(`${i._type}Editing`,t===i._editorType);this.div.hidden=!1}hasTextLayer(t){return t===this.#h?.div}addInkEditorIfNeeded(t){if(this.#o.getMode()!==dt.INK)return;if(!t){for(const i of this.#c.values())if(i.isEmpty()){i.setInBackground();return}}this.createAndAddNewEditor({offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(t){this.#o.setEditingState(t)}addCommands(t){this.#o.addCommands(t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#i?.div.classList.toggle("disabled",!t)}enable(){this.div.tabIndex=0,this.togglePointerEvents(!0);const t=new Set;for(const i of this.#c.values())i.enableEditing(),i.show(!0),i.annotationElementId&&(this.#o.removeChangedExistingAnnotation(i),t.add(i.annotationElementId));if(!this.#i)return;const e=this.#i.getEditableAnnotations();for(const i of e){if(i.hide(),this.#o.isDeletedAnnotationElement(i.data.id)||t.has(i.data.id))continue;const n=this.deserialize(i);n&&(this.addOrRebuild(n),n.enableEditing())}}disable(){this.#f=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1);const t=new Map,e=new Map;for(const n of this.#c.values())if(n.disableEditing(),!!n.annotationElementId){if(n.serialize()!==null){t.set(n.annotationElementId,n);continue}else e.set(n.annotationElementId,n);this.getEditableAnnotation(n.annotationElementId)?.show(),n.remove()}if(this.#i){const n=this.#i.getEditableAnnotations();for(const s of n){const{id:a}=s.data;if(this.#o.isDeletedAnnotationElement(a))continue;let o=e.get(a);if(o){o.resetAnnotationElement(s),o.show(!1),s.show();continue}o=t.get(a),o&&(this.#o.addChangedExistingAnnotation(o),o.renderAnnotationElement(s),o.show(!1)),s.show()}}this.#y(),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const n of se.#p.values())i.remove(`${n._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#f=!1}getEditableAnnotation(t){return this.#i?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#o.getActive()!==t&&this.#o.setActiveEditor(t)}enableTextSelection(){this.div.tabIndex=-1,this.#h?.div&&!this.#n&&(this.#n=this.#g.bind(this),this.#h.div.addEventListener("pointerdown",this.#n),this.#h.div.classList.add("highlighting"))}disableTextSelection(){this.div.tabIndex=0,this.#h?.div&&this.#n&&(this.#h.div.removeEventListener("pointerdown",this.#n),this.#n=null,this.#h.div.classList.remove("highlighting"))}#g(t){if(this.#o.unselectAll(),t.target===this.#h.div){const{isMac:e}=Bt.platform;if(t.button!==0||t.ctrlKey&&e)return;this.#o.showAllEditors("highlight",!0,!0),this.#h.div.classList.add("free"),At.startHighlighting(this,this.#o.direction==="ltr",t),this.#h.div.addEventListener("pointerup",()=>{this.#h.div.classList.remove("free")},{once:!0}),t.preventDefault()}}enableClick(){this.#a||(this.#a=this.pointerdown.bind(this),this.#s=this.pointerup.bind(this),this.div.addEventListener("pointerdown",this.#a),this.div.addEventListener("pointerup",this.#s))}disableClick(){this.#a&&(this.div.removeEventListener("pointerdown",this.#a),this.div.removeEventListener("pointerup",this.#s),this.#a=null,this.#s=null)}attach(t){this.#c.set(t.id,t);const{annotationElementId:e}=t;e&&this.#o.isDeletedAnnotationElement(e)&&this.#o.removeDeletedAnnotationElement(t)}detach(t){this.#c.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#f&&t.annotationElementId&&this.#o.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#o.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1,this.#d||this.addInkEditorIfNeeded(!1)}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#o.addDeletedAnnotationElement(t.annotationElementId),nt.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#o.addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(),this.#o.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!this.#r&&(t._focusEventsAllowed=!1,this.#r=setTimeout(()=>{this.#r=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0}),e.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),i=()=>{t.remove()};this.addCommands({cmd:e,undo:i,mustExec:!1})}getNextId(){return this.#o.getId()}get#u(){return se.#p.get(this.#o.getMode())}#v(t){const e=this.#u;return e?new e.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#u?.canCreateNewEmptyEditor()}pasteEditor(t,e){this.#o.updateToolbar(t),this.#o.updateMode(t);const{offsetX:i,offsetY:n}=this.#m(),s=this.getNextId(),a=this.#v({parent:this,id:s,x:i,y:n,uiManager:this.#o,isCentered:!0,...e});a&&this.add(a)}deserialize(t){return se.#p.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#o)||null}createAndAddNewEditor(t,e,i={}){const n=this.getNextId(),s=this.#v({parent:this,id:n,x:t.offsetX,y:t.offsetY,uiManager:this.#o,isCentered:e,...i});return s&&this.add(s),s}#m(){const{x:t,y:e,width:i,height:n}=this.div.getBoundingClientRect(),s=Math.max(0,t),a=Math.max(0,e),o=Math.min(window.innerWidth,t+i),l=Math.min(window.innerHeight,e+n),c=(s+o)/2-t,h=(a+l)/2-e,[d,u]=this.viewport.rotation%180===0?[c,h]:[h,c];return{offsetX:d,offsetY:u}}addNewEditor(){this.createAndAddNewEditor(this.#m(),!0)}setSelected(t){this.#o.setSelected(t)}toggleSelected(t){this.#o.toggleSelected(t)}isSelected(t){return this.#o.isSelected(t)}unselect(t){this.#o.unselect(t)}pointerup(t){const{isMac:e}=Bt.platform;if(!(t.button!==0||t.ctrlKey&&e)&&t.target===this.div&&this.#l){if(this.#l=!1,!this.#e){this.#e=!0;return}if(this.#o.getMode()===dt.STAMP){this.#o.unselectAll();return}this.createAndAddNewEditor(t,!1)}}pointerdown(t){if(this.#o.getMode()===dt.HIGHLIGHT&&this.enableTextSelection(),this.#l){this.#l=!1;return}const{isMac:e}=Bt.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;this.#l=!0;const i=this.#o.getActive();this.#e=!i||i.isEmpty()}findNewParent(t,e,i){const n=this.#o.findParent(e,i);return n===null||n===this?!1:(n.changeParent(t),!0)}destroy(){this.#o.getActive()?.parent===this&&(this.#o.commitOrRemove(),this.#o.setActiveEditor(null)),this.#r&&(clearTimeout(this.#r),this.#r=null);for(const t of this.#c.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#c.clear(),this.#o.removeLayer(this)}#y(){this.#d=!0;for(const t of this.#c.values())t.isEmpty()&&t.remove();this.#d=!1}render({viewport:t}){this.viewport=t,we(this.div,t);for(const e of this.#o.getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){this.#o.commitOrRemove(),this.#y();const e=this.viewport.rotation,i=t.rotation;if(this.viewport=t,we(this.div,{rotation:i}),e!==i)for(const n of this.#c.values())n.rotate(i);this.addInkEditorIfNeeded(!1)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return this.#o.viewParameters.realScale}}class kt{#t=null;#e=0;#i=new Map;#s=new Map;constructor({pageIndex:t}){this.pageIndex=t}setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#i.size>0)for(const e of this.#i.values())e.remove(),t.append(e);this.#t=t}}static get _svgFactory(){return ut(this,"_svgFactory",new Jn)}static#a(t,{x:e=0,y:i=0,width:n=1,height:s=1}={}){const{style:a}=t;a.top=`${100*i}%`,a.left=`${100*e}%`,a.width=`${100*n}%`,a.height=`${100*s}%`}#n(t){const e=kt._svgFactory.create(1,1,!0);return this.#t.append(e),e.setAttribute("aria-hidden",!0),kt.#a(e,t),e}#r(t,e){const i=kt._svgFactory.createElement("clipPath");t.append(i);const n=`clip_${e}`;i.setAttribute("id",n),i.setAttribute("clipPathUnits","objectBoundingBox");const s=kt._svgFactory.createElement("use");return i.append(s),s.setAttribute("href",`#${e}`),s.classList.add("clip"),n}highlight(t,e,i,n=!1){const s=this.#e++,a=this.#n(t.box);a.classList.add("highlight"),t.free&&a.classList.add("free");const o=kt._svgFactory.createElement("defs");a.append(o);const l=kt._svgFactory.createElement("path");o.append(l);const c=`path_p${this.pageIndex}_${s}`;l.setAttribute("id",c),l.setAttribute("d",t.toSVGPath()),n&&this.#s.set(s,l);const h=this.#r(o,c),d=kt._svgFactory.createElement("use");return a.append(d),a.setAttribute("fill",e),a.setAttribute("fill-opacity",i),d.setAttribute("href",`#${c}`),this.#i.set(s,a),{id:s,clipPathId:`url(#${h})`}}highlightOutline(t){const e=this.#e++,i=this.#n(t.box);i.classList.add("highlightOutline");const n=kt._svgFactory.createElement("defs");i.append(n);const s=kt._svgFactory.createElement("path");n.append(s);const a=`path_p${this.pageIndex}_${e}`;s.setAttribute("id",a),s.setAttribute("d",t.toSVGPath()),s.setAttribute("vector-effect","non-scaling-stroke");let o;if(t.free){i.classList.add("free");const h=kt._svgFactory.createElement("mask");n.append(h),o=`mask_p${this.pageIndex}_${e}`,h.setAttribute("id",o),h.setAttribute("maskUnits","objectBoundingBox");const d=kt._svgFactory.createElement("rect");h.append(d),d.setAttribute("width","1"),d.setAttribute("height","1"),d.setAttribute("fill","white");const u=kt._svgFactory.createElement("use");h.append(u),u.setAttribute("href",`#${a}`),u.setAttribute("stroke","none"),u.setAttribute("fill","black"),u.setAttribute("fill-rule","nonzero"),u.classList.add("mask")}const l=kt._svgFactory.createElement("use");i.append(l),l.setAttribute("href",`#${a}`),o&&l.setAttribute("mask",`url(#${o})`);const c=l.cloneNode();return i.append(c),l.classList.add("mainOutline"),c.classList.add("secondaryOutline"),this.#i.set(e,i),e}finalizeLine(t,e){const i=this.#s.get(t);this.#s.delete(t),this.updateBox(t,e.box),i.setAttribute("d",e.toSVGPath())}updateLine(t,e){this.#i.get(t).firstChild.firstChild.setAttribute("d",e.toSVGPath())}removeFreeHighlight(t){this.remove(t),this.#s.delete(t)}updatePath(t,e){this.#s.get(t).setAttribute("d",e.toSVGPath())}updateBox(t,e){kt.#a(this.#i.get(t),e)}show(t,e){this.#i.get(t).classList.toggle("hidden",!e)}rotate(t,e){this.#i.get(t).setAttribute("data-main-rotation",e)}changeColor(t,e){this.#i.get(t).setAttribute("fill",e)}changeOpacity(t,e){this.#i.get(t).setAttribute("fill-opacity",e)}addClass(t,e){this.#i.get(t).classList.add(e)}removeClass(t,e){this.#i.get(t).classList.remove(e)}remove(t){this.#t!==null&&(this.#i.get(t).remove(),this.#i.delete(t))}destroy(){this.#t=null;for(const t of this.#i.values())t.remove();this.#i.clear()}}var Sd=it.AbortException,Td=it.AnnotationEditorLayer,Cd=it.AnnotationEditorParamsType,Pd=it.AnnotationEditorType,Rd=it.AnnotationEditorUIManager,io=it.AnnotationLayer,no=it.AnnotationMode,Ld=it.CMapCompressionType,kd=it.ColorPicker,Id=it.DOMSVGFactory,Md=it.DrawLayer,Od=it.FeatureTest,fs=it.GlobalWorkerOptions,Dd=it.ImageKind,Fd=it.InvalidPDFException,Nd=it.MissingPDFException,Bd=it.OPS,jd=it.Outliner,Hd=it.PDFDataRangeTransport,Ud=it.PDFDateString,$d=it.PDFWorker,zd=it.PasswordResponses,Gd=it.PermissionFlag,Vd=it.PixelsPerInch,Wd=it.RenderingCancelledException,so=it.TextLayer,Yd=it.UnexpectedResponseException,qd=it.Util,Xd=it.VerbosityLevel,Kd=it.XfaLayer,Zd=it.build,Qd=it.createValidAbsoluteUrl,Jd=it.fetchData,ro=it.getDocument,tu=it.getFilenameFromUrl,eu=it.getPdfFilenameFromUrl,iu=it.getXfaPageViewport,nu=it.isDataScheme,su=it.isPdfFile,ru=it.noContextMenu,au=it.normalizeUnicode,ou=it.renderTextLayer,lu=it.setLayerDimensions,cu=it.shadow,hu=it.updateTextLayer,du=it.version;const uu=Object.freeze(Object.defineProperty({__proto__:null,AbortException:Sd,AnnotationEditorLayer:Td,AnnotationEditorParamsType:Cd,AnnotationEditorType:Pd,AnnotationEditorUIManager:Rd,AnnotationLayer:io,AnnotationMode:no,CMapCompressionType:Ld,ColorPicker:kd,DOMSVGFactory:Id,DrawLayer:Md,FeatureTest:Od,GlobalWorkerOptions:fs,ImageKind:Dd,InvalidPDFException:Fd,MissingPDFException:Nd,OPS:Bd,Outliner:jd,PDFDataRangeTransport:Hd,PDFDateString:Ud,PDFWorker:$d,PasswordResponses:zd,PermissionFlag:Gd,PixelsPerInch:Vd,RenderingCancelledException:Wd,TextLayer:so,UnexpectedResponseException:Yd,Util:qd,VerbosityLevel:Xd,XfaLayer:Kd,build:Zd,createValidAbsoluteUrl:Qd,fetchData:Jd,getDocument:ro,getFilenameFromUrl:tu,getPdfFilenameFromUrl:eu,getXfaPageViewport:iu,isDataScheme:nu,isPdfFile:su,noContextMenu:ru,normalizeUnicode:au,renderTextLayer:ou,setLayerDimensions:lu,shadow:cu,updateTextLayer:hu,version:du},Symbol.toStringTag,{value:"Module"}));var Tt=function(r,t,e){if(e||arguments.length===2)for(var i=0,n=t.length,s;i<n;i++)(s||!(i in t))&&(s||(s=Array.prototype.slice.call(t,0,i)),s[i]=t[i]);return r.concat(s||Array.prototype.slice.call(t))},fu=["onCopy","onCut","onPaste"],pu=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],gu=["onFocus","onBlur"],mu=["onInput","onInvalid","onReset","onSubmit"],bu=["onLoad","onError"],vu=["onKeyDown","onKeyPress","onKeyUp"],yu=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],_u=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],Au=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],Eu=["onSelect"],wu=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],xu=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],Su=["onScroll"],Tu=["onWheel"],Cu=["onAnimationStart","onAnimationEnd","onAnimationIteration"],Pu=["onTransitionEnd"],Ru=["onToggle"],Lu=["onChange"],ku=Tt(Tt(Tt(Tt(Tt(Tt(Tt(Tt(Tt(Tt(Tt(Tt(Tt(Tt(Tt(Tt(Tt(Tt([],fu,!0),pu,!0),gu,!0),mu,!0),bu,!0),vu,!0),yu,!0),_u,!0),Au,!0),Eu,!0),wu,!0),xu,!0),Su,!0),Tu,!0),Cu,!0),Pu,!0),Lu,!0),Ru,!0);function ao(r,t){var e={};return ku.forEach(function(i){var n=r[i];n&&(t?e[i]=(function(s){return n(s,t(i))}):e[i]=n)}),e}function ui(r){var t=!1,e=new Promise(function(i,n){r.then(function(s){return!t&&i(s)}).catch(function(s){return!t&&n(s)})});return{promise:e,cancel:function(){t=!0}}}var Iu="Invariant failed";function mt(r,t){if(!r)throw new Error(Iu)}var An,Er;function Mu(){if(Er)return An;Er=1;var r=function(){};return An=r,An}var Ou=Mu();const It=Zr(Ou);var wr=Object.prototype.hasOwnProperty;function xr(r,t,e){for(e of r.keys())if(Be(e,t))return e}function Be(r,t){var e,i,n;if(r===t)return!0;if(r&&t&&(e=r.constructor)===t.constructor){if(e===Date)return r.getTime()===t.getTime();if(e===RegExp)return r.toString()===t.toString();if(e===Array){if((i=r.length)===t.length)for(;i--&&Be(r[i],t[i]););return i===-1}if(e===Set){if(r.size!==t.size)return!1;for(i of r)if(n=i,n&&typeof n=="object"&&(n=xr(t,n),!n)||!t.has(n))return!1;return!0}if(e===Map){if(r.size!==t.size)return!1;for(i of r)if(n=i[0],n&&typeof n=="object"&&(n=xr(t,n),!n)||!Be(i[1],t.get(n)))return!1;return!0}if(e===ArrayBuffer)r=new Uint8Array(r),t=new Uint8Array(t);else if(e===DataView){if((i=r.byteLength)===t.byteLength)for(;i--&&r.getInt8(i)===t.getInt8(i););return i===-1}if(ArrayBuffer.isView(r)){if((i=r.byteLength)===t.byteLength)for(;i--&&r[i]===t[i];);return i===-1}if(!e||typeof r=="object"){i=0;for(e in r)if(wr.call(r,e)&&++i&&!wr.call(t,e)||!(e in t)||!Be(r[e],t[e]))return!1;return Object.keys(t).length===i}}return r!==r&&t!==t}const oo=M.createContext(null);function je({children:r,type:t}){return B.jsx("div",{className:`react-pdf__message react-pdf__message--${t}`,children:r})}const Du="noopener noreferrer nofollow";class Fu{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(t){this.pdfDocument=t}setViewer(t){this.pdfViewer=t}setExternalLinkRel(t){this.externalLinkRel=t}setExternalLinkTarget(t){this.externalLinkTarget=t}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return mt(this.pdfViewer),this.pdfViewer.currentPageNumber||0}set page(t){mt(this.pdfViewer),this.pdfViewer.currentPageNumber=t}get rotation(){return 0}set rotation(t){}goToDestination(t){return new Promise(e=>{mt(this.pdfDocument),mt(t),typeof t=="string"?this.pdfDocument.getDestination(t).then(e):Array.isArray(t)?e(t):t.then(e)}).then(e=>{mt(Array.isArray(e));const i=e[0];new Promise(n=>{mt(this.pdfDocument),i instanceof Object?this.pdfDocument.getPageIndex(i).then(s=>{n(s)}).catch(()=>{mt(!1)}):typeof i=="number"?n(i):mt(!1)}).then(n=>{const s=n+1;mt(this.pdfViewer),mt(s>=1&&s<=this.pagesCount),this.pdfViewer.scrollPageIntoView({dest:e,pageIndex:n,pageNumber:s})})})}navigateTo(t){this.goToDestination(t)}goToPage(t){const e=t-1;mt(this.pdfViewer),mt(t>=1&&t<=this.pagesCount),this.pdfViewer.scrollPageIntoView({pageIndex:e,pageNumber:t})}addLinkAttributes(t,e,i){t.href=e,t.rel=this.externalLinkRel||Du,t.target=i?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}}const Sr={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},nn=typeof document<"u",lo=nn&&window.location.protocol==="file:";function Nu(r){return typeof r<"u"}function be(r){return Nu(r)&&r!==null}function Bu(r){return typeof r=="string"}function ju(r){return r instanceof ArrayBuffer}function Hu(r){return mt(nn),r instanceof Blob}function Un(r){return Bu(r)&&/^data:/.test(r)}function Tr(r){mt(Un(r));const[t="",e=""]=r.split(",");return t.split(";").indexOf("base64")!==-1?atob(e):unescape(e)}function Uu(){return nn&&window.devicePixelRatio||1}const co="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function Cr(){It(!lo,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${co}`)}function $u(){It(!lo,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${co}`)}function Se(r){r&&r.cancel&&r.cancel()}function $n(r,t){return Object.defineProperty(r,"width",{get(){return this.view[2]*t},configurable:!0}),Object.defineProperty(r,"height",{get(){return this.view[3]*t},configurable:!0}),Object.defineProperty(r,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(r,"originalHeight",{get(){return this.view[3]},configurable:!0}),r}function zu(r){return r.name==="RenderingCancelledException"}function Gu(r){return new Promise((t,e)=>{const i=new FileReader;i.onload=()=>{if(!i.result)return e(new Error("Error while reading a file."));t(i.result)},i.onerror=n=>{if(!n.target)return e(new Error("Error while reading a file."));const{error:s}=n.target;if(!s)return e(new Error("Error while reading a file."));switch(s.code){case s.NOT_FOUND_ERR:return e(new Error("Error while reading a file: File not found."));case s.SECURITY_ERR:return e(new Error("Error while reading a file: Security error."));case s.ABORT_ERR:return e(new Error("Error while reading a file: Aborted."));default:return e(new Error("Error while reading a file."))}},i.readAsArrayBuffer(r)})}function Vu(r,t){switch(t.type){case"RESOLVE":return{value:t.value,error:void 0};case"REJECT":return{value:!1,error:t.error};case"RESET":return{value:void 0,error:void 0};default:return r}}function Ge(){return M.useReducer(Vu,{value:void 0,error:void 0})}var Wu=function(r,t,e,i){function n(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function o(h){try{c(i.next(h))}catch(d){a(d)}}function l(h){try{c(i.throw(h))}catch(d){a(d)}}function c(h){h.done?s(h.value):n(h.value).then(o,l)}c((i=i.apply(r,t||[])).next())})},Pr=function(r,t){var e={};for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&t.indexOf(i)<0&&(e[i]=r[i]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(r);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(r,i[n])&&(e[i[n]]=r[i[n]]);return e};const{PDFDataRangeTransport:Yu}=uu,qu=(r,t)=>{switch(t){case Sr.NEED_PASSWORD:{const e=prompt("Enter the password to open this PDF file.");r(e);break}case Sr.INCORRECT_PASSWORD:{const e=prompt("Invalid password. Please try again.");r(e);break}}};function Rr(r){return typeof r=="object"&&r!==null&&("data"in r||"range"in r||"url"in r)}const Xu=M.forwardRef(function(t,e){var{children:i,className:n,error:s="Failed to load PDF file.",externalLinkRel:a,externalLinkTarget:o,file:l,inputRef:c,imageResourcesPath:h,loading:d="Loading PDF",noData:u="No PDF file specified.",onItemClick:p,onLoadError:f,onLoadProgress:m,onLoadSuccess:b,onPassword:g=qu,onSourceError:y,onSourceSuccess:x,options:w,renderMode:v,rotate:R}=t,I=Pr(t,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate"]);const[j,H]=Ge(),{value:z,error:D}=j,[$,W]=Ge(),{value:Y,error:G}=$,J=M.useRef(new Fu),F=M.useRef([]),_=M.useRef(void 0),A=M.useRef(void 0);l&&l!==_.current&&Rr(l)&&(It(!Be(l,_.current),`File prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.`),_.current=l),w&&w!==A.current&&(It(!Be(w,A.current),`Options prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.`),A.current=w);const C=M.useRef({scrollPageIntoView:K=>{const{dest:tt,pageNumber:ht,pageIndex:Et=ht-1}=K;if(p){p({dest:tt,pageIndex:Et,pageNumber:ht});return}const bt=F.current[Et];if(bt){bt.scrollIntoView();return}It(!1,`An internal link leading to page ${ht} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});M.useImperativeHandle(e,()=>({linkService:J,pages:F,viewer:C}),[]);function O(){x&&x()}function S(){D&&(It(!1,D.toString()),y&&y(D))}function T(){H({type:"RESET"})}M.useEffect(T,[l,H]);const L=M.useCallback(()=>Wu(this,void 0,void 0,function*(){if(!l)return null;if(typeof l=="string")return Un(l)?{data:Tr(l)}:(Cr(),{url:l});if(l instanceof Yu)return{range:l};if(ju(l))return{data:l};if(nn&&Hu(l))return{data:yield Gu(l)};if(mt(typeof l=="object"),mt(Rr(l)),"url"in l&&typeof l.url=="string"){if(Un(l.url)){const{url:K}=l,tt=Pr(l,["url"]),ht=Tr(K);return Object.assign({data:ht},tt)}Cr()}return l}),[l]);M.useEffect(()=>{const K=ui(L());return K.promise.then(tt=>{H({type:"RESOLVE",value:tt})}).catch(tt=>{H({type:"REJECT",error:tt})}),()=>{Se(K)}},[L,H]),M.useEffect(()=>{if(!(typeof z>"u")){if(z===!1){S();return}O()}},[z]);function U(){Y&&(b&&b(Y),F.current=new Array(Y.numPages),J.current.setDocument(Y))}function E(){G&&(It(!1,G.toString()),f&&f(G))}function N(){W({type:"RESET"})}M.useEffect(N,[W,z]);function k(){if(!z)return;const K=Object.assign(Object.assign({},z),w),tt=ro(K);m&&(tt.onProgress=m),g&&(tt.onPassword=g);const ht=tt;return ht.promise.then(Et=>{W({type:"RESOLVE",value:Et})}).catch(Et=>{ht.destroyed||W({type:"REJECT",error:Et})}),()=>{ht.destroy()}}M.useEffect(k,[w,W,z]),M.useEffect(()=>{if(!(typeof Y>"u")){if(Y===!1){E();return}U()}},[Y]);function rt(){J.current.setViewer(C.current),J.current.setExternalLinkRel(a),J.current.setExternalLinkTarget(o)}M.useEffect(rt,[a,o]);function V(K,tt){F.current[K]=tt}function at(K){delete F.current[K]}const X=M.useMemo(()=>({imageResourcesPath:h,linkService:J.current,onItemClick:p,pdf:Y,registerPage:V,renderMode:v,rotate:R,unregisterPage:at}),[h,p,Y,v,R]),Q=M.useMemo(()=>ao(I,()=>Y),[I,Y]);function ot(){return B.jsx(oo.Provider,{value:X,children:i})}function et(){return l?Y==null?B.jsx(je,{type:"loading",children:typeof d=="function"?d():d}):Y===!1?B.jsx(je,{type:"error",children:typeof s=="function"?s():s}):ot():B.jsx(je,{type:"no-data",children:typeof u=="function"?u():u})}return B.jsx("div",Object.assign({className:Bi("react-pdf__Document",n),ref:c,style:{"--scale-factor":"1"}},Q,{children:et()}))});function ho(){return M.useContext(oo)}function uo(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var e=r.filter(Boolean);if(e.length<=1){var i=e[0];return i||null}return function(s){e.forEach(function(a){typeof a=="function"?a(s):a&&(a.current=s)})}}const fo=M.createContext(null),po={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},Ku=/^H(\d+)$/;function Zu(r){return r in po}function sn(r){return"children"in r}function go(r){return sn(r)?r.children.length===1&&0 in r.children&&"id"in r.children[0]:!1}function Qu(r){const t={};if(sn(r)){const{role:e}=r,i=e.match(Ku);if(i)t.role="heading",t["aria-level"]=Number(i[1]);else if(Zu(e)){const n=po[e];n&&(t.role=n)}}return t}function mo(r){const t={};if(sn(r)){if(r.alt!==void 0&&(t["aria-label"]=r.alt),r.lang!==void 0&&(t.lang=r.lang),go(r)){const[e]=r.children;if(e){const i=mo(e);return Object.assign(Object.assign({},t),i)}}}else"id"in r&&(t["aria-owns"]=r.id);return t}function Ju(r){return r?Object.assign(Object.assign({},Qu(r)),mo(r)):null}function bo({className:r,node:t}){const e=M.useMemo(()=>Ju(t),[t]),i=M.useMemo(()=>!sn(t)||go(t)?null:t.children.map((n,s)=>B.jsx(bo,{node:n},s)),[t]);return B.jsx("span",Object.assign({className:r},e,{children:i}))}function rn(){return M.useContext(fo)}function tf(){const r=rn();mt(r);const{onGetStructTreeError:t,onGetStructTreeSuccess:e}=r,[i,n]=Ge(),{value:s,error:a}=i,{customTextRenderer:o,page:l}=r;function c(){s&&e&&e(s)}function h(){a&&(It(!1,a.toString()),t&&t(a))}function d(){n({type:"RESET"})}M.useEffect(d,[n,l]);function u(){if(o||!l)return;const p=ui(l.getStructTree()),f=p;return p.promise.then(m=>{n({type:"RESOLVE",value:m})}).catch(m=>{n({type:"REJECT",error:m})}),()=>Se(f)}return M.useEffect(u,[o,l,n]),M.useEffect(()=>{if(s!==void 0){if(s===!1){h();return}c()}},[s]),s?B.jsx(bo,{className:"react-pdf__Page__structTree structTree",node:s}):null}const Lr=no;function ef(r){const t=rn();mt(t);const e=Object.assign(Object.assign({},t),r),{_className:i,canvasBackground:n,devicePixelRatio:s=Uu(),onRenderError:a,onRenderSuccess:o,page:l,renderForms:c,renderTextLayer:h,rotate:d,scale:u}=e,{canvasRef:p}=r;mt(l);const f=M.useRef(null);function m(){l&&o&&o($n(l,u))}function b(v){zu(v)||(It(!1,v.toString()),a&&a(v))}const g=M.useMemo(()=>l.getViewport({scale:u*s,rotation:d}),[s,l,d,u]),y=M.useMemo(()=>l.getViewport({scale:u,rotation:d}),[l,d,u]);function x(){if(!l)return;l.cleanup();const{current:v}=f;if(!v)return;v.width=g.width,v.height=g.height,v.style.width=`${Math.floor(y.width)}px`,v.style.height=`${Math.floor(y.height)}px`,v.style.visibility="hidden";const R={annotationMode:c?Lr.ENABLE_FORMS:Lr.ENABLE,canvasContext:v.getContext("2d",{alpha:!1}),viewport:g};n&&(R.background=n);const I=l.render(R),j=I;return I.promise.then(()=>{v.style.visibility="",m()}).catch(b),()=>Se(j)}M.useEffect(x,[n,f,s,l,c,g,y]);const w=M.useCallback(()=>{const{current:v}=f;v&&(v.width=0,v.height=0)},[f]);return M.useEffect(()=>w,[w]),B.jsx("canvas",{className:`${i}__canvas`,dir:"ltr",ref:uo(p,f),style:{display:"block",userSelect:"none"},children:h?B.jsx(tf,{}):null})}function nf(r){return"str"in r}function sf(){const r=rn();mt(r);const{customTextRenderer:t,onGetTextError:e,onGetTextSuccess:i,onRenderTextLayerError:n,onRenderTextLayerSuccess:s,page:a,pageIndex:o,pageNumber:l,rotate:c,scale:h}=r;mt(a);const[d,u]=Ge(),{value:p,error:f}=d,m=M.useRef(null),b=M.useRef(void 0);It(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function g(){p&&i&&i(p)}function y(){f&&(It(!1,f.toString()),e&&e(f))}function x(){u({type:"RESET"})}M.useEffect(x,[a,u]);function w(){if(!a)return;const D=ui(a.getTextContent()),$=D;return D.promise.then(W=>{u({type:"RESOLVE",value:W})}).catch(W=>{u({type:"REJECT",error:W})}),()=>Se($)}M.useEffect(w,[a,u]),M.useEffect(()=>{if(p!==void 0){if(p===!1){y();return}g()}},[p]);const v=M.useCallback(()=>{s&&s()},[s]),R=M.useCallback(D=>{It(!1,D.toString()),n&&n(D)},[n]);function I(){const D=b.current;D&&D.classList.add("active")}function j(){const D=b.current;D&&D.classList.remove("active")}const H=M.useMemo(()=>a.getViewport({scale:h,rotation:c}),[a,c,h]);function z(){if(!a||!p)return;const{current:D}=m;if(!D)return;D.innerHTML="";const $=a.streamTextContent({includeMarkedContent:!0}),W={container:D,textContentSource:$,viewport:H},Y=new so(W),G=Y;return Y.render().then(()=>{const J=document.createElement("div");J.className="endOfContent",D.append(J),b.current=J;const F=D.querySelectorAll('[role="presentation"]');if(t){let _=0;p.items.forEach((A,C)=>{if(!nf(A))return;const O=F[_];if(!O)return;const S=t(Object.assign({pageIndex:o,pageNumber:l,itemIndex:C},A));O.innerHTML=S,_+=A.str&&A.hasEOL?2:1})}v()}).catch(R),()=>Se(G)}return M.useLayoutEffect(z,[t,R,v,a,o,l,p,H]),B.jsx("div",{className:Bi("react-pdf__Page__textContent","textLayer"),onMouseUp:j,onMouseDown:I,ref:m})}function rf(){const r=ho(),t=rn();mt(t);const e=Object.assign(Object.assign({},r),t),{imageResourcesPath:i,linkService:n,onGetAnnotationsError:s,onGetAnnotationsSuccess:a,onRenderAnnotationLayerError:o,onRenderAnnotationLayerSuccess:l,page:c,pdf:h,renderForms:d,rotate:u,scale:p=1}=e;mt(h),mt(c),mt(n);const[f,m]=Ge(),{value:b,error:g}=f,y=M.useRef(null);It(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function x(){b&&a&&a(b)}function w(){g&&(It(!1,g.toString()),s&&s(g))}function v(){m({type:"RESET"})}M.useEffect(v,[m,c]);function R(){if(!c)return;const D=ui(c.getAnnotations()),$=D;return D.promise.then(W=>{m({type:"RESOLVE",value:W})}).catch(W=>{m({type:"REJECT",error:W})}),()=>{Se($)}}M.useEffect(R,[m,c,d]),M.useEffect(()=>{if(b!==void 0){if(b===!1){w();return}x()}},[b]);function I(){l&&l()}function j(D){It(!1,`${D}`),o&&o(D)}const H=M.useMemo(()=>c.getViewport({scale:p,rotation:u}),[c,u,p]);function z(){if(!h||!c||!n||!b)return;const{current:D}=y;if(!D)return;const $=H.clone({dontFlip:!0}),W={accessibilityManager:null,annotationCanvasMap:null,annotationEditorUIManager:null,div:D,l10n:null,page:c,viewport:$},Y={annotations:b,annotationStorage:h.annotationStorage,div:D,imageResourcesPath:i,linkService:n,page:c,renderForms:d,viewport:$};D.innerHTML="";try{new io(W).render(Y),I()}catch(G){j(G)}return()=>{}}return M.useEffect(z,[b,i,n,c,d,H]),B.jsx("div",{className:Bi("react-pdf__Page__annotations","annotationLayer"),ref:y})}var af=function(r,t){var e={};for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&t.indexOf(i)<0&&(e[i]=r[i]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(r);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(r,i[n])&&(e[i[n]]=r[i[n]]);return e};const kr=1;function of(r){const t=ho(),e=Object.assign(Object.assign({},t),r),{_className:i="react-pdf__Page",_enableRegisterUnregisterPage:n=!0,canvasBackground:s,canvasRef:a,children:o,className:l,customRenderer:c,customTextRenderer:h,devicePixelRatio:d,error:u="Failed to load the page.",height:p,inputRef:f,loading:m="Loading page",noData:b="No page specified.",onGetAnnotationsError:g,onGetAnnotationsSuccess:y,onGetStructTreeError:x,onGetStructTreeSuccess:w,onGetTextError:v,onGetTextSuccess:R,onLoadError:I,onLoadSuccess:j,onRenderAnnotationLayerError:H,onRenderAnnotationLayerSuccess:z,onRenderError:D,onRenderSuccess:$,onRenderTextLayerError:W,onRenderTextLayerSuccess:Y,pageIndex:G,pageNumber:J,pdf:F,registerPage:_,renderAnnotationLayer:A=!0,renderForms:C=!1,renderMode:O="canvas",renderTextLayer:S=!0,rotate:T,scale:L=kr,unregisterPage:U,width:E}=e,N=af(e,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customRenderer","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[k,rt]=Ge(),{value:V,error:at}=k,X=M.useRef(null);mt(F);const Q=be(J)?J-1:G??null,ot=J??(be(G)?G+1:null),et=T??(V?V.rotate:null),K=M.useMemo(()=>{if(!V)return null;let Re=1;const cn=L??kr;if(E||p){const Le=V.getViewport({scale:1,rotation:et});E?Re=E/Le.width:p&&(Re=p/Le.height)}return cn*Re},[p,V,et,L,E]);function tt(){return()=>{be(Q)&&n&&U&&U(Q)}}M.useEffect(tt,[n,F,Q,U]);function ht(){if(j){if(!V||!K)return;j($n(V,K))}if(n&&_){if(!be(Q)||!X.current)return;_(Q,X.current)}}function Et(){at&&(It(!1,at.toString()),I&&I(at))}function bt(){rt({type:"RESET"})}M.useEffect(bt,[rt,F,Q]);function $t(){if(!F||!ot)return;const Re=ui(F.getPage(ot)),cn=Re;return Re.promise.then(Le=>{rt({type:"RESOLVE",value:Le})}).catch(Le=>{rt({type:"REJECT",error:Le})}),()=>Se(cn)}M.useEffect($t,[rt,F,Q,ot,_]),M.useEffect(()=>{if(V!==void 0){if(V===!1){Et();return}ht()}},[V,K]);const te=M.useMemo(()=>V&&be(Q)&&ot&&be(et)&&be(K)?{_className:i,canvasBackground:s,customTextRenderer:h,devicePixelRatio:d,onGetAnnotationsError:g,onGetAnnotationsSuccess:y,onGetStructTreeError:x,onGetStructTreeSuccess:w,onGetTextError:v,onGetTextSuccess:R,onRenderAnnotationLayerError:H,onRenderAnnotationLayerSuccess:z,onRenderError:D,onRenderSuccess:$,onRenderTextLayerError:W,onRenderTextLayerSuccess:Y,page:V,pageIndex:Q,pageNumber:ot,renderForms:C,renderTextLayer:S,rotate:et,scale:K}:null,[i,s,h,d,g,y,x,w,v,R,H,z,D,$,W,Y,V,Q,ot,C,S,et,K]),Ct=M.useMemo(()=>ao(N,()=>V&&(K?$n(V,K):void 0)),[N,V,K]),Z=`${Q}@${K}/${et}`;function pt(){switch(O){case"custom":return mt(c),B.jsx(c,{},`${Z}_custom`);case"none":return null;case"canvas":default:return B.jsx(ef,{canvasRef:a},`${Z}_canvas`)}}function le(){return S?B.jsx(sf,{},`${Z}_text`):null}function me(){return A?B.jsx(rf,{},`${Z}_annotations`):null}function qt(){return B.jsxs(fo.Provider,{value:te,children:[pt(),le(),me(),o]})}function Po(){return ot?F===null||V===void 0||V===null?B.jsx(je,{type:"loading",children:typeof m=="function"?m():m}):F===!1||V===!1?B.jsx(je,{type:"error",children:typeof u=="function"?u():u}):qt():B.jsx(je,{type:"no-data",children:typeof b=="function"?b():b})}return B.jsx("div",Object.assign({className:Bi(i,l),"data-page-number":ot,ref:uo(f,X),style:{"--scale-factor":`${K}`,backgroundColor:s||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},Ct,{children:Po()}))}$u();fs.workerSrc="pdf.worker.mjs";var lf=function(){return import.meta.url},vo="SET_ZOOM_LEVEL",En=function(r){return{type:vo,value:r}},yo="SET_PDF_PAGINATED",cf=function(r){return{type:yo,value:r}},_o="SET_NUM_PAGES",Ir=function(r){return{type:_o,value:r}},Ao="SET_CURRENT_PAGE",Mr=function(r){return{type:Ao,value:r}},Kt=function(){return Kt=Object.assign||function(r){for(var t,e=1,i=arguments.length;e<i;e++){t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Kt.apply(this,arguments)},Ve={zoomLevel:1,paginated:!0,numPages:0,currentPage:1},hf=function(r,t){switch(r===void 0&&(r=Ve),t.type){case vo:{var e=t.value;return Kt(Kt({},r),{zoomLevel:e})}case yo:{var e=t.value;return Kt(Kt({},r),{paginated:e})}case _o:{var e=t.value;return Kt(Kt({},r),{numPages:e})}case Ao:{var e=t.value;return Kt(Kt({},r),{currentPage:e})}default:return r}},Di=function(){return Di=Object.assign||function(r){for(var t,e=1,i=arguments.length;e<i;e++){t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Di.apply(this,arguments)},Xe=M.createContext({state:Ve,dispatch:function(){return null}}),df=function(r){var t=r.children,e=r.mainState,i=M.useReducer(hf,Di(Di({},Ve),{mainState:e})),n=i[0],s=i[1];return P.createElement(Xe.Provider,{value:{state:n,dispatch:s}},t)},We=function(){return We=Object.assign||function(r){for(var t,e=1,i=arguments.length;e<i;e++){t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},We.apply(this,arguments)},uf=function(r){return P.createElement(Eo,We({},r,{reverse:!0}))},ff=function(r){return P.createElement(Eo,We({},r))},Eo=function(r){var t=r.color,e=r.size,i=r.reverse;return P.createElement("svg",{width:e||"100%",height:e||"100%",style:{transform:"".concat(i?"rotate(180deg)":"")},viewBox:"0 0 12 12",version:"1.1"},P.createElement("g",{id:"Icons",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},P.createElement("g",{id:"Rounded",transform:"translate(-548.000000, -1000.000000)"},P.createElement("g",{id:"AV",transform:"translate(100.000000, 852.000000)"},P.createElement("g",{id:"-Round-/-AV-/-skip_next",transform:"translate(442.000000, 142.000000)"},P.createElement("g",null,P.createElement("rect",{id:"Rectangle-Copy-52",x:"0",y:"0",width:"24",height:"24"}),P.createElement("path",{d:"M7.58,16.89 L13.35,12.82 C13.91,12.42 13.91,11.58 13.35,11.19 L7.58,7.11 C6.91,6.65 6,7.12 6,7.93 L6,16.07 C6,16.88 6.91,17.35 7.58,16.89 Z M16,7 L16,17 C16,17.55 16.45,18 17,18 C17.55,18 18,17.55 18,17 L18,7 C18,6.45 17.55,6 17,6 C16.45,6 16,6.45 16,7 Z",id:"icon_color",fill:t||"#aaa"})))))))},pf=function(r){var t=r.color,e=r.size,i=r.reverse;return P.createElement("svg",{width:e||"100%",height:e||"100%",style:{transform:"".concat(i?"rotate(180deg)":"")},id:"Layer_1",viewBox:"0 0 24 24"},P.createElement("path",{d:"M20.57,9.43A8,8,0,0,0,5.26,10,5,5,0,1,0,5,20h5V18H5a3,3,0,0,1,0-6,3.1,3.1,0,0,1,.79.12l1.12.31.14-1.15a6,6,0,0,1,11.74-.82l.15.54.54.16A3.46,3.46,0,0,1,22,14.5,3.5,3.5,0,0,1,18.5,18H16v2h2.5A5.48,5.48,0,0,0,20.57,9.43Z",fill:t||"#aaa"}),P.createElement("polygon",{points:"12 11 12 15.59 10.71 14.29 9.29 15.71 13 19.41 16.71 15.71 15.29 14.29 14 15.59 14 11 12 11",fill:t||"#aaa"}))},gf=function(r){return P.createElement(wo,We({},r))},mf=function(r){return P.createElement(wo,We({},r,{reverse:!0}))},wo=function(r){var t=r.color,e=r.size,i=r.reverse;return P.createElement("svg",{width:e||"100%",height:e||"100%",viewBox:"0 0 32 32",version:"1.1"},P.createElement("g",{id:"Page-1",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},P.createElement("g",{id:"search-plus-icon",fill:t||"#aaa"},P.createElement("path",{id:"search-plus",d:i?"M 13 13 L 16 13 L 19 13 L 19 16 L 16 16 L 13 16 L 10 16 L 10 13 Z M 19.4271 21.4271 C 18.0372 22.4175 16.3367 23 14.5 23 C 9.8056 23 6 19.1944 6 14.5 C 6 9.8056 9.8056 6 14.5 6 C 19.1944 6 23 9.8056 23 14.5 C 23 16.3367 22.4175 18.0372 21.4271 19.4271 L 27.0119 25.0119 C 27.5621 25.5621 27.5575 26.4425 27.0117 26.9883 L 26.9883 27.0117 C 26.4439 27.5561 25.5576 27.5576 25.0119 27.0119 L 19.4271 21.4271 L 19.4271 21.4271 L 19.4271 21.4271 Z M 14.5 21 C 18.0899 21 21 18.0899 21 14.5 C 21 10.9101 18.0899 8 14.5 8 C 10.9101 8 8 10.9101 8 14.5 C 8 18.0899 10.9101 21 14.5 21 L 14.5 21 Z":"M 13 13 L 13 10 L 16 10 L 16 13 L 19 13 L 19 16 L 16 16 L 16 19 L 13 19 L 13 16 L 10 16 L 10 13 Z M 19.4271 21.4271 C 18.0372 22.4175 16.3367 23 14.5 23 C 9.8056 23 6 19.1944 6 14.5 C 6 9.8056 9.8056 6 14.5 6 C 19.1944 6 23 9.8056 23 14.5 C 23 16.3367 22.4175 18.0372 21.4271 19.4271 L 27.0119 25.0119 C 27.5621 25.5621 27.5575 26.4425 27.0117 26.9883 L 26.9883 27.0117 C 26.4439 27.5561 25.5576 27.5576 25.0119 27.0119 L 19.4271 21.4271 L 19.4271 21.4271 L 19.4271 21.4271 Z M 14.5 21 C 18.0899 21 21 18.0899 21 14.5 C 21 10.9101 18.0899 8 14.5 8 C 10.9101 8 8 10.9101 8 14.5 C 8 18.0899 10.9101 21 14.5 21 L 14.5 21 Z"}))))},bf=function(r){var t=r.color,e=r.size;return P.createElement("svg",{width:e||"100%",height:e||"100%",viewBox:"0 0 24 24"},P.createElement("path",{fill:t||"#aaa",d:"M9.29,13.29,4,18.59V17a1,1,0,0,0-2,0v4a1,1,0,0,0,.08.38,1,1,0,0,0,.54.54A1,1,0,0,0,3,22H7a1,1,0,0,0,0-2H5.41l5.3-5.29a1,1,0,0,0-1.42-1.42ZM5.41,4H7A1,1,0,0,0,7,2H3a1,1,0,0,0-.38.08,1,1,0,0,0-.54.54A1,1,0,0,0,2,3V7A1,1,0,0,0,4,7V5.41l5.29,5.3a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42ZM21,16a1,1,0,0,0-1,1v1.59l-5.29-5.3a1,1,0,0,0-1.42,1.42L18.59,20H17a1,1,0,0,0,0,2h4a1,1,0,0,0,.38-.08,1,1,0,0,0,.54-.54A1,1,0,0,0,22,21V17A1,1,0,0,0,21,16Zm.92-13.38a1,1,0,0,0-.54-.54A1,1,0,0,0,21,2H17a1,1,0,0,0,0,2h1.59l-5.3,5.29a1,1,0,0,0,0,1.42,1,1,0,0,0,1.42,0L20,5.41V7a1,1,0,0,0,2,0V3A1,1,0,0,0,21.92,2.62Z"}))},vf=function(r){var t=r.color,e=r.size,i=r.reverse;return P.createElement("svg",{width:e||"100%",height:e||"100%",style:{transform:"".concat(i?"rotate(90deg)":"")},version:"1.1",id:"Scroll_1",viewBox:"0 0 297 297",xmlSpace:"preserve"},P.createElement("path",{fill:t||"#aaa",d:`M206.004,200.723h-31.231V96.277h31.231c0.005,0,0.014,0,0.019,0c5.289,0,9.575-4.287,9.575-9.574
  c0-2.342-0.841-4.488-2.236-6.151L156.168,3.851C154.36,1.428,151.515,0,148.492,0c-3.023,0-5.868,1.428-7.675,3.851L83.302,80.98
  c-2.166,2.902-2.507,6.779-0.883,10.017c1.624,3.236,4.936,5.28,8.559,5.28h31.231v104.445H90.978c-3.623,0-6.934,2.044-8.559,5.28
  c-1.624,3.237-1.283,7.114,0.883,10.017l57.513,77.129c1.808,2.424,4.652,3.852,7.675,3.852c3.023,0,5.868-1.428,7.676-3.852
  l57.514-77.129c2.164-2.902,2.507-6.779,0.883-10.017C212.938,202.767,209.627,200.723,206.004,200.723z`}))},an=function(r,t){return Object.defineProperty?Object.defineProperty(r,"raw",{value:t}):r.raw=t,r},yf=function(){var r=M.useContext(Xe),t=r.state,e=t.currentPage,i=t.numPages,n=r.dispatch;return P.createElement(_f,{id:"pdf-pagination"},P.createElement(xo,{id:"pdf-pagination-prev",onClick:function(){return n(Mr(e-1))},disabled:e===1},P.createElement(uf,{color:"#000",size:"50%"})),P.createElement(Ef,{id:"pdf-pagination-info"},"Page ",e,"/",i),P.createElement(Af,{id:"pdf-pagination-next",onClick:function(){return n(Mr(e+1))},disabled:e>=i},P.createElement(ff,{color:"#000",size:"50%"})))},_f=lt.div(Or||(Or=an([`
  display: flex;
  align-items: center;
`],[`
  display: flex;
  align-items: center;
`]))),xo=lt(Hi)(Dr||(Dr=an([`
  width: 30px;
  height: 30px;
  margin: 0 5px;

  @media (max-width: 768px) {
    width: 25px;
    height: 25px;
  }
`],[`
  width: 30px;
  height: 30px;
  margin: 0 5px;

  @media (max-width: 768px) {
    width: 25px;
    height: 25px;
  }
`]))),Af=lt(xo)(Fr||(Fr=an([`
  margin: 0 20px 0 5px;
`],[`
  margin: 0 20px 0 5px;
`]))),Ef=lt.div(Nr||(Nr=an([`
  color: `,`;
  font-size: 14px;
  text-align: left;

  @media (max-width: 768px) {
    font-size: 10px;
  }
`],[`
  color: `,`;
  font-size: 14px;
  text-align: left;

  @media (max-width: 768px) {
    font-size: 10px;
  }
`])),function(r){return r.theme.text_primary}),Or,Dr,Fr,Nr,ps=function(r,t){return Object.defineProperty?Object.defineProperty(r,"raw",{value:t}):r.raw=t,r},wf=function(){var r=M.useContext(Xe),t=r.state,e=t.mainState,i=t.paginated,n=t.zoomLevel,s=t.numPages,a=r.dispatch,o=e?.currentDocument||null;return P.createElement(xf,{id:"pdf-controls"},i&&s>1&&P.createElement(yf,null),o?.fileData&&P.createElement(Sf,{id:"pdf-download",href:o?.fileData,download:o?.uri},P.createElement(pf,{color:"#000",size:"75%"})),P.createElement(Ei,{id:"pdf-zoom-out",onMouseDown:function(){return a(En(n-.1))}},P.createElement(mf,{color:"#000",size:"80%"})),P.createElement(Ei,{id:"pdf-zoom-in",onMouseDown:function(){return a(En(n+.1))}},P.createElement(gf,{color:"#000",size:"80%"})),P.createElement(Ei,{id:"pdf-zoom-reset",onMouseDown:function(){return a(En(Ve.zoomLevel))},disabled:n===Ve.zoomLevel},P.createElement(bf,{color:"#000",size:"70%"})),s>1&&P.createElement(Ei,{id:"pdf-toggle-pagination",onMouseDown:function(){return a(cf(!i))}},P.createElement(vf,{color:"#000",size:"70%",reverse:i})))},xf=lt.div(Br||(Br=ps([`
  display: flex;
  position: sticky;
  top: 0;
  left: 0;
  z-index: 1;
  justify-content: flex-end;
  padding: 8px;
  background-color: `,`;
  box-shadow: 0px 2px 3px #00000033;

  @media (max-width: 768px) {
    padding: 6px;
  }
`],[`
  display: flex;
  position: sticky;
  top: 0;
  left: 0;
  z-index: 1;
  justify-content: flex-end;
  padding: 8px;
  background-color: `,`;
  box-shadow: 0px 2px 3px #00000033;

  @media (max-width: 768px) {
    padding: 6px;
  }
`])),function(r){return r.theme.tertiary}),Ei=lt(Hi)(jr||(jr=ps([`
  width: 30px;
  height: 30px;
  @media (max-width: 768px) {
    width: 25px;
    height: 25px;
  }
`],[`
  width: 30px;
  height: 30px;
  @media (max-width: 768px) {
    width: 25px;
    height: 25px;
  }
`]))),Sf=lt(ya)(Hr||(Hr=ps([`
  width: 30px;
  height: 30px;
  @media (max-width: 768px) {
    width: 25px;
    height: 25px;
  }
`],[`
  width: 30px;
  height: 30px;
  @media (max-width: 768px) {
    width: 25px;
    height: 25px;
  }
`]))),Br,jr,Hr,So=function(r,t){return Object.defineProperty?Object.defineProperty(r,"raw",{value:t}):r.raw=t,r},To=function(r){var t=r.pageNum,e=M.useContext(Xe).state,i=e.mainState,n=e.paginated,s=e.zoomLevel,a=e.numPages,o=e.currentPage,l=i?.rendererRect||null,c=t||o;return P.createElement(Tf,{id:"pdf-page-wrapper",last:c>=a},!n&&P.createElement(Cf,{id:"pdf-page-info"},"Page ",c,"/",a),P.createElement(of,{pageNumber:c||o,scale:s,height:(l?.height||100)-100,width:(l?.width||100)-100}))},Tf=lt.div(Ur||(Ur=So([`
  margin: 20px 0;
`],[`
  margin: 20px 0;
`]))),Cf=lt.div($r||($r=So([`
  padding: 0 0 10px 10px;
  color: `,`;
  font-size: 14px;
  text-align: left;

  @media (max-width: 768px) {
    font-size: 10px;
  }
`],[`
  padding: 0 0 10px 10px;
  color: `,`;
  font-size: 14px;
  text-align: left;

  @media (max-width: 768px) {
    font-size: 10px;
  }
`])),function(r){return r.theme.text_tertiary}),Ur,$r,Pf=function(r){for(var t=M.useContext(Xe).state.numPages,e=[],i=0;i<t;i++)e.push(P.createElement(To,{key:i+1,pageNum:i+1}));return P.createElement(P.Fragment,null,e)},Rf=function(r,t){return Object.defineProperty?Object.defineProperty(r,"raw",{value:t}):r.raw=t,r},Lf=function(){var r=M.useContext(Xe),t=r.state,e=t.mainState,i=t.paginated,n=r.dispatch,s=e?.currentDocument||null;return M.useEffect(function(){n(Ir(Ve.numPages))},[s]),!s||s.fileData===void 0?null:P.createElement(kf,{file:s.fileData,onLoadSuccess:function(a){var o=a.numPages;return n(Ir(o))},loading:P.createElement("span",null,"Loading...")},i?P.createElement(To,null):P.createElement(Pf,null))},kf=lt(Xu)(zr||(zr=Rf([`
  display: flex;
  flex-direction: column;
  margin: 0 auto;
`],[`
  display: flex;
  flex-direction: column;
  margin: 0 auto;
`]))),zr,If=function(r,t){return Object.defineProperty?Object.defineProperty(r,"raw",{value:t}):r.raw=t,r};fs.workerSrc=new URL("pdfjs-dist/build/pdf.worker.min.mjs",lf()).toString();var gs=function(r){var t=r.mainState;return P.createElement(df,{mainState:t},P.createElement(Mf,{id:"pdf-renderer","data-testid":"pdf-renderer"},P.createElement(wf,null),P.createElement(Lf,null)))};gs.fileTypes=["pdf","application/pdf"];gs.weight=0;var Mf=lt.div(Gr||(Gr=If([`
  display: flex;
  flex-direction: column;
  flex: 1;
  overflow-y: auto;

  /* width */
  &::-webkit-scrollbar {
    `,`;
  }
  /* Track */
  &::-webkit-scrollbar-track {
    /* background: `,`; */
  }
  /* Handle */
  &::-webkit-scrollbar-thumb {
    background: `,`;
  }
  /* Handle on hover */
  &::-webkit-scrollbar-thumb:hover {
    background: `,`;
  }
`],[`
  display: flex;
  flex-direction: column;
  flex: 1;
  overflow-y: auto;

  /* width */
  &::-webkit-scrollbar {
    `,`;
  }
  /* Track */
  &::-webkit-scrollbar-track {
    /* background: `,`; */
  }
  /* Handle */
  &::-webkit-scrollbar-thumb {
    background: `,`;
  }
  /* Handle on hover */
  &::-webkit-scrollbar-thumb:hover {
    background: `,`;
  }
`])),function(r){return r.theme.disableThemeScrollbar?"":"width: 10px"},function(r){return r.theme.secondary},function(r){return r.theme.tertiary},function(r){return r.theme.primary}),Gr,Of=function(r,t){return Object.defineProperty?Object.defineProperty(r,"raw",{value:t}):r.raw=t,r},zn=function(){return zn=Object.assign||function(r){for(var t,e=1,i=arguments.length;e<i;e++){t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},zn.apply(this,arguments)},Df=lt(Ee)(Vr||(Vr=Of([`
  display: flex;
  flex: 1;
  align-items: center;
  justify-content: center;
  height: 100%;
  background-color: white;
  background-image: linear-gradient(45deg, #e0e0e0 25%, transparent 25%),
    linear-gradient(-45deg, #e0e0e0 25%, transparent 25%),
    linear-gradient(45deg, transparent 75%, #e0e0e0 75%),
    linear-gradient(-45deg, transparent 75%, #e0e0e0 75%);
  background-size: 20px 20px;
  background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
`],[`
  display: flex;
  flex: 1;
  align-items: center;
  justify-content: center;
  height: 100%;
  background-color: white;
  background-image: linear-gradient(45deg, #e0e0e0 25%, transparent 25%),
    linear-gradient(-45deg, #e0e0e0 25%, transparent 25%),
    linear-gradient(45deg, transparent 75%, #e0e0e0 75%),
    linear-gradient(-45deg, transparent 75%, #e0e0e0 75%);
  background-size: 20px 20px;
  background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
`]))),ms=function(r){return P.createElement(Df,zn({},r))};ms.fileTypes=["png","image/png"];ms.weight=0;var Vr,Ff=void 0,ae=void 0,Ut=void 0,Fi=[],Nf=function(){var r=Nt(2,0);if(r===18761)Ut=!0;else if(r===19789)Ut=!1;else throw TypeError("Invalid byte order value.");return Ut},Bf=function(){if(Nt(2,2)!==42)throw RangeError("You forgot your towel!");return!0},jf=function(r){var t={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop"},e;return r in t?e=t[r]:e="Tag"+r,e},Hf=function(r){var t={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE"},e;return r in t&&(e=t[r]),e},Uf=function(r){var t;return["BYTE","ASCII","SBYTE","UNDEFINED"].indexOf(r)!==-1?t=1:["SHORT","SSHORT"].indexOf(r)!==-1?t=2:["LONG","SLONG","FLOAT"].indexOf(r)!==-1?t=4:["RATIONAL","SRATIONAL","DOUBLE"].indexOf(r)!==-1&&(t=8),t},$f=function(r,t,e){e=e||0;var i=Math.floor(e/8),n=t+i,s=e+r,a=32-r;if(s<=0)throw RangeError("No bits requested");if(s<=8)var o=24+e,l=ae.getUint8(n,Ut);else if(s<=16)var o=16+e,l=ae.getUint16(n,Ut);else if(s<=32)var o=e,l=ae.getUint32(n,Ut);else throw RangeError("Too many bits requested");var c={bits:l<<o>>>a,byteOffset:n+Math.floor(s/8),bitOffset:s%8};return c},Nt=function(r,t){if(r<=0)throw RangeError("No bytes requested");if(r<=1)return ae.getUint8(t,Ut);if(r<=2)return ae.getUint16(t,Ut);if(r<=3)return ae.getUint32(t,Ut)>>>8;if(r<=4)return ae.getUint32(t,Ut);throw RangeError("Too many bytes requested")},zf=function(r,t,e,i){var n=[],s=Uf(t),a=s*e;if(a<=4){if(Ut===!1)var o=i>>>(4-s)*8;else var o=i;n.push(o)}else for(var l=0;l<e;l++){var c=s*l;if(s>=8)if(["RATIONAL","SRATIONAL"].indexOf(t)!==-1)n.push(Nt(4,i+c)),n.push(Nt(4,i+c+4));else throw TypeError("Can't handle this field type or size");else n.push(Nt(s,i+c))}return t==="ASCII"&&n.forEach(function(h,d,u){u[d]=String.fromCharCode(h)}),n},ve=function(r,t){var e=Math.pow(2,8-t);return Math.floor(r*e+(e-1))},Wr=function(r,t,e,i){return typeof i>"u"&&(i=1),"rgba("+r+", "+t+", "+e+", "+i+")"},Co=function(r){for(var t=Nt(2,r),e=[],i=r+2,n=0;n<t;i+=12,n++){var s=Nt(2,i),a=Nt(2,i+2),o=Nt(4,i+4),l=Nt(4,i+8),c=jf(s),h=Hf(a),d=zf(c,h,o,l);e[c]={type:h,values:d}}Fi.push(e);var u=Nt(4,i);return u===0?Fi:Co(u)},Gf=function(r,t){var e=t||document.createElement("canvas");if(r&&(ae=new DataView(r),Ut=Nf(),!!Bf())){var i=Nt(4,4);Fi=Co(i);var n=Fi[0],s=n.ImageWidth.values[0],a=n.ImageLength.values[0];e.width=s,e.height=a;var o=[],l=n.Compression?n.Compression.values[0]:1,c=n.SamplesPerPixel.values[0],h=[],d=0,u=!1;if(n.BitsPerSample.values.forEach(function(Z,pt,le){h[pt]={bitsPerSample:Z,hasBytesPerSample:!1,bytesPerSample:void 0},Z%8===0&&(h[pt].hasBytesPerSample=!0,h[pt].bytesPerSample=Z/8),d+=Z},Ff),d%8===0){u=!0;var p=d/8}var f=n.StripOffsets.values,m=f.length;if(n.StripByteCounts)var b=n.StripByteCounts.values;else if(m===1)var b=[Math.ceil(s*a*d/8)];else throw Error("Cannot recover from missing StripByteCounts");for(var g=0;g<m;g++){var y=f[g];o[g]=[];for(var x=b[g],w=0,v=0,R=1,I=!0,j=[],H=0,z=0,D=0;w<x;w+=R)switch(l){case 1:for(var $=0,j=[];$<c;$++)if(h[$].hasBytesPerSample){var W=h[$].bytesPerSample*$;j.push(Nt(h[$].bytesPerSample,y+w+W))}else{var Y=$f(h[$].bitsPerSample,y+w,v);throw j.push(Y.bits),w=Y.byteOffset-y,v=Y.bitOffset,RangeError("Cannot handle sub-byte bits per sample")}if(o[g].push(j),u)R=p;else throw R=0,RangeError("Cannot handle sub-byte bits per pixel");break;case 2:break;case 3:break;case 4:break;case 5:break;case 6:break;case 7:break;case 32773:if(I){I=!1;var G=1,J=1,F=ae.getInt8(y+w,Ut);F>=0&&F<=127?G=F+1:F>=-127&&F<=-1?J=-F+1:I=!0}else{for(var _=Nt(1,y+w),$=0;$<J;$++){if(h[z].hasBytesPerSample)D=D<<8*H|_,H++,H===h[z].bytesPerSample&&(j.push(D),D=H=0,z++);else throw RangeError("Cannot handle sub-byte bits per sample");z===c&&(o[g].push(j),j=[],z=0)}G--,G===0&&(I=!0)}R=1;break}}if(e.getContext){var A=e.getContext("2d");if(A.fillStyle=Wr(255,255,255,0),n.RowsPerStrip)var C=n.RowsPerStrip.values[0];else var C=a;var O=o.length,S=a%C,T=S===0?C:S,L=C,U=0,E=n.PhotometricInterpretation.values[0],N=[],k=0;if(n.ExtraSamples&&(N=n.ExtraSamples.values,k=N.length),n.ColorMap)var rt=n.ColorMap.values,V=Math.pow(2,h[0].bitsPerSample);for(var g=0;g<O;g++){g+1===O&&(L=T);for(var at=o[g].length,X=U*g,Q=0,ot=0;ot<at;Q++)for(var et=0;et<s;et++,ot++){var K=o[g][ot],tt=0,ht=0,Et=0,bt=1;if(k>0){for(var $t=0;$t<k;$t++)if(N[$t]===1||N[$t]===2){bt=K[3+$t]/256;break}}switch(E){case 0:if(h[0].hasBytesPerSample)var te=Math.pow(16,h[0].bytesPerSample*2);K.forEach(function(pt,le,me){me[le]=te-pt});case 1:tt=ht=Et=ve(K[0],h[0].bitsPerSample);break;case 2:tt=ve(K[0],h[0].bitsPerSample),ht=ve(K[1],h[1].bitsPerSample),Et=ve(K[2],h[2].bitsPerSample);break;case 3:if(rt===void 0)throw Error("Palette image missing color map");var Ct=K[0];tt=ve(rt[Ct],16),ht=ve(rt[V+Ct],16),Et=ve(rt[2*V+Ct],16);break;case 4:throw RangeError("Not Yet Implemented: Transparency mask");case 5:throw RangeError("Not Yet Implemented: CMYK");case 6:throw RangeError("Not Yet Implemented: YCbCr");case 8:throw RangeError("Not Yet Implemented: CIELab");default:throw RangeError("Unknown Photometric Interpretation:",E)}A.fillStyle=Wr(tt,ht,Et,bt),A.fillRect(et,X+Q,1,1)}U=L}}return e}},Vf=function(r,t){return Object.defineProperty?Object.defineProperty(r,"raw",{value:t}):r.raw=t,r},Ni=function(){return Ni=Object.assign||function(r){for(var t,e=1,i=arguments.length;e<i;e++){t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Ni.apply(this,arguments)},on=function(r){var t=r.mainState.currentDocument,e=M.useState(!1),i=e[0],n=e[1],s=M.useState(!1),a=s[0],o=s[1];return M.useEffect(function(){if(!(!t||i)){var l=document.getElementById("tiff-img");try{l&&Gf(t.fileData,l),n(!0)}catch{o(!0)}}},[]),a?P.createElement(Ee,Ni({},r),P.createElement("div",null,"Your file is corrupted. Please check it on your machine.")):P.createElement(Ee,Ni({},r),P.createElement(Wf,{id:"tiff-img"}))};on.fileTypes=["tif","tiff","image/tif","image/tiff"];on.weight=0;on.fileLoader=Ea;var Wf=lt.canvas(Yr||(Yr=Vf([`
  max-width: 95%;
  max-height: 95%;
`],[`
  max-width: 95%;
  max-height: 95%;
`]))),Yr,Yf=function(r,t){return Object.defineProperty?Object.defineProperty(r,"raw",{value:t}):r.raw=t,r},ln=function(r){var t=r.mainState.currentDocument;return P.createElement(qf,{id:"txt-renderer"},t?.fileData)};ln.fileTypes=["txt","text/plain"];ln.weight=0;ln.fileLoader=Jl;var qf=lt.div(qr||(qr=Yf([`
  display: flex;
  flex-direction: column;
  width: 100%;
  padding: 30px;
`],[`
  display: flex;
  flex-direction: column;
  width: 100%;
  padding: 30px;
`]))),qr,Xr={primary:"#fff",secondary:"#000",tertiary:"#ffffff99",text_primary:"#000",text_secondary:"#fff",text_tertiary:"#00000044",disableThemeScrollbar:!1},Xf=[Xn,Ui,Kn,$i,Gi,gs,ms,on,ln],Kf=function(r,t){return Object.defineProperty?Object.defineProperty(r,"raw",{value:t}):r.raw=t,r},Fe=function(){return Fe=Object.assign||function(r){for(var t,e=1,i=arguments.length;e<i;e++){t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Fe.apply(this,arguments)},Zf=function(r){var t=r.documents,e=r.theme;if(!t||t===void 0)throw new Error(`Please provide an array of documents to DocViewer.
e.g. <DocViewer documents={[ { uri: 'https://mypdf.pdf' } ]} />`);return P.createElement(Dl,Fe({},r),P.createElement(Rl,{theme:e?Fe(Fe({},Xr),e):Xr},P.createElement(Qf,Fe({id:"react-doc-viewer","data-testid":"react-doc-viewer"},r),P.createElement(Xl,null),P.createElement(sc,null))))},Qf=lt.div(Kr||(Kr=Kf([`
  display: flex;
  flex-direction: column;
  overflow: hidden;
  background: #eee;
`],[`
  display: flex;
  flex-direction: column;
  overflow: hidden;
  background: #eee;
`]))),Kr;function Lp(r){const t=Ro.c(84),{research:e}=r,{t:i}=Io(),[n,s]=M.useState("list"),[a,o]=M.useState(null),[l,c]=M.useState(-1);let h;t[0]!==e.id?(h=(Q,ot)=>{Lo.put(`/admin/researches/${e.id}`,{status:Q,is_public:ot})},t[0]=e.id,t[1]=h):h=t[1];const d=h;let u;t[2]!==d||t[3]!==e.is_public||t[4]!==e.status?(u=()=>{d(e.status,!e.is_public)},t[2]=d,t[3]=e.is_public,t[4]=e.status,t[5]=u):u=t[5];const p=u;let f;t[6]!==d?(f=()=>{d("published",!0)},t[6]=d,t[7]=f):f=t[7];const m=f;let b;t[8]!==d?(b=()=>{d("draft",!1)},t[8]=d,t[9]=b):b=t[9];const g=b;let y;t[10]===Symbol.for("react.memo_cache_sentinel")?(y=(Q,ot)=>{Q.url&&(o(Q),c(ot),s("viewer"))},t[10]=y):y=t[10];const x=y;let w;t[11]===Symbol.for("react.memo_cache_sentinel")?(w=()=>{s("list"),o(null),c(-1)},t[11]=w):w=t[11];const v=w;let R;t[12]!==e.files||t[13]!==l?(R=Q=>{if(l===-1)return;const ot=e.files??[];if(!ot.length)return;const et=Q==="next"?(l+1)%ot.length:(l-1+ot.length)%ot.length,K=ot[et];K?.url&&(c(et),o(K),s("viewer"))},t[12]=e.files,t[13]=l,t[14]=R):R=t[14];const I=R,j=ip,H=ep,z=tp,D=Jf;let $;t[15]!==a?($=a?.url?[{uri:a.url,fileName:a.name,fileType:a.mime_type}]:[],t[15]=a,t[16]=$):$=t[16];const W=$;let Y;t[17]!==i?(Y=i("researches.title"),t[17]=i,t[18]=Y):Y=t[18];let G;t[19]!==Y?(G={title:Y,href:"/admin/researches"},t[19]=Y,t[20]=G):G=t[20];let J;t[21]!==e.title||t[22]!==i?(J=e.title??i("researches.card.untitled"),t[21]=e.title,t[22]=i,t[23]=J):J=t[23];let F;t[24]!==J?(F={title:J,href:"#"},t[24]=J,t[25]=F):F=t[25];let _;t[26]!==G||t[27]!==F?(_=[G,F],t[26]=G,t[27]=F,t[28]=_):_=t[28];let A;t[29]!==e.title||t[30]!==i?(A=e.title??i("researches.card.untitled"),t[29]=e.title,t[30]=i,t[31]=A):A=t[31];let C;t[32]!==A?(C=B.jsx(ko,{title:A}),t[32]=A,t[33]=C):C=t[33];let O;t[34]!==n||t[35]!==m||t[36]!==e.abstract||t[37]!==e.author||t[38]!==e.is_public||t[39]!==e.status||t[40]!==e.title||t[41]!==i||t[42]!==p||t[43]!==g?(O=n==="list"&&B.jsxs(B.Fragment,{children:[B.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[B.jsxs("div",{children:[B.jsxs("div",{className:"mb-2 flex flex-wrap items-center gap-2",children:[B.jsx(pi,{variant:"outline",children:i(`researches.statuses.${e.status}`,{defaultValue:e.status})}),B.jsx(pi,{variant:e.is_public?"secondary":"outline",children:e.is_public?i("researches.visibility.public"):i("researches.visibility.private")})]}),B.jsx("h1",{className:"text-2xl font-semibold",children:e.title??i("researches.card.untitled")}),e.author&&B.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:e.author.name??e.author.email})]}),B.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.status!=="published"&&B.jsx(ce,{onClick:m,children:i("researches.actions.publish",{defaultValue:"Publish"})}),e.status==="published"&&B.jsx(ce,{variant:"outline",onClick:g,children:i("researches.actions.unpublish",{defaultValue:"Unpublish"})}),B.jsx(ce,{variant:"outline",onClick:p,children:e.is_public?i("researches.actions.makePrivate",{defaultValue:"Make private"}):i("researches.actions.makePublic",{defaultValue:"Make public"})})]})]}),B.jsxs("section",{className:" border bg-card p-6 shadow-sm",children:[B.jsx("h2",{className:"text-lg font-semibold",children:i("researches.show.overview",{defaultValue:"Overview"})}),B.jsx("p",{className:"mt-3 whitespace-pre-wrap text-sm text-muted-foreground",children:e.abstract??i("researches.card.noSummary")})]}),B.jsxs("section",{className:" border bg-card p-6 shadow-sm space-y-3",children:[B.jsx("h3",{className:"text-base font-semibold",children:i("researches.show.metadata",{defaultValue:"Metadata"})}),B.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[B.jsxs("div",{children:[B.jsx("p",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide",children:i("researches.show.status",{defaultValue:"Status"})}),B.jsx("p",{className:"text-sm mt-1",children:i(`researches.statuses.${e.status}`,{defaultValue:e.status})})]}),B.jsxs("div",{children:[B.jsx("p",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide",children:i("researches.show.visibility",{defaultValue:"Visibility"})}),B.jsx("p",{className:"text-sm mt-1",children:e.is_public?i("researches.visibility.public"):i("researches.visibility.private")})]})]})]})]}),t[34]=n,t[35]=m,t[36]=e.abstract,t[37]=e.author,t[38]=e.is_public,t[39]=e.status,t[40]=e.title,t[41]=i,t[42]=p,t[43]=g,t[44]=O):O=t[44];let S;t[45]!==n||t[46]!==i?(S=n==="viewer"&&B.jsxs(ce,{variant:"ghost",size:"sm",onClick:v,className:"gap-2",children:[B.jsx(Oo,{className:"h-4 w-4"}),i("actions.back",{defaultValue:"Back"})]}),t[45]=n,t[46]=i,t[47]=S):S=t[47];let T;t[48]!==n||t[49]!==e.files?.length||t[50]!==a?.name||t[51]!==i?(T=n==="list"?`${i("researches.show.filesSection",{defaultValue:"Files"})} (${e.files?.length||0})`:a?.name,t[48]=n,t[49]=e.files?.length,t[50]=a?.name,t[51]=i,t[52]=T):T=t[52];let L;t[53]!==T?(L=B.jsx("h3",{className:"text-base font-semibold",children:T}),t[53]=T,t[54]=L):L=t[54];let U;t[55]!==S||t[56]!==L?(U=B.jsxs("div",{className:"flex items-center gap-3",children:[S,L]}),t[55]=S,t[56]=L,t[57]=U):U=t[57];let E;t[58]!==n||t[59]!==I||t[60]!==a||t[61]!==i?(E=n==="viewer"&&a&&B.jsxs("div",{className:"flex items-center gap-2",children:[B.jsxs(ce,{variant:"ghost",size:"sm",onClick:()=>I("prev"),className:"gap-2",children:[B.jsx(Ho,{className:"h-4 w-4"}),i("actions.back",{defaultValue:"Back"})]}),B.jsxs(ce,{variant:"ghost",size:"sm",onClick:()=>I("next"),className:"gap-2",children:[i("actions.forward",{defaultValue:"Next"}),B.jsx($o,{className:"h-4 w-4"})]}),B.jsxs(ce,{variant:"outline",size:"sm",onClick:()=>j(a),className:"gap-2",children:[B.jsx(Do,{className:"h-4 w-4"}),i("actions.download",{defaultValue:"Download"})]}),B.jsxs(ce,{variant:"outline",size:"sm",onClick:()=>H(a),className:"gap-2",children:[B.jsx(Fo,{className:"h-4 w-4"}),i("actions.openNewTab",{defaultValue:"Open in New Tab"})]})]}),t[58]=n,t[59]=I,t[60]=a,t[61]=i,t[62]=E):E=t[62];let N;t[63]!==U||t[64]!==E?(N=B.jsxs("div",{className:"flex items-center justify-between p-4 border-b bg-muted/30",children:[U,E]}),t[63]=U,t[64]=E,t[65]=N):N=t[65];let k;t[66]!==n||t[67]!==W||t[68]!==e.files||t[69]!==a||t[70]!==i?(k=n==="list"?e.files&&e.files.length?B.jsx("div",{className:"space-y-2",children:e.files.map((Q,ot)=>B.jsxs("button",{onClick:()=>x(Q,ot),disabled:!Q.url,className:"w-full flex items-center justify-between gap-4 rounded-lg border bg-background p-4 transition-all hover:bg-muted/50 hover:shadow-md active:scale-[0.99] disabled:opacity-50 disabled:cursor-not-allowed text-left",children:[B.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[B.jsx("div",{className:"flex-shrink-0 text-2xl",children:D(Q.mime_type)}),B.jsxs("div",{className:"flex-1 min-w-0",children:[B.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[B.jsx("p",{className:"font-medium text-sm truncate",children:Q.name}),Q.is_primary&&B.jsx(pi,{variant:"default",className:"text-[10px]",children:i("researches.form.primaryFile",{defaultValue:"Primary"})}),!Q.is_visible&&B.jsx(pi,{variant:"outline",className:"text-[10px]",children:i("researches.show.disabled",{defaultValue:"Hidden"})})]}),B.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mt-1",children:[B.jsx("span",{children:Q.mime_type}),B.jsx("span",{children:""}),B.jsx("span",{children:z(Q.size_bytes)})]})]})]}),B.jsx("div",{className:"flex items-center gap-2 flex-shrink-0",children:Q.url&&B.jsx(No,{className:"h-5 w-5 text-muted-foreground"})})]},Q.id))}):B.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[B.jsx(Bo,{className:"h-16 w-16 mx-auto mb-4 opacity-50"}),B.jsx("p",{className:"text-sm",children:i("researches.show.noFiles",{defaultValue:"No files uploaded yet."})})]}):a&&a.url&&B.jsx("div",{className:"h-full min-h-[500px] rounded-lg border bg-muted/10 overflow-hidden",children:B.jsx(Zf,{documents:W,pluginRenderers:Xf,config:{header:{disableHeader:!0}},style:{height:"100%",minHeight:"500px"}})}),t[66]=n,t[67]=W,t[68]=e.files,t[69]=a,t[70]=i,t[71]=k):k=t[71];let rt;t[72]!==k?(rt=B.jsx("div",{className:"flex-1 p-6",children:k}),t[72]=k,t[73]=rt):rt=t[73];let V;t[74]!==N||t[75]!==rt?(V=B.jsxs("section",{className:" border bg-card shadow-sm flex flex-col min-h-[600px]",children:[N,rt]}),t[74]=N,t[75]=rt,t[76]=V):V=t[76];let at;t[77]!==O||t[78]!==V?(at=B.jsxs("div",{className:"flex flex-1 flex-col gap-6 p-4",children:[O,V]}),t[77]=O,t[78]=V,t[79]=at):at=t[79];let X;return t[80]!==_||t[81]!==C||t[82]!==at?(X=B.jsxs(Mo,{breadcrumbs:_,children:[C,at]}),t[80]=_,t[81]=C,t[82]=at,t[83]=X):X=t[83],X}function Jf(r){return r.startsWith("image/")?"":r.includes("pdf")?"":r.includes("word")||r.includes("document")?"":r.includes("excel")||r.includes("spreadsheet")?"":r.includes("zip")||r.includes("compressed")?"":""}function tp(r){return r<1024?`${r} B`:r<1048576?`${(r/1024).toFixed(1)} KB`:`${(r/1024/1024).toFixed(1)} MB`}function ep(r){r.url&&window.open(r.url,"_blank")}function ip(r){if(!r.url)return;const t=document.createElement("a");t.href=r.url,t.download=r.name,t.target="_blank",document.body.appendChild(t),t.click(),document.body.removeChild(t)}export{Lp as default};
