import{r as x,j as s,c as Ne,b as Me}from"./app-XseEcuwc.js";import{c as Ie,B as he}from"./button-DI4PaxQ7.js";import{I as Ee}from"./input-MwdOiVtB.js";import{L as ae}from"./label-DepknyqC.js";import{T as Ae}from"./textarea-UpJGMb4k.js";import{b as Re,u as Le}from"./index-CR-rnG23.js";import"./index-DRE42a0L.js";import{F as Be}from"./file-audio-D46ysdVi.js";import{X as De}from"./x-DgzPl7e4.js";import{L as ke}from"./loader-circle-v5nqKdhA.js";import{U as ve}from"./upload-P9KV_7qs.js";/* empty css            */function Te(r,e=[]){let i=[];function t(c,o){const l=x.createContext(o);l.displayName=c+"Context";const n=i.length;i=[...i,o];const h=u=>{const{scope:m,children:j,...d}=u,f=m?.[r]?.[n]||l,ee=x.useMemo(()=>d,Object.values(d));return s.jsx(f.Provider,{value:ee,children:j})};h.displayName=c+"Provider";function g(u,m){const j=m?.[r]?.[n]||l,d=x.useContext(j);if(d)return d;if(o!==void 0)return o;throw new Error(`\`${u}\` must be used within \`${c}\``)}return[h,g]}const a=()=>{const c=i.map(o=>x.createContext(o));return function(l){const n=l?.[r]||c;return x.useMemo(()=>({[`__scope${r}`]:{...l,[r]:n}}),[l,n])}};return a.scopeName=r,[t,Ve(a,...e)]}function Ve(...r){const e=r[0];if(r.length===1)return e;const i=()=>{const t=r.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(c){const o=t.reduce((l,{useScope:n,scopeName:h})=>{const u=n(c)[`__scope${h}`];return{...l,...u}},{});return x.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return i.scopeName=e.scopeName,i}var Oe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],be=Oe.reduce((r,e)=>{const i=Ie(`Primitive.${e}`),t=x.forwardRef((a,c)=>{const{asChild:o,...l}=a,n=o?i:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),s.jsx(n,{...l,ref:c})});return t.displayName=`Primitive.${e}`,{...r,[e]:t}},{}),pe="Progress",xe=100,[Ue,dt]=Te(pe),[ze,Ge]=Ue(pe),Pe=x.forwardRef((r,e)=>{const{__scopeProgress:i,value:t=null,max:a,getValueLabel:c=Xe,...o}=r;(a||a===0)&&!ge(a)&&console.error(He(`${a}`,"Progress"));const l=ge(a)?a:xe;t!==null&&!je(t,l)&&console.error(Ke(`${t}`,"Progress"));const n=je(t,l)?t:null,h=ne(n)?c(n,l):void 0;return s.jsx(ze,{scope:i,value:n,max:l,children:s.jsx(be.div,{"aria-valuemax":l,"aria-valuemin":0,"aria-valuenow":ne(n)?n:void 0,"aria-valuetext":h,role:"progressbar","data-state":ye(n,l),"data-value":n??void 0,"data-max":l,...o,ref:e})})});Pe.displayName=pe;var _e="ProgressIndicator",Se=x.forwardRef((r,e)=>{const{__scopeProgress:i,...t}=r,a=Ge(_e,i);return s.jsx(be.div,{"data-state":ye(a.value,a.max),"data-value":a.value??void 0,"data-max":a.max,...t,ref:e})});Se.displayName=_e;function Xe(r,e){return`${Math.round(r/e*100)}%`}function ye(r,e){return r==null?"indeterminate":r===e?"complete":"loading"}function ne(r){return typeof r=="number"}function ge(r){return ne(r)&&!isNaN(r)&&r>0}function je(r,e){return ne(r)&&!isNaN(r)&&r<=e&&r>=0}function He(r,e){return`Invalid prop \`max\` of value \`${r}\` supplied to \`${e}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${xe}\`.`}function Ke(r,e){return`Invalid prop \`value\` of value \`${r}\` supplied to \`${e}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${xe} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var We=Pe,qe=Se;function Je(r){const e=Ne.c(12);let i,t,a;e[0]!==r?({className:i,value:a,...t}=r,e[0]=r,e[1]=i,e[2]=t,e[3]=a):(i=e[1],t=e[2],a=e[3]);let c;e[4]!==i?(c=Re("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",i),e[4]=i,e[5]=c):c=e[5];const o=`translateX(-${100-(a||0)}%)`;let l;e[6]!==o?(l=s.jsx(qe,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:o}}),e[6]=o,e[7]=l):l=e[7];let n;return e[8]!==t||e[9]!==c||e[10]!==l?(n=s.jsx(We,{"data-slot":"progress",className:c,...t,children:l}),e[8]=t,e[9]=c,e[10]=l,e[11]=n):n=e[11],n}function ut(r){const e=Ne.c(116),{onSuccess:i}=r,{t}=Le(),a=x.useRef(null);let c;e[0]===Symbol.for("react.memo_cache_sentinel")?(c=[],e[0]=c):c=e[0];const[o,l]=x.useState(c),[n,h]=x.useState(0);let g;e[1]===Symbol.for("react.memo_cache_sentinel")?(g={audio_files:[],title:"",description:"",is_public:!1},e[1]=g):g=e[1];const{data:u,setData:m,post:j,processing:d,errors:f,reset:ee}=Me(g);let te;e[2]!==o||e[3]!==m?(te=p=>{if(!p.target.files)return;const v=Array.from(p.target.files),fe=[...o,...v];l(fe),m("audio_files",fe)},e[2]=o,e[3]=m,e[4]=te):te=e[4];const ce=te;let se;e[5]!==o||e[6]!==m?(se=p=>{const v=o.filter((fe,Ce)=>Ce!==p);l(v),m("audio_files",v)},e[5]=o,e[6]=m,e[7]=se):se=e[7];const de=se,we=Qe;let re;e[8]!==u.audio_files.length||e[9]!==i||e[10]!==j||e[11]!==ee||e[12]!==t?(re=p=>{if(p.preventDefault(),u.audio_files.length===0){alert(t("audios.validation.noFiles"));return}j("/researcher/audios",{forceFormData:!0,onProgress:v=>{h(v.percentage||0)},onSuccess:()=>{ee(),l([]),h(0),i?.()},onError:()=>{h(0)}})},e[8]=u.audio_files.length,e[9]=i,e[10]=j,e[11]=ee,e[12]=t,e[13]=re):re=e[13];const ue=re;let N;e[14]!==t?(N=t("audios.form.files"),e[14]=t,e[15]=N):N=e[15];let b;e[16]!==N?(b=s.jsx(ae,{children:N}),e[16]=N,e[17]=b):b=e[17];let oe;e[18]===Symbol.for("react.memo_cache_sentinel")?(oe=()=>a.current?.click(),e[18]=oe):oe=e[18];let le;e[19]===Symbol.for("react.memo_cache_sentinel")?(le=s.jsx(ve,{className:"h-12 w-12 text-muted-foreground/50"}),e[19]=le):le=e[19];let P;e[20]!==t?(P=t("audios.form.clickToUpload"),e[20]=t,e[21]=P):P=e[21];let _;e[22]!==P?(_=s.jsx("p",{className:"mt-2 text-sm font-medium",children:P}),e[22]=P,e[23]=_):_=e[23];let S;e[24]!==t?(S=t("audios.form.supportedFormats"),e[24]=t,e[25]=S):S=e[25];let y;e[26]!==S?(y=s.jsxs("p",{className:"mt-1 text-xs text-muted-foreground",children:[S,": MP3, WAV, OGG, M4A, FLAC"]}),e[26]=S,e[27]=y):y=e[27];let w;e[28]!==t?(w=t("audios.form.maxSize"),e[28]=t,e[29]=w):w=e[29];let $;e[30]!==t?($=t("audios.form.perFile"),e[30]=t,e[31]=$):$=e[31];let F;e[32]!==w||e[33]!==$?(F=s.jsxs("p",{className:"mt-1 text-xs text-muted-foreground",children:[w,": 100MB ",$]}),e[32]=w,e[33]=$,e[34]=F):F=e[34];let C;e[35]!==_||e[36]!==y||e[37]!==F?(C=s.jsxs("div",{onClick:oe,className:"mt-2 flex cursor-pointer flex-col items-center justify-center rounded-lg border-2 border-dashed border-muted-foreground/25 bg-muted/10 p-8 transition-colors hover:border-muted-foreground/50 hover:bg-muted/20",children:[le,_,y,F]}),e[35]=_,e[36]=y,e[37]=F,e[38]=C):C=e[38];let M;e[39]!==ce?(M=s.jsx("input",{ref:a,type:"file",accept:".mp3,.wav,.ogg,.m4a,.flac",multiple:!0,onChange:ce,className:"hidden"}),e[39]=ce,e[40]=M):M=e[40];let I;e[41]!==f.audio_files?(I=f.audio_files&&s.jsx("p",{className:"mt-1 text-sm text-destructive",children:f.audio_files}),e[41]=f.audio_files,e[42]=I):I=e[42];let E;e[43]!==C||e[44]!==M||e[45]!==I||e[46]!==b?(E=s.jsxs("div",{children:[b,C,M,I]}),e[43]=C,e[44]=M,e[45]=I,e[46]=b,e[47]=E):E=e[47];let A;e[48]!==de||e[49]!==o||e[50]!==t?(A=o.length>0&&s.jsxs("div",{className:"space-y-2",children:[s.jsxs(ae,{children:[t("audios.form.selectedFiles")," (",o.length,")"]}),s.jsx("div",{className:"max-h-60 space-y-2 overflow-y-auto rounded-lg border p-3",children:o.map((p,v)=>s.jsxs("div",{className:"flex items-center justify-between rounded-md bg-muted/50 p-3",children:[s.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[s.jsx(Be,{className:"h-5 w-5 flex-shrink-0 text-blue-500"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-sm font-medium truncate",children:p.name}),s.jsx("p",{className:"text-xs text-muted-foreground",children:we(p.size)})]})]}),s.jsx(he,{type:"button",variant:"ghost",size:"sm",onClick:()=>de(v),className:"flex-shrink-0",children:s.jsx(De,{className:"h-4 w-4"})})]},`${p.name}-${v}`))})]}),e[48]=de,e[49]=o,e[50]=t,e[51]=A):A=e[51];let R;e[52]!==d||e[53]!==t||e[54]!==n?(R=d&&n>0&&s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsx("span",{className:"text-muted-foreground",children:t("audios.form.uploading")}),s.jsxs("span",{className:"font-medium",children:[Math.round(n),"%"]})]}),s.jsx(Je,{value:n,className:"h-2"})]}),e[52]=d,e[53]=t,e[54]=n,e[55]=R):R=e[55];let L;e[56]!==t?(L=t("audios.form.optionalMetadata"),e[56]=t,e[57]=L):L=e[57];let B;e[58]!==L?(B=s.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:L}),e[58]=L,e[59]=B):B=e[59];let D;e[60]!==t?(D=t("audios.form.title"),e[60]=t,e[61]=D):D=e[61];let k;e[62]!==D?(k=s.jsx(ae,{htmlFor:"title",children:D}),e[62]=D,e[63]=k):k=e[63];const $e=u.title;let T;e[64]!==m?(T=p=>m("title",p.target.value),e[64]=m,e[65]=T):T=e[65];let V;e[66]!==t?(V=t("audios.form.titlePlaceholder"),e[66]=t,e[67]=V):V=e[67];let O;e[68]!==u.title||e[69]!==d||e[70]!==T||e[71]!==V?(O=s.jsx(Ee,{id:"title",value:$e,onChange:T,placeholder:V,disabled:d}),e[68]=u.title,e[69]=d,e[70]=T,e[71]=V,e[72]=O):O=e[72];let U;e[73]!==f.title?(U=f.title&&s.jsx("p",{className:"mt-1 text-sm text-destructive",children:f.title}),e[73]=f.title,e[74]=U):U=e[74];let z;e[75]!==k||e[76]!==O||e[77]!==U?(z=s.jsxs("div",{children:[k,O,U]}),e[75]=k,e[76]=O,e[77]=U,e[78]=z):z=e[78];let G;e[79]!==t?(G=t("audios.form.description"),e[79]=t,e[80]=G):G=e[80];let X;e[81]!==G?(X=s.jsx(ae,{htmlFor:"description",children:G}),e[81]=G,e[82]=X):X=e[82];const Fe=u.description;let H;e[83]!==m?(H=p=>m("description",p.target.value),e[83]=m,e[84]=H):H=e[84];let K;e[85]!==t?(K=t("audios.form.descriptionPlaceholder"),e[85]=t,e[86]=K):K=e[86];let W;e[87]!==u.description||e[88]!==d||e[89]!==H||e[90]!==K?(W=s.jsx(Ae,{id:"description",value:Fe,onChange:H,placeholder:K,rows:3,disabled:d}),e[87]=u.description,e[88]=d,e[89]=H,e[90]=K,e[91]=W):W=e[91];let q;e[92]!==f.description?(q=f.description&&s.jsx("p",{className:"mt-1 text-sm text-destructive",children:f.description}),e[92]=f.description,e[93]=q):q=e[93];let J;e[94]!==X||e[95]!==W||e[96]!==q?(J=s.jsxs("div",{children:[X,W,q]}),e[94]=X,e[95]=W,e[96]=q,e[97]=J):J=e[97];let Q;e[98]!==B||e[99]!==z||e[100]!==J?(Q=s.jsxs("div",{className:"space-y-4 rounded-lg border bg-muted/10 p-4",children:[B,z,J]}),e[98]=B,e[99]=z,e[100]=J,e[101]=Q):Q=e[101];const me=d||u.audio_files.length===0;let Y;e[102]!==d||e[103]!==o.length||e[104]!==t?(Y=d?s.jsxs(s.Fragment,{children:[s.jsx(ke,{className:"h-4 w-4 mr-2 animate-spin"}),t("audios.form.uploading")]}):s.jsxs(s.Fragment,{children:[s.jsx(ve,{className:"h-4 w-4 mr-2"}),t("audios.form.upload")," (",o.length,")"]}),e[102]=d,e[103]=o.length,e[104]=t,e[105]=Y):Y=e[105];let Z;e[106]!==me||e[107]!==Y?(Z=s.jsx("div",{className:"flex justify-end gap-2",children:s.jsx(he,{type:"submit",disabled:me,className:"min-w-32",children:Y})}),e[106]=me,e[107]=Y,e[108]=Z):Z=e[108];let ie;return e[109]!==ue||e[110]!==E||e[111]!==A||e[112]!==R||e[113]!==Q||e[114]!==Z?(ie=s.jsxs("form",{onSubmit:ue,className:"space-y-6",children:[E,A,R,Q,Z]}),e[109]=ue,e[110]=E,e[111]=A,e[112]=R,e[113]=Q,e[114]=Z,e[115]=ie):ie=e[115],ie}function Qe(r){const e=["B","KB","MB","GB"];let i=r,t=0;for(;i>=1024&&t<e.length-1;)i=i/1024,t++;return`${i.toFixed(2)} ${e[t]}`}export{ut as default};
